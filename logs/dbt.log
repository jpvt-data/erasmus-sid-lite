[0m12:09:42.100732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E04D7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E55CBF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E55CB490>]}


============================== 12:09:42.107833 | ee16b07d-981d-48ed-a7fb-037a2f6095fe ==============================
[0m12:09:42.107833 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:09:42.109894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:42.131827 [info ] [MainThread]: dbt version: 1.10.4
[0m12:09:42.132832 [info ] [MainThread]: python version: 3.11.13
[0m12:09:42.132832 [info ] [MainThread]: python path: C:\Users\jpvt\anaconda3\envs\sid_dbt311\python.exe
[0m12:09:42.132832 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:09:42.224288 [info ] [MainThread]: Using profiles dir at C:\Users\jpvt\.dbt
[0m12:09:42.228297 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpvt\.dbt\profiles.yml
[0m12:09:42.228297 [info ] [MainThread]: Using dbt_project.yml file at D:\GitHub\erasmus-sid-lite\dbt_project.yml
[0m12:09:42.230303 [info ] [MainThread]: adapter type: postgres
[0m12:09:42.232311 [info ] [MainThread]: adapter version: 1.9.0
[0m12:09:42.234317 [info ] [MainThread]: Configuration:
[0m12:09:42.234317 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:09:42.236324 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:09:42.238999 [info ] [MainThread]: Required dependencies:
[0m12:09:42.239557 [debug] [MainThread]: Executing "git --help"
[0m12:09:42.316369 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:09:42.317856 [debug] [MainThread]: STDERR: "b''"
[0m12:09:42.317856 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:09:42.317856 [info ] [MainThread]: Connection:
[0m12:09:42.320415 [info ] [MainThread]:   host: localhost
[0m12:09:42.320415 [info ] [MainThread]:   port: 5432
[0m12:09:42.320415 [info ] [MainThread]:   user: postgres
[0m12:09:42.322791 [info ] [MainThread]:   database: sid_lite
[0m12:09:42.322791 [info ] [MainThread]:   schema: public
[0m12:09:42.322791 [info ] [MainThread]:   connect_timeout: 10
[0m12:09:42.322791 [info ] [MainThread]:   role: None
[0m12:09:42.324537 [info ] [MainThread]:   search_path: None
[0m12:09:42.324537 [info ] [MainThread]:   keepalives_idle: 0
[0m12:09:42.325543 [info ] [MainThread]:   sslmode: None
[0m12:09:42.325543 [info ] [MainThread]:   sslcert: None
[0m12:09:42.325543 [info ] [MainThread]:   sslkey: None
[0m12:09:42.325543 [info ] [MainThread]:   sslrootcert: None
[0m12:09:42.325543 [info ] [MainThread]:   application_name: dbt
[0m12:09:42.325543 [info ] [MainThread]:   retries: 1
[0m12:09:42.328601 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:09:42.480782 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:09:42.699504 [debug] [MainThread]: Using postgres connection "debug"
[0m12:09:42.699504 [debug] [MainThread]: On debug: select 1 as id
[0m12:09:42.699504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:47.420799 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m12:09:51.491353 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:09:51.491353 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:09:51.495368 [debug] [MainThread]: On debug: No close available on handle
[0m12:09:51.497609 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:09:51.507722 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:09:51.511578 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\GitHub\erasmus-sid-lite\dbt_project.yml> not found

[0m12:09:51.515607 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:09:51.519800 [debug] [MainThread]: Command `dbt debug` failed at 12:09:51.519800 after 9.54 seconds
[0m12:09:51.521815 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:09:51.524987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E4255490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E4587410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E4584A10>]}
[0m12:09:51.526272 [debug] [MainThread]: Flushing usage events
[0m12:09:51.975985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:47.671100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A7C1B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A53DAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A3D501D0>]}


============================== 12:31:47.679361 | 1d47c82a-ae7f-43c0-b037-7383fd5dbe09 ==============================
[0m12:31:47.679361 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:31:47.679361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:47.703414 [info ] [MainThread]: dbt version: 1.10.4
[0m12:31:47.703414 [info ] [MainThread]: python version: 3.11.13
[0m12:31:47.703414 [info ] [MainThread]: python path: C:\Users\jpvt\anaconda3\envs\sid_dbt311\python.exe
[0m12:31:47.703414 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:31:47.759312 [info ] [MainThread]: Using profiles dir at C:\Users\jpvt\.dbt
[0m12:31:47.759312 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpvt\.dbt\profiles.yml
[0m12:31:47.759312 [info ] [MainThread]: Using dbt_project.yml file at D:\GitHub\erasmus-sid-lite\dbt_project.yml
[0m12:31:47.759312 [info ] [MainThread]: adapter type: postgres
[0m12:31:47.759312 [info ] [MainThread]: adapter version: 1.9.0
[0m12:31:47.867135 [info ] [MainThread]: Configuration:
[0m12:31:47.867135 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:31:47.867135 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:31:47.867135 [info ] [MainThread]: Required dependencies:
[0m12:31:47.867135 [debug] [MainThread]: Executing "git --help"
[0m12:31:47.909146 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:31:47.909146 [debug] [MainThread]: STDERR: "b''"
[0m12:31:47.909146 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:31:47.909146 [info ] [MainThread]: Connection:
[0m12:31:47.909146 [info ] [MainThread]:   host: localhost
[0m12:31:47.909146 [info ] [MainThread]:   port: 5432
[0m12:31:47.909146 [info ] [MainThread]:   user: postgres
[0m12:31:47.909146 [info ] [MainThread]:   database: sid_lite
[0m12:31:47.909146 [info ] [MainThread]:   schema: public
[0m12:31:47.909146 [info ] [MainThread]:   connect_timeout: 10
[0m12:31:47.909146 [info ] [MainThread]:   role: None
[0m12:31:47.909146 [info ] [MainThread]:   search_path: None
[0m12:31:47.909146 [info ] [MainThread]:   keepalives_idle: 0
[0m12:31:47.918491 [info ] [MainThread]:   sslmode: None
[0m12:31:47.918491 [info ] [MainThread]:   sslcert: None
[0m12:31:47.918491 [info ] [MainThread]:   sslkey: None
[0m12:31:47.918491 [info ] [MainThread]:   sslrootcert: None
[0m12:31:47.918491 [info ] [MainThread]:   application_name: dbt
[0m12:31:47.923189 [info ] [MainThread]:   retries: 1
[0m12:31:47.924032 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:31:48.079732 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:31:48.252733 [debug] [MainThread]: Using postgres connection "debug"
[0m12:31:48.252733 [debug] [MainThread]: On debug: select 1 as id
[0m12:31:48.253738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:48.307589 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:31:48.307589 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:31:48.307589 [debug] [MainThread]: On debug: No close available on handle
[0m12:31:48.309594 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:31:48.309594 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:31:48.312187 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:31:48.314291 [debug] [MainThread]: Command `dbt debug` failed at 12:31:48.314291 after 0.77 seconds
[0m12:31:48.315617 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:31:48.315617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A6BD4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A7D65F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A697F490>]}
[0m12:31:48.315617 [debug] [MainThread]: Flushing usage events
[0m12:31:48.797463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:50.476117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B47ABC210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B47AFE050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B47AFE150>]}


============================== 12:35:50.476117 | 27611ffc-6f77-414a-bc58-7b1eacdd48f8 ==============================
[0m12:35:50.476117 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:35:50.476117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:50.488109 [info ] [MainThread]: dbt version: 1.10.4
[0m12:35:50.504018 [info ] [MainThread]: python version: 3.11.13
[0m12:35:50.505608 [info ] [MainThread]: python path: C:\Users\jpvt\anaconda3\envs\sid_dbt311\python.exe
[0m12:35:50.505608 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:35:50.576234 [info ] [MainThread]: Using profiles dir at C:\Users\jpvt\.dbt
[0m12:35:50.576234 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpvt\.dbt\profiles.yml
[0m12:35:50.580710 [info ] [MainThread]: Using dbt_project.yml file at D:\GitHub\erasmus-sid-lite\dbt_project.yml
[0m12:35:50.580710 [info ] [MainThread]: adapter type: postgres
[0m12:35:50.580710 [info ] [MainThread]: adapter version: 1.9.0
[0m12:35:50.679021 [info ] [MainThread]: Configuration:
[0m12:35:50.679021 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:35:50.687037 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:35:50.687037 [info ] [MainThread]: Required dependencies:
[0m12:35:50.688092 [debug] [MainThread]: Executing "git --help"
[0m12:35:50.726474 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:35:50.727439 [debug] [MainThread]: STDERR: "b''"
[0m12:35:50.727867 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:35:50.729002 [info ] [MainThread]: Connection:
[0m12:35:50.729002 [info ] [MainThread]:   host: localhost
[0m12:35:50.729002 [info ] [MainThread]:   port: 5432
[0m12:35:50.730413 [info ] [MainThread]:   user: postgres
[0m12:35:50.730413 [info ] [MainThread]:   database: sid_lite
[0m12:35:50.730413 [info ] [MainThread]:   schema: public
[0m12:35:50.732594 [info ] [MainThread]:   connect_timeout: 10
[0m12:35:50.732594 [info ] [MainThread]:   role: None
[0m12:35:50.734026 [info ] [MainThread]:   search_path: None
[0m12:35:50.734646 [info ] [MainThread]:   keepalives_idle: 0
[0m12:35:50.734646 [info ] [MainThread]:   sslmode: None
[0m12:35:50.735735 [info ] [MainThread]:   sslcert: None
[0m12:35:50.735735 [info ] [MainThread]:   sslkey: None
[0m12:35:50.735735 [info ] [MainThread]:   sslrootcert: None
[0m12:35:50.735735 [info ] [MainThread]:   application_name: dbt
[0m12:35:50.737931 [info ] [MainThread]:   retries: 1
[0m12:35:50.739161 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:35:50.895150 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:35:51.076748 [debug] [MainThread]: Using postgres connection "debug"
[0m12:35:51.076748 [debug] [MainThread]: On debug: select 1 as id
[0m12:35:51.076748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:51.128698 [debug] [MainThread]: SQL status: SELECT 1 in 0.055 seconds
[0m12:35:51.135765 [debug] [MainThread]: On debug: Close
[0m12:35:51.135765 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:35:51.138226 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:35:51.140358 [debug] [MainThread]: Command `dbt debug` succeeded at 12:35:51.140358 after 0.77 seconds
[0m12:35:51.140358 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:35:51.141374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B48EB86D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40D4FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40D4EF50>]}
[0m12:35:51.141374 [debug] [MainThread]: Flushing usage events
[0m12:35:51.587681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:32.797695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248605F25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248605F2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248605F2210>]}


============================== 12:42:32.797695 | c5a4055d-089c-445f-b2eb-abef434caa4a ==============================
[0m12:42:32.797695 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:42:32.797695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:32.973202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024861783090>]}
[0m12:42:33.020745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002485CE9F410>]}
[0m12:42:33.020745 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:33.188176 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:42:33.188176 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:42:33.188176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024861636BD0>]}
[0m12:42:36.481895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sid_lite
[0m12:42:36.481895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248617E1910>]}
[0m12:42:36.541302 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m12:42:36.542533 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m12:42:36.596752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024861DD6D90>]}
[0m12:42:36.598502 [info ] [MainThread]: Found 3 seeds, 705 macros
[0m12:42:36.599836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248605E7FD0>]}
[0m12:42:36.601844 [info ] [MainThread]: 
[0m12:42:36.601844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:36.601844 [info ] [MainThread]: 
[0m12:42:36.601844 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:36.609122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m12:42:36.748666 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m12:42:36.748666 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m12:42:36.748666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:36.792427 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m12:42:36.792427 [debug] [ThreadPool]: On list_sid_lite: Close
[0m12:42:36.795382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m12:42:36.802788 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m12:42:36.802788 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m12:42:36.802788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:36.836992 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m12:42:36.836992 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m12:42:36.836992 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:42:36.881848 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.042 seconds
[0m12:42:36.884002 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m12:42:36.884002 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m12:42:36.891598 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:36.892743 [debug] [MainThread]: On master: BEGIN
[0m12:42:36.892743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:36.926867 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m12:42:36.928736 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:36.928736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:42:36.934624 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:42:36.936374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024861CA4110>]}
[0m12:42:36.937212 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:36.937212 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:36.938244 [debug] [MainThread]: On master: BEGIN
[0m12:42:36.938244 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:42:36.939270 [debug] [MainThread]: On master: COMMIT
[0m12:42:36.939270 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:36.939270 [debug] [MainThread]: On master: COMMIT
[0m12:42:36.940550 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:36.940550 [debug] [MainThread]: On master: Close
[0m12:42:36.991430 [debug] [Thread-1 (]: Began running node seed.sid_lite.etablissement
[0m12:42:36.991430 [info ] [Thread-1 (]: 1 of 3 START seed file public.etablissement .................................... [RUN]
[0m12:42:36.993275 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.sid_lite.etablissement'
[0m12:42:36.994550 [debug] [Thread-1 (]: Began compiling node seed.sid_lite.etablissement
[0m12:42:36.994550 [debug] [Thread-1 (]: Began executing node seed.sid_lite.etablissement
[0m12:42:37.018519 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etablissement"
[0m12:42:37.018519 [debug] [Thread-1 (]: On seed.sid_lite.etablissement: BEGIN
[0m12:42:37.018519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:37.053061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m12:42:37.056899 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etablissement"
[0m12:42:37.056899 [debug] [Thread-1 (]: On seed.sid_lite.etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "seed.sid_lite.etablissement"} */

    create table "sid_lite"."public"."etablissement" ("oid_etablissement" text,"nom_etablissement" text,"pays" text,"type_organisation" text)
  
[0m12:42:37.058033 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m12:42:37.159916 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etablissement"
[0m12:42:37.159916 [debug] [Thread-1 (]: On seed.sid_lite.etablissement: 
          insert into "sid_lite"."public"."etablissement" ("oid_etablissement", "nom_etablissement", "pays", "type_organisation") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m12:42:37.167230 [debug] [Thread-1 (]: SQL status: INSERT 0 500 in 0.005 seconds
[0m12:42:37.168987 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sid_lite.etablissement"
[0m12:42:37.211766 [debug] [Thread-1 (]: On seed.sid_lite.etablissement: COMMIT
[0m12:42:37.211766 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etablissement"
[0m12:42:37.211766 [debug] [Thread-1 (]: On seed.sid_lite.etablissement: COMMIT
[0m12:42:37.211766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:42:37.218880 [debug] [Thread-1 (]: On seed.sid_lite.etablissement: Close
[0m12:42:37.218880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248622627D0>]}
[0m12:42:37.218880 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.etablissement ................................ [[32mCREATE 500[0m in 0.23s]
[0m12:42:37.224412 [debug] [Thread-1 (]: Finished running node seed.sid_lite.etablissement
[0m12:42:37.224412 [debug] [Thread-1 (]: Began running node seed.sid_lite.etudiant
[0m12:42:37.225987 [info ] [Thread-1 (]: 2 of 3 START seed file public.etudiant ......................................... [RUN]
[0m12:42:37.225987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sid_lite.etablissement, now seed.sid_lite.etudiant)
[0m12:42:37.225987 [debug] [Thread-1 (]: Began compiling node seed.sid_lite.etudiant
[0m12:42:37.225987 [debug] [Thread-1 (]: Began executing node seed.sid_lite.etudiant
[0m12:42:37.241825 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etudiant"
[0m12:42:37.241825 [debug] [Thread-1 (]: On seed.sid_lite.etudiant: BEGIN
[0m12:42:37.244057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:37.276829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:42:37.276829 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etudiant"
[0m12:42:37.276829 [debug] [Thread-1 (]: On seed.sid_lite.etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "seed.sid_lite.etudiant"} */

    create table "sid_lite"."public"."etudiant" ("id_etudiant" text,"prenom" text,"nom" text,"sexe" text,"date_naissance" date,"nationalite" text,"discipline" text)
  
[0m12:42:37.276829 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m12:42:37.404719 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etudiant"
[0m12:42:37.404719 [debug] [Thread-1 (]: On seed.sid_lite.etudiant: 
          insert into "sid_lite"."public"."etudiant" ("id_etudiant", "prenom", "nom", "sexe", "date_naissance", "nationalite", "discipline") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%...
[0m12:42:37.444168 [debug] [Thread-1 (]: SQL status: INSERT 0 500 in 0.032 seconds
[0m12:42:37.444168 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sid_lite.etudiant"
[0m12:42:37.444168 [debug] [Thread-1 (]: On seed.sid_lite.etudiant: COMMIT
[0m12:42:37.444168 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.etudiant"
[0m12:42:37.452133 [debug] [Thread-1 (]: On seed.sid_lite.etudiant: COMMIT
[0m12:42:37.452133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:42:37.452133 [debug] [Thread-1 (]: On seed.sid_lite.etudiant: Close
[0m12:42:37.452133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248621B8D90>]}
[0m12:42:37.452133 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.etudiant ..................................... [[32mCREATE 500[0m in 0.23s]
[0m12:42:37.452133 [debug] [Thread-1 (]: Finished running node seed.sid_lite.etudiant
[0m12:42:37.468072 [debug] [Thread-1 (]: Began running node seed.sid_lite.mobilite
[0m12:42:37.468072 [info ] [Thread-1 (]: 3 of 3 START seed file public.mobilite ......................................... [RUN]
[0m12:42:37.468072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.sid_lite.etudiant, now seed.sid_lite.mobilite)
[0m12:42:37.468072 [debug] [Thread-1 (]: Began compiling node seed.sid_lite.mobilite
[0m12:42:37.472457 [debug] [Thread-1 (]: Began executing node seed.sid_lite.mobilite
[0m12:42:37.478901 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.mobilite"
[0m12:42:37.478901 [debug] [Thread-1 (]: On seed.sid_lite.mobilite: BEGIN
[0m12:42:37.478901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:37.531183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:42:37.533192 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.mobilite"
[0m12:42:37.533192 [debug] [Thread-1 (]: On seed.sid_lite.mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "seed.sid_lite.mobilite"} */

    create table "sid_lite"."public"."mobilite" ("id_mobilite" text,"id_etudiant" text,"oid_etablissement_origine" text,"oid_etablissement_accueil" text,"date_debut" date,"date_fin" date,"type_mobilite" text,"statut_mobilite" text)
  
[0m12:42:37.539861 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.006 seconds
[0m12:42:37.683760 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.mobilite"
[0m12:42:37.683760 [debug] [Thread-1 (]: On seed.sid_lite.mobilite: 
          insert into "sid_lite"."public"."mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "date_debut", "date_fin", "type_mobilite", "statut_mobilite") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m12:42:37.701263 [debug] [Thread-1 (]: SQL status: INSERT 0 500 in 0.008 seconds
[0m12:42:37.701263 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sid_lite.mobilite"
[0m12:42:37.701263 [debug] [Thread-1 (]: On seed.sid_lite.mobilite: COMMIT
[0m12:42:37.701263 [debug] [Thread-1 (]: Using postgres connection "seed.sid_lite.mobilite"
[0m12:42:37.701263 [debug] [Thread-1 (]: On seed.sid_lite.mobilite: COMMIT
[0m12:42:37.731035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m12:42:37.733846 [debug] [Thread-1 (]: On seed.sid_lite.mobilite: Close
[0m12:42:37.733846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a4055d-089c-445f-b2eb-abef434caa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024862262FD0>]}
[0m12:42:37.733846 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.mobilite ..................................... [[32mCREATE 500[0m in 0.27s]
[0m12:42:37.736730 [debug] [Thread-1 (]: Finished running node seed.sid_lite.mobilite
[0m12:42:37.738007 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:37.738007 [debug] [MainThread]: On master: BEGIN
[0m12:42:37.738007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:37.776871 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:42:37.778354 [debug] [MainThread]: On master: COMMIT
[0m12:42:37.778354 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:37.778354 [debug] [MainThread]: On master: COMMIT
[0m12:42:37.778354 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:37.778354 [debug] [MainThread]: On master: Close
[0m12:42:37.778354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:37.781830 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m12:42:37.781830 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m12:42:37.781830 [debug] [MainThread]: Connection 'seed.sid_lite.mobilite' was properly closed.
[0m12:42:37.781830 [info ] [MainThread]: 
[0m12:42:37.783837 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m12:42:37.783837 [debug] [MainThread]: Command end result
[0m12:42:37.800005 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m12:42:37.812668 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m12:42:37.819327 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m12:42:37.819327 [info ] [MainThread]: 
[0m12:42:37.821509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:37.822723 [info ] [MainThread]: 
[0m12:42:37.822723 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:42:37.823988 [debug] [MainThread]: Command `dbt seed` succeeded at 12:42:37.823988 after 5.11 seconds
[0m12:42:37.825088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248606292D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248605F0F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248598DF190>]}
[0m12:42:37.825088 [debug] [MainThread]: Flushing usage events
[0m12:42:38.279113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:05.431254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D37FEF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D35AFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D37FEE10>]}


============================== 12:46:05.434631 | f1ad2cbd-01d6-483f-bead-707f2335b729 ==============================
[0m12:46:05.434631 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:46:05.437408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:05.603496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D4886390>]}
[0m12:46:05.666283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D00AF6D0>]}
[0m12:46:05.668289 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:46:05.847345 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:46:06.027216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m12:46:06.027216 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\staging\stg_etablissement.sql
[0m12:46:06.027216 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m12:46:06.031168 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\staging\stg_etudiant.sql
[0m12:46:06.341164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D4FB4B90>]}
[0m12:46:06.396793 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m12:46:06.402864 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m12:46:06.423846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D4C95710>]}
[0m12:46:06.423846 [info ] [MainThread]: Found 3 seeds, 3 models, 705 macros
[0m12:46:06.427400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D4D99F50>]}
[0m12:46:06.427400 [info ] [MainThread]: 
[0m12:46:06.427400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:06.427400 [info ] [MainThread]: 
[0m12:46:06.427400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:06.435214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m12:46:06.608571 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m12:46:06.608571 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m12:46:06.608571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:06.653262 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m12:46:06.653262 [debug] [ThreadPool]: On list_sid_lite: Close
[0m12:46:06.653262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m12:46:06.662932 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m12:46:06.662932 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m12:46:06.663980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:06.695348 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m12:46:06.696365 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m12:46:06.696365 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:46:06.697378 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m12:46:06.697378 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m12:46:06.702893 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m12:46:06.709392 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:06.709392 [debug] [MainThread]: On master: BEGIN
[0m12:46:06.709392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:06.741533 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m12:46:06.741533 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:06.741533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:46:06.749501 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:46:06.752235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D00C9A10>]}
[0m12:46:06.752235 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:06.752235 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:06.752235 [debug] [MainThread]: On master: BEGIN
[0m12:46:06.754589 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:46:06.754589 [debug] [MainThread]: On master: COMMIT
[0m12:46:06.754589 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:06.754589 [debug] [MainThread]: On master: COMMIT
[0m12:46:06.754589 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:06.754589 [debug] [MainThread]: On master: Close
[0m12:46:06.759489 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m12:46:06.759489 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_etablissement ........................... [RUN]
[0m12:46:06.762903 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m12:46:06.763407 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m12:46:06.769423 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m12:46:06.771753 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m12:46:06.798025 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m12:46:06.802034 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m12:46:06.803039 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m12:46:06.803039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:06.975758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.174 seconds
[0m12:46:06.978486 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m12:46:06.978486 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation
from "sid_lite"."public"."etablissement"
  );
[0m12:46:06.990304 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:46:06.993207 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m12:46:06.993207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m12:46:06.993207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:46:07.023812 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m12:46:07.023812 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m12:46:07.023812 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m12:46:07.063527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m12:46:07.070991 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m12:46:07.086925 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m12:46:07.086925 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m12:46:07.086925 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:46:07.086925 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m12:46:07.101462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D539BF10>]}
[0m12:46:07.102974 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.33s]
[0m12:46:07.107165 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m12:46:07.107165 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m12:46:07.109175 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_etudiant ................................ [RUN]
[0m12:46:07.111214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m12:46:07.113422 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m12:46:07.128521 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m12:46:07.135292 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m12:46:07.138502 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m12:46:07.145885 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m12:46:07.145885 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m12:46:07.146958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:07.178069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:46:07.185487 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m12:46:07.185487 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
    id_etudiant,
    prenom,
    nom,
    sexe,
    date_naissance,
    nationalite,
    discipline
from "sid_lite"."public"."etudiant"
  );
[0m12:46:07.185487 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:46:07.192075 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m12:46:07.192075 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m12:46:07.193651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:46:07.195158 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m12:46:07.195158 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m12:46:07.195158 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m12:46:07.231452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m12:46:07.235340 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m12:46:07.236861 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m12:46:07.236861 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m12:46:07.236861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:46:07.239544 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m12:46:07.239544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D5489D50>]}
[0m12:46:07.239544 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:46:07.242366 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m12:46:07.242366 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m12:46:07.243869 [info ] [Thread-1 (]: 3 of 3 START sql view model public.stg_mobilite ................................ [RUN]
[0m12:46:07.243869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m12:46:07.243869 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m12:46:07.248189 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m12:46:07.248189 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m12:46:07.253616 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m12:46:07.254372 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m12:46:07.255889 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m12:46:07.255889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:07.288826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:46:07.294772 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m12:46:07.294772 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m12:46:07.300218 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:46:07.304347 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m12:46:07.304347 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m12:46:07.304347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:46:07.307793 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m12:46:07.307793 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m12:46:07.307793 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m12:46:07.343321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m12:46:07.350576 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m12:46:07.350576 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m12:46:07.350576 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m12:46:07.350576 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:46:07.355996 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m12:46:07.358003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ad2cbd-01d6-483f-bead-707f2335b729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0D491E310>]}
[0m12:46:07.359010 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m12:46:07.360704 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m12:46:07.362235 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:07.362235 [debug] [MainThread]: On master: BEGIN
[0m12:46:07.362235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:07.402433 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m12:46:07.403438 [debug] [MainThread]: On master: COMMIT
[0m12:46:07.403438 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:07.403438 [debug] [MainThread]: On master: COMMIT
[0m12:46:07.404984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:07.404984 [debug] [MainThread]: On master: Close
[0m12:46:07.406502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:07.406502 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m12:46:07.408024 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m12:46:07.408024 [debug] [MainThread]: Connection 'model.sid_lite.stg_mobilite' was properly closed.
[0m12:46:07.408024 [info ] [MainThread]: 
[0m12:46:07.409544 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m12:46:07.411067 [debug] [MainThread]: Command end result
[0m12:46:07.437689 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m12:46:07.437689 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m12:46:07.448680 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m12:46:07.448680 [info ] [MainThread]: 
[0m12:46:07.448680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:07.448680 [info ] [MainThread]: 
[0m12:46:07.451316 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:46:07.452454 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:07.452454 after 2.12 seconds
[0m12:46:07.452454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CCAEFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CCAEEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0CCAFC1D0>]}
[0m12:46:07.452454 [debug] [MainThread]: Flushing usage events
[0m12:46:07.895202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:21.142445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC2D6EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC2D6E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC2D6EC10>]}


============================== 12:47:21.142445 | 3ef7f7b0-6c48-4e42-a539-fea1e989773f ==============================
[0m12:47:21.142445 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:47:21.142445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:47:21.314732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ef7f7b0-6c48-4e42-a539-fea1e989773f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3F1FC50>]}
[0m12:47:21.362254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ef7f7b0-6c48-4e42-a539-fea1e989773f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBF61DED0>]}
[0m12:47:21.362254 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:21.531673 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:47:21.757986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:47:21.769753 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\staging\schema.yml
[0m12:47:22.058133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ef7f7b0-6c48-4e42-a539-fea1e989773f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC4204DD0>]}
[0m12:47:22.137076 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m12:47:22.137076 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m12:47:22.283187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ef7f7b0-6c48-4e42-a539-fea1e989773f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC59B9690>]}
[0m12:47:22.283187 [info ] [MainThread]: Found 3 seeds, 3 models, 6 data tests, 705 macros
[0m12:47:22.284739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ef7f7b0-6c48-4e42-a539-fea1e989773f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC3E8CBD0>]}
[0m12:47:22.286310 [info ] [MainThread]: 
[0m12:47:22.286310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:22.286310 [info ] [MainThread]: 
[0m12:47:22.286310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:22.286310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m12:47:22.432567 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m12:47:22.432567 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m12:47:22.432567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:22.480796 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m12:47:22.480796 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m12:47:22.480796 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:22.480796 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m12:47:22.480796 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m12:47:22.496855 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m12:47:22.496855 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:22.496855 [debug] [MainThread]: On master: BEGIN
[0m12:47:22.496855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:22.531382 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:47:22.531382 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:22.531382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:22.550729 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m12:47:22.553314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ef7f7b0-6c48-4e42-a539-fea1e989773f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC469CF90>]}
[0m12:47:22.554894 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:22.554894 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:22.554894 [debug] [MainThread]: On master: BEGIN
[0m12:47:22.556463 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:47:22.556463 [debug] [MainThread]: On master: COMMIT
[0m12:47:22.556463 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:22.558018 [debug] [MainThread]: On master: COMMIT
[0m12:47:22.558018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:22.558018 [debug] [MainThread]: On master: Close
[0m12:47:22.564328 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m12:47:22.564328 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_etablissement_oid_etablissement ................. [RUN]
[0m12:47:22.565884 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69'
[0m12:47:22.565884 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m12:47:22.581246 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m12:47:22.581246 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m12:47:22.595788 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m12:47:22.595788 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m12:47:22.595788 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m12:47:22.595788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:22.628356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:47:22.637283 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m12:47:22.637591 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m12:47:22.639696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:22.639696 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m12:47:22.639696 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m12:47:22.645877 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.08s]
[0m12:47:22.645877 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m12:47:22.645877 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m12:47:22.649950 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_etudiant_id_etudiant ............................ [RUN]
[0m12:47:22.649950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m12:47:22.650974 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m12:47:22.655146 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m12:47:22.655146 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m12:47:22.658286 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m12:47:22.658286 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m12:47:22.659856 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m12:47:22.659856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:22.697600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:47:22.697600 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m12:47:22.699049 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m12:47:22.699049 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:22.699049 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m12:47:22.699049 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m12:47:22.699049 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.05s]
[0m12:47:22.699049 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m12:47:22.699049 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m12:47:22.699049 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_mobilite_id_mobilite ............................ [RUN]
[0m12:47:22.699049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m12:47:22.699049 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m12:47:22.712297 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m12:47:22.713911 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m12:47:22.715011 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m12:47:22.715011 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m12:47:22.715011 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m12:47:22.715011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:22.753478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:47:22.753478 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m12:47:22.753478 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m12:47:22.753478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:22.753478 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m12:47:22.753478 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m12:47:22.762310 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.06s]
[0m12:47:22.764166 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m12:47:22.765548 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m12:47:22.765548 [info ] [Thread-1 (]: 4 of 6 START test unique_stg_etablissement_oid_etablissement ................... [RUN]
[0m12:47:22.765548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m12:47:22.765548 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m12:47:22.770081 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m12:47:22.798195 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m12:47:22.804171 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m12:47:22.812866 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m12:47:22.812866 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m12:47:22.815565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:22.853495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:47:22.853495 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m12:47:22.853495 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:47:22.853495 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:22.853495 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m12:47:22.853495 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m12:47:22.853495 [info ] [Thread-1 (]: 4 of 6 PASS unique_stg_etablissement_oid_etablissement ......................... [[32mPASS[0m in 0.09s]
[0m12:47:22.861032 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m12:47:22.861032 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m12:47:22.862519 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_etudiant_id_etudiant .............................. [RUN]
[0m12:47:22.862519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m12:47:22.862519 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m12:47:22.862519 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m12:47:22.862519 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m12:47:22.870253 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m12:47:22.899063 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m12:47:22.899063 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m12:47:22.899063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:22.934084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:47:22.934084 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m12:47:22.934084 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:47:22.942375 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:22.942375 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m12:47:22.942375 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m12:47:22.942375 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_etudiant_id_etudiant .................................... [[32mPASS[0m in 0.08s]
[0m12:47:22.942375 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m12:47:22.942375 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m12:47:22.942375 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_mobilite_id_mobilite .............................. [RUN]
[0m12:47:22.942375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m12:47:22.950493 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m12:47:22.953619 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m12:47:22.953619 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m12:47:22.953619 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m12:47:22.982258 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m12:47:22.982258 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m12:47:22.982258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:23.017292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:47:23.024307 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m12:47:23.024307 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:47:23.024307 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:23.029648 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m12:47:23.030152 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m12:47:23.031166 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_mobilite_id_mobilite .................................... [[32mPASS[0m in 0.09s]
[0m12:47:23.032188 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m12:47:23.034534 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:23.034534 [debug] [MainThread]: On master: BEGIN
[0m12:47:23.034534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:23.064957 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:47:23.071988 [debug] [MainThread]: On master: COMMIT
[0m12:47:23.071988 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:23.071988 [debug] [MainThread]: On master: COMMIT
[0m12:47:23.073147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:23.073147 [debug] [MainThread]: On master: Close
[0m12:47:23.073147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:23.074840 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m12:47:23.074840 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m12:47:23.076225 [info ] [MainThread]: 
[0m12:47:23.076225 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:47:23.077262 [debug] [MainThread]: Command end result
[0m12:47:23.104897 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m12:47:23.107968 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m12:47:23.116019 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m12:47:23.116019 [info ] [MainThread]: 
[0m12:47:23.116019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:23.118174 [info ] [MainThread]: 
[0m12:47:23.118174 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m12:47:23.119351 [debug] [MainThread]: Command `dbt test` succeeded at 12:47:23.119351 after 2.08 seconds
[0m12:47:23.119351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBBFAFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CBBFAEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CC2A412D0>]}
[0m12:47:23.121249 [debug] [MainThread]: Flushing usage events
[0m12:47:23.555940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:48.271773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43A3DE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43A419950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43A41AA10>]}


============================== 14:13:48.275724 | ac4d746a-b1f1-43e2-98fb-ddd9b79a51df ==============================
[0m14:13:48.275724 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:13:48.275724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:13:48.442933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac4d746a-b1f1-43e2-98fb-ddd9b79a51df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43B644E50>]}
[0m14:13:48.496990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac4d746a-b1f1-43e2-98fb-ddd9b79a51df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B436C99ED0>]}
[0m14:13:48.498454 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:13:48.661383 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:13:49.240579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m14:13:49.240579 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m14:13:49.240579 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m14:13:49.240579 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m14:13:49.240579 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\schema.yml
[0m14:13:49.690784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac4d746a-b1f1-43e2-98fb-ddd9b79a51df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43BD3EE90>]}
[0m14:13:49.753880 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:13:49.769558 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:13:49.801300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac4d746a-b1f1-43e2-98fb-ddd9b79a51df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43BF87910>]}
[0m14:13:49.801300 [info ] [MainThread]: Found 3 seeds, 6 models, 12 data tests, 705 macros
[0m14:13:49.801300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4d746a-b1f1-43e2-98fb-ddd9b79a51df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43BC31950>]}
[0m14:13:49.801300 [info ] [MainThread]: 
[0m14:13:49.801300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:49.801300 [info ] [MainThread]: 
[0m14:13:49.801300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:49.801300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m14:13:49.989438 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:13:49.989438 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m14:13:49.989438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:50.038667 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m14:13:50.038667 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:13:50.038667 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:13:50.041766 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m14:13:50.041766 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m14:13:50.047322 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m14:13:50.051506 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:50.051506 [debug] [MainThread]: On master: BEGIN
[0m14:13:50.051506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:50.092290 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:13:50.092290 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:50.092290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:50.100313 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m14:13:50.103309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4d746a-b1f1-43e2-98fb-ddd9b79a51df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43BDF0950>]}
[0m14:13:50.103309 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:50.103309 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:50.103309 [debug] [MainThread]: On master: BEGIN
[0m14:13:50.103309 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:13:50.103309 [debug] [MainThread]: On master: COMMIT
[0m14:13:50.103309 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:50.106965 [debug] [MainThread]: On master: COMMIT
[0m14:13:50.106965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:50.106965 [debug] [MainThread]: On master: Close
[0m14:13:50.113323 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m14:13:50.113323 [info ] [Thread-1 (]: 1 of 12 START test not_null_hub_etablissement_hub_etablissement_hashkey ........ [RUN]
[0m14:13:50.114842 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30'
[0m14:13:50.114842 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m14:13:50.128972 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m14:13:50.130308 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m14:13:50.144607 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m14:13:50.149482 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m14:13:50.149482 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: BEGIN
[0m14:13:50.150988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:50.188436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m14:13:50.190728 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m14:13:50.190728 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hub_etablissement_hashkey
from "sid_lite"."public"."hub_etablissement"
where hub_etablissement_hashkey is null



  
  
      
    ) dbt_internal_test
[0m14:13:50.190728 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public.hub_etablissement » n'existe pas
LINE 17: from "sid_lite"."public"."hub_etablissement"
              ^

[0m14:13:50.190728 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: ROLLBACK
[0m14:13:50.190728 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: Close
[0m14:13:50.201641 [debug] [Thread-1 (]: Database Error in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etablissement » n'existe pas
  LINE 17: from "sid_lite"."public"."hub_etablissement"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql
[0m14:13:50.201641 [error] [Thread-1 (]: 1 of 12 ERROR not_null_hub_etablissement_hub_etablissement_hashkey ............. [[31mERROR[0m in 0.09s]
[0m14:13:50.201641 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m14:13:50.201641 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m14:13:50.201641 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30' to be skipped because of status 'error'.  Reason: Database Error in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etablissement » n'existe pas
  LINE 17: from "sid_lite"."public"."hub_etablissement"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql.
[0m14:13:50.201641 [info ] [Thread-1 (]: 2 of 12 START test not_null_hub_etudiant_hub_etudiant_hashkey .................. [RUN]
[0m14:13:50.206462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30, now test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23)
[0m14:13:50.206462 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m14:13:50.206462 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m14:13:50.206462 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m14:13:50.215618 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m14:13:50.217049 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m14:13:50.218123 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: BEGIN
[0m14:13:50.218581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.256702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m14:13:50.256702 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m14:13:50.256702 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hub_etudiant_hashkey
from "sid_lite"."public"."hub_etudiant"
where hub_etudiant_hashkey is null



  
  
      
    ) dbt_internal_test
[0m14:13:50.256702 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public.hub_etudiant » n'existe pas
LINE 17: from "sid_lite"."public"."hub_etudiant"
              ^

[0m14:13:50.256702 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: ROLLBACK
[0m14:13:50.256702 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: Close
[0m14:13:50.261950 [debug] [Thread-1 (]: Database Error in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etudiant » n'existe pas
  LINE 17: from "sid_lite"."public"."hub_etudiant"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql
[0m14:13:50.263489 [error] [Thread-1 (]: 2 of 12 ERROR not_null_hub_etudiant_hub_etudiant_hashkey ....................... [[31mERROR[0m in 0.06s]
[0m14:13:50.263489 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m14:13:50.265236 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m14:13:50.266194 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23' to be skipped because of status 'error'.  Reason: Database Error in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etudiant » n'existe pas
  LINE 17: from "sid_lite"."public"."hub_etudiant"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql.
[0m14:13:50.267456 [info ] [Thread-1 (]: 3 of 12 START test not_null_link_mobilite_link_mobilite_hashkey ................ [RUN]
[0m14:13:50.267456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23, now test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39)
[0m14:13:50.267456 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m14:13:50.270898 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m14:13:50.273387 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m14:13:50.273387 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m14:13:50.273387 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m14:13:50.273387 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: BEGIN
[0m14:13:50.273387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.316717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m14:13:50.318350 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m14:13:50.318350 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select link_mobilite_hashkey
from "sid_lite"."public"."link_mobilite"
where link_mobilite_hashkey is null



  
  
      
    ) dbt_internal_test
[0m14:13:50.320150 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public.link_mobilite » n'existe pas
LINE 17: from "sid_lite"."public"."link_mobilite"
              ^

[0m14:13:50.320150 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: ROLLBACK
[0m14:13:50.320150 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: Close
[0m14:13:50.323701 [debug] [Thread-1 (]: Database Error in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.link_mobilite » n'existe pas
  LINE 17: from "sid_lite"."public"."link_mobilite"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql
[0m14:13:50.323701 [error] [Thread-1 (]: 3 of 12 ERROR not_null_link_mobilite_link_mobilite_hashkey ..................... [[31mERROR[0m in 0.06s]
[0m14:13:50.325174 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m14:13:50.325174 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m14:13:50.325174 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39' to be skipped because of status 'error'.  Reason: Database Error in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.link_mobilite » n'existe pas
  LINE 17: from "sid_lite"."public"."link_mobilite"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql.
[0m14:13:50.325174 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m14:13:50.327617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m14:13:50.328623 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m14:13:50.329675 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m14:13:50.332986 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m14:13:50.334961 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m14:13:50.334961 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m14:13:50.334961 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m14:13:50.337356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.373902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m14:13:50.373902 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m14:13:50.373902 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m14:13:50.376502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:13:50.380579 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m14:13:50.380579 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m14:13:50.382359 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.05s]
[0m14:13:50.382889 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m14:13:50.384040 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m14:13:50.384040 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m14:13:50.385472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m14:13:50.386476 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m14:13:50.389041 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m14:13:50.390576 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m14:13:50.393248 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m14:13:50.394780 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m14:13:50.394780 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m14:13:50.394780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.432899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m14:13:50.433971 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m14:13:50.433971 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m14:13:50.435580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:13:50.438481 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m14:13:50.438481 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m14:13:50.441421 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.05s]
[0m14:13:50.441421 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m14:13:50.442877 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m14:13:50.442877 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m14:13:50.442877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m14:13:50.442877 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m14:13:50.446525 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m14:13:50.448539 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m14:13:50.451900 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m14:13:50.451900 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m14:13:50.451900 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m14:13:50.451900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.492824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m14:13:50.492824 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m14:13:50.492824 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m14:13:50.494993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:13:50.499568 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m14:13:50.500608 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m14:13:50.503094 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.06s]
[0m14:13:50.503094 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m14:13:50.504139 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m14:13:50.504139 [info ] [Thread-1 (]: 7 of 12 START test unique_hub_etablissement_hub_etablissement_hashkey .......... [RUN]
[0m14:13:50.504139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545)
[0m14:13:50.504139 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m14:13:50.509583 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m14:13:50.537076 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m14:13:50.542625 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m14:13:50.551774 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m14:13:50.553779 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: BEGIN
[0m14:13:50.553779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.590300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m14:13:50.590300 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m14:13:50.590300 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hub_etablissement_hashkey as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where hub_etablissement_hashkey is not null
group by hub_etablissement_hashkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:50.598448 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public.hub_etablissement » n'existe pas
LINE 18: from "sid_lite"."public"."hub_etablissement"
              ^

[0m14:13:50.599452 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: ROLLBACK
[0m14:13:50.599763 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: Close
[0m14:13:50.602563 [debug] [Thread-1 (]: Database Error in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etablissement » n'existe pas
  LINE 18: from "sid_lite"."public"."hub_etablissement"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql
[0m14:13:50.602563 [error] [Thread-1 (]: 7 of 12 ERROR unique_hub_etablissement_hub_etablissement_hashkey ............... [[31mERROR[0m in 0.10s]
[0m14:13:50.604568 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m14:13:50.604568 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m14:13:50.604568 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545' to be skipped because of status 'error'.  Reason: Database Error in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etablissement » n'existe pas
  LINE 18: from "sid_lite"."public"."hub_etablissement"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql.
[0m14:13:50.606574 [info ] [Thread-1 (]: 8 of 12 START test unique_hub_etudiant_hub_etudiant_hashkey .................... [RUN]
[0m14:13:50.606574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545, now test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5)
[0m14:13:50.606574 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m14:13:50.613114 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m14:13:50.614861 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m14:13:50.617539 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m14:13:50.619719 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m14:13:50.619719 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: BEGIN
[0m14:13:50.619719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.655322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m14:13:50.662399 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m14:13:50.662399 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hub_etudiant_hashkey as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where hub_etudiant_hashkey is not null
group by hub_etudiant_hashkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:50.662399 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public.hub_etudiant » n'existe pas
LINE 18: from "sid_lite"."public"."hub_etudiant"
              ^

[0m14:13:50.664600 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: ROLLBACK
[0m14:13:50.664600 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: Close
[0m14:13:50.666167 [debug] [Thread-1 (]: Database Error in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etudiant » n'existe pas
  LINE 18: from "sid_lite"."public"."hub_etudiant"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql
[0m14:13:50.668691 [error] [Thread-1 (]: 8 of 12 ERROR unique_hub_etudiant_hub_etudiant_hashkey ......................... [[31mERROR[0m in 0.06s]
[0m14:13:50.668691 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m14:13:50.668691 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m14:13:50.670438 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5' to be skipped because of status 'error'.  Reason: Database Error in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etudiant » n'existe pas
  LINE 18: from "sid_lite"."public"."hub_etudiant"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql.
[0m14:13:50.670438 [info ] [Thread-1 (]: 9 of 12 START test unique_link_mobilite_link_mobilite_hashkey .................. [RUN]
[0m14:13:50.671730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5, now test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550)
[0m14:13:50.671730 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m14:13:50.676076 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m14:13:50.676076 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m14:13:50.678082 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m14:13:50.680087 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m14:13:50.680087 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: BEGIN
[0m14:13:50.680087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:50.857580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.182 seconds
[0m14:13:50.857580 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m14:13:50.857580 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    link_mobilite_hashkey as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where link_mobilite_hashkey is not null
group by link_mobilite_hashkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:50.870615 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la relation « public.link_mobilite » n'existe pas
LINE 18: from "sid_lite"."public"."link_mobilite"
              ^

[0m14:13:50.870615 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: ROLLBACK
[0m14:13:50.870615 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: Close
[0m14:13:50.870615 [debug] [Thread-1 (]: Database Error in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.link_mobilite » n'existe pas
  LINE 18: from "sid_lite"."public"."link_mobilite"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql
[0m14:13:50.870615 [error] [Thread-1 (]: 9 of 12 ERROR unique_link_mobilite_link_mobilite_hashkey ....................... [[31mERROR[0m in 0.20s]
[0m14:13:50.889180 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m14:13:50.889180 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m14:13:50.889180 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550' to be skipped because of status 'error'.  Reason: Database Error in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.link_mobilite » n'existe pas
  LINE 18: from "sid_lite"."public"."link_mobilite"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql.
[0m14:13:50.889180 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m14:13:50.889180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m14:13:50.897403 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m14:13:50.902366 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m14:13:50.902366 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m14:13:50.920374 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m14:13:50.920374 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m14:13:50.920374 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m14:13:50.920374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:51.001457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m14:13:51.001457 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m14:13:51.001457 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:51.017388 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:13:51.017388 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m14:13:51.017388 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m14:13:51.017388 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.13s]
[0m14:13:51.017388 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m14:13:51.017388 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m14:13:51.033081 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m14:13:51.033081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m14:13:51.036791 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m14:13:51.054915 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m14:13:51.057940 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m14:13:51.057940 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m14:13:51.066497 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m14:13:51.066497 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m14:13:51.066497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:51.154194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m14:13:51.170113 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m14:13:51.170113 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:51.170113 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:13:51.170113 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m14:13:51.170113 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m14:13:51.185883 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.15s]
[0m14:13:51.185883 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m14:13:51.185883 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m14:13:51.185883 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m14:13:51.185883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m14:13:51.185883 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m14:13:51.207222 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m14:13:51.210181 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m14:13:51.218076 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m14:13:51.222046 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m14:13:51.223293 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m14:13:51.223293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:51.302663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m14:13:51.302663 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m14:13:51.302663 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:51.302663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:13:51.318746 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m14:13:51.318746 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m14:13:51.318746 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.13s]
[0m14:13:51.318746 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m14:13:51.318746 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:51.318746 [debug] [MainThread]: On master: BEGIN
[0m14:13:51.318746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:51.416385 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m14:13:51.416385 [debug] [MainThread]: On master: COMMIT
[0m14:13:51.416385 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:51.424481 [debug] [MainThread]: On master: COMMIT
[0m14:13:51.424481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:51.424481 [debug] [MainThread]: On master: Close
[0m14:13:51.424481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:51.424481 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m14:13:51.424481 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m14:13:51.433041 [info ] [MainThread]: 
[0m14:13:51.433041 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m14:13:51.433041 [debug] [MainThread]: Command end result
[0m14:13:51.513831 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:13:51.521690 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:13:51.539175 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m14:13:51.539175 [info ] [MainThread]: 
[0m14:13:51.539175 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m14:13:51.539175 [info ] [MainThread]: 
[0m14:13:51.539175 [error] [MainThread]: [31mFailure in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m14:13:51.539175 [error] [MainThread]:   Database Error in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etablissement » n'existe pas
  LINE 17: from "sid_lite"."public"."hub_etablissement"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql
[0m14:13:51.549113 [info ] [MainThread]: 
[0m14:13:51.549113 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql
[0m14:13:51.552411 [info ] [MainThread]: 
[0m14:13:51.552411 [error] [MainThread]: [31mFailure in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m14:13:51.552411 [error] [MainThread]:   Database Error in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etudiant » n'existe pas
  LINE 17: from "sid_lite"."public"."hub_etudiant"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql
[0m14:13:51.557448 [info ] [MainThread]: 
[0m14:13:51.557448 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql
[0m14:13:51.557448 [info ] [MainThread]: 
[0m14:13:51.565500 [error] [MainThread]: [31mFailure in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m14:13:51.565500 [error] [MainThread]:   Database Error in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.link_mobilite » n'existe pas
  LINE 17: from "sid_lite"."public"."link_mobilite"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql
[0m14:13:51.565500 [info ] [MainThread]: 
[0m14:13:51.565500 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql
[0m14:13:51.565500 [info ] [MainThread]: 
[0m14:13:51.574086 [error] [MainThread]: [31mFailure in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m14:13:51.577382 [error] [MainThread]:   Database Error in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etablissement » n'existe pas
  LINE 18: from "sid_lite"."public"."hub_etablissement"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql
[0m14:13:51.579133 [info ] [MainThread]: 
[0m14:13:51.579133 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql
[0m14:13:51.580784 [info ] [MainThread]: 
[0m14:13:51.582300 [error] [MainThread]: [31mFailure in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m14:13:51.583415 [error] [MainThread]:   Database Error in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.hub_etudiant » n'existe pas
  LINE 18: from "sid_lite"."public"."hub_etudiant"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql
[0m14:13:51.584246 [info ] [MainThread]: 
[0m14:13:51.585293 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql
[0m14:13:51.587434 [info ] [MainThread]: 
[0m14:13:51.587434 [error] [MainThread]: [31mFailure in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m14:13:51.589981 [error] [MainThread]:   Database Error in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la relation « public.link_mobilite » n'existe pas
  LINE 18: from "sid_lite"."public"."link_mobilite"
                ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql
[0m14:13:51.590837 [info ] [MainThread]: 
[0m14:13:51.591405 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql
[0m14:13:51.593118 [info ] [MainThread]: 
[0m14:13:51.593118 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=12
[0m14:13:51.595111 [debug] [MainThread]: Command `dbt test` failed at 14:13:51.595111 after 3.48 seconds
[0m14:13:51.595111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43B423150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B43A3E4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B439578F10>]}
[0m14:13:51.595111 [debug] [MainThread]: Flushing usage events
[0m14:13:52.044028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:08.521592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867D072C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E0B7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867D0AAE50>]}


============================== 14:14:08.526459 | 9bdeb70e-1c2f-4970-af5d-2b2ac6867263 ==============================
[0m14:14:08.526459 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:14:08.526459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:08.709366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E2E76D0>]}
[0m14:14:08.763671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867992A290>]}
[0m14:14:08.763671 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:14:08.932547 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:14:09.111849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:09.111849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:09.146681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E71C190>]}
[0m14:14:09.217114 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:14:09.231189 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:14:09.252015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E7C1C10>]}
[0m14:14:09.254294 [info ] [MainThread]: Found 3 seeds, 6 models, 12 data tests, 705 macros
[0m14:14:09.254294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E805610>]}
[0m14:14:09.255661 [info ] [MainThread]: 
[0m14:14:09.255661 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:09.255661 [info ] [MainThread]: 
[0m14:14:09.258594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:09.267344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m14:14:09.515522 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m14:14:09.515522 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m14:14:09.515522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:09.568889 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m14:14:09.571392 [debug] [ThreadPool]: On list_sid_lite: Close
[0m14:14:09.575405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m14:14:09.580159 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:14:09.580159 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m14:14:09.580159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:09.623863 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m14:14:09.625087 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:14:09.625087 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:09.630249 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m14:14:09.633454 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m14:14:09.634483 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m14:14:09.642325 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.643840 [debug] [MainThread]: On master: BEGIN
[0m14:14:09.643840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:09.714515 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m14:14:09.716402 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.716402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:09.722462 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m14:14:09.722462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E865810>]}
[0m14:14:09.724760 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:09.724760 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.724760 [debug] [MainThread]: On master: BEGIN
[0m14:14:09.726618 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:14:09.726618 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.726618 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.726618 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.726618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:09.728558 [debug] [MainThread]: On master: Close
[0m14:14:09.730305 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m14:14:09.732309 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m14:14:09.732309 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m14:14:09.732309 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m14:14:09.735553 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m14:14:09.735553 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m14:14:09.766386 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m14:14:09.766386 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:14:09.770105 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m14:14:09.770105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:09.807061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m14:14:09.807061 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:14:09.807061 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation
from "sid_lite"."public"."etablissement"
  );
[0m14:14:09.815391 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:14:09.815391 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:14:09.815391 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m14:14:09.815391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:09.815391 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:14:09.815391 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m14:14:09.815391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:09.831091 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m14:14:09.831091 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:14:09.831091 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m14:14:09.882012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m14:14:09.892061 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m14:14:09.892061 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:14:09.892061 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m14:14:09.899980 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:14:09.901025 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m14:14:09.906258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867E296F10>]}
[0m14:14:09.908011 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m14:14:09.908011 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m14:14:09.908011 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m14:14:09.908011 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m14:14:09.911351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m14:14:09.911351 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m14:14:09.912543 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m14:14:09.916553 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m14:14:09.918485 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m14:14:09.918485 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:14:09.918485 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m14:14:09.918485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:09.965579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m14:14:09.966704 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:14:09.967728 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
    id_etudiant,
    prenom,
    nom,
    sexe,
    date_naissance,
    nationalite,
    discipline
from "sid_lite"."public"."etudiant"
  );
[0m14:14:09.974603 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:14:09.979231 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:14:09.979231 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m14:14:09.980780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:09.983534 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:14:09.984047 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m14:14:09.984047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:09.985064 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m14:14:09.986605 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:14:09.986605 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m14:14:10.011448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m14:14:10.017718 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m14:14:10.017718 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:14:10.017718 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m14:14:10.024758 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:14:10.026004 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m14:14:10.026004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867EC70C10>]}
[0m14:14:10.026004 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:14:10.026004 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m14:14:10.031657 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m14:14:10.031657 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m14:14:10.032955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m14:14:10.034303 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m14:14:10.037586 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m14:14:10.037586 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m14:14:10.042585 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m14:14:10.043757 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:14:10.044979 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m14:14:10.044979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:10.084152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m14:14:10.086336 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:14:10.086336 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m14:14:10.086336 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:14:10.092443 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:14:10.092443 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m14:14:10.094448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:10.097641 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:14:10.097641 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m14:14:10.097641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:10.101029 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m14:14:10.101029 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:14:10.101029 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m14:14:10.141483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m14:14:10.143235 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m14:14:10.143235 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:14:10.143235 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m14:14:10.143235 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:14:10.153916 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m14:14:10.153916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867EC5BBD0>]}
[0m14:14:10.156920 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:14:10.156920 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m14:14:10.156920 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m14:14:10.158938 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m14:14:10.158938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m14:14:10.158938 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m14:14:10.168523 [debug] [Thread-1 (]: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:14:10.170392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867EC84110>]}
[0m14:14:10.171510 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model public.hub_etablissement ................. [[31mERROR[0m in 0.01s]
[0m14:14:10.172504 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m14:14:10.172504 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m14:14:10.172504 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etablissement' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:14:10.174842 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m14:14:10.175785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m14:14:10.175785 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m14:14:10.179792 [debug] [Thread-1 (]: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:14:10.179792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867EC18910>]}
[0m14:14:10.184824 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model public.hub_etudiant ...................... [[31mERROR[0m in 0.00s]
[0m14:14:10.184824 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m14:14:10.186987 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m14:14:10.186987 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etudiant' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:14:10.188015 [info ] [Thread-1 (]: 6 of 6 START sql table model public.link_mobilite .............................. [RUN]
[0m14:14:10.188015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m14:14:10.188015 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m14:14:10.195839 [debug] [Thread-1 (]: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:14:10.197087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bdeb70e-1c2f-4970-af5d-2b2ac6867263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867ED7D6D0>]}
[0m14:14:10.198108 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model public.link_mobilite ..................... [[31mERROR[0m in 0.01s]
[0m14:14:10.198108 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m14:14:10.199832 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.link_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:14:10.202807 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:10.202807 [debug] [MainThread]: On master: BEGIN
[0m14:14:10.204498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:10.242620 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:14:10.242620 [debug] [MainThread]: On master: COMMIT
[0m14:14:10.242620 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:10.242620 [debug] [MainThread]: On master: COMMIT
[0m14:14:10.242620 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:10.242620 [debug] [MainThread]: On master: Close
[0m14:14:10.242620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:10.242620 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m14:14:10.242620 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m14:14:10.248659 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m14:14:10.248659 [info ] [MainThread]: 
[0m14:14:10.249784 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:14:10.252144 [debug] [MainThread]: Command end result
[0m14:14:10.275523 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:14:10.286955 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:14:10.291703 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m14:14:10.293417 [info ] [MainThread]: 
[0m14:14:10.293417 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:14:10.293417 [info ] [MainThread]: 
[0m14:14:10.293417 [error] [MainThread]: [31mFailure in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)[0m
[0m14:14:10.296479 [error] [MainThread]:   Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:14:10.296479 [info ] [MainThread]: 
[0m14:14:10.296479 [error] [MainThread]: [31mFailure in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)[0m
[0m14:14:10.298066 [error] [MainThread]:   Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:14:10.298066 [info ] [MainThread]: 
[0m14:14:10.298066 [error] [MainThread]: [31mFailure in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)[0m
[0m14:14:10.299922 [error] [MainThread]:   Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:14:10.299922 [info ] [MainThread]: 
[0m14:14:10.301135 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=6
[0m14:14:10.302545 [debug] [MainThread]: Command `dbt run` failed at 14:14:10.302545 after 1.88 seconds
[0m14:14:10.303873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867D0746D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867D067E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002867D067B50>]}
[0m14:14:10.303873 [debug] [MainThread]: Flushing usage events
[0m14:14:10.862480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:25.553284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5531F1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5531A7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5531A7750>]}


============================== 14:17:25.553284 | 69d6a1d3-0e6e-4709-8b45-eafe650dfdca ==============================
[0m14:17:25.553284 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:17:25.569111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:25.737579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554424D90>]}
[0m14:17:25.785150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54FA6F390>]}
[0m14:17:25.785150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:17:25.938544 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:17:26.112154 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 10 files added, 0 files changed.
[0m14:17:26.112154 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\pit.sql
[0m14:17:26.112154 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\xts.sql
[0m14:17:26.112154 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\hub.sql
[0m14:17:26.112154 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\bridge.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\ref_table.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\eff_sat.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\ma_sat.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\link.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\sat.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: added file: sid_lite://macros\t_link.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\eff_sat.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\xts.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\ref_table.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\bridge.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\pit.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\ma_sat.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\t_link.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\sat.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\link.sql
[0m14:17:26.127850 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://macros\tables\postgres\hub.sql
[0m14:17:26.349940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554200D90>]}
[0m14:17:26.491209 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:17:26.491209 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:17:26.522599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E55482D1D0>]}
[0m14:17:26.522599 [info ] [MainThread]: Found 3 seeds, 6 models, 12 data tests, 705 macros
[0m14:17:26.522599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554878E90>]}
[0m14:17:26.522599 [info ] [MainThread]: 
[0m14:17:26.522599 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:26.522599 [info ] [MainThread]: 
[0m14:17:26.522599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:26.522599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m14:17:26.668684 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m14:17:26.668684 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m14:17:26.671047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:26.715534 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m14:17:26.715534 [debug] [ThreadPool]: On list_sid_lite: Close
[0m14:17:26.720141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m14:17:26.726545 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:17:26.726545 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m14:17:26.726545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:26.764973 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m14:17:26.764973 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:17:26.766192 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:17:26.772929 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m14:17:26.772929 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m14:17:26.776481 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m14:17:26.782752 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.782752 [debug] [MainThread]: On master: BEGIN
[0m14:17:26.782752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:26.817041 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m14:17:26.817041 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.817041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:26.830031 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m14:17:26.832178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E55474A190>]}
[0m14:17:26.832178 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:26.832178 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.832178 [debug] [MainThread]: On master: BEGIN
[0m14:17:26.835162 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:17:26.835162 [debug] [MainThread]: On master: COMMIT
[0m14:17:26.835162 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.835162 [debug] [MainThread]: On master: COMMIT
[0m14:17:26.835162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:26.835162 [debug] [MainThread]: On master: Close
[0m14:17:26.841553 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m14:17:26.841553 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m14:17:26.841553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m14:17:26.841553 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m14:17:26.847475 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m14:17:26.847475 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m14:17:26.871194 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m14:17:26.871194 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:17:26.880522 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m14:17:26.881305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:26.918058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m14:17:26.919215 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:17:26.919215 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation
from "sid_lite"."public"."etablissement"
  );
[0m14:17:26.920302 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:17:26.929078 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:17:26.929078 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m14:17:26.929078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:17:26.929078 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:17:26.929078 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m14:17:26.929078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:17:26.945072 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m14:17:26.945072 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:17:26.945072 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m14:17:26.971172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m14:17:26.976232 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m14:17:26.980696 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:17:26.980696 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m14:17:26.980696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:17:26.990850 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m14:17:26.994362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554436A90>]}
[0m14:17:26.995918 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:17:26.995918 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m14:17:26.995918 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m14:17:26.995918 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m14:17:26.995918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m14:17:26.999056 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m14:17:27.000420 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m14:17:27.000420 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m14:17:27.000420 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m14:17:27.000420 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:17:27.000420 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m14:17:27.000420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:27.042911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m14:17:27.051144 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:17:27.052205 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
    id_etudiant,
    prenom,
    nom,
    sexe,
    date_naissance,
    nationalite,
    discipline
from "sid_lite"."public"."etudiant"
  );
[0m14:17:27.053376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:17:27.053376 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:17:27.053376 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m14:17:27.053376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:27.053376 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:17:27.053376 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m14:17:27.053376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:17:27.066892 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m14:17:27.066892 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:17:27.066892 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m14:17:27.100804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m14:17:27.110227 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m14:17:27.110227 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:17:27.110227 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m14:17:27.110227 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:17:27.110227 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m14:17:27.110227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554DA0590>]}
[0m14:17:27.110227 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:17:27.122623 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m14:17:27.122623 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m14:17:27.122623 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m14:17:27.124796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m14:17:27.124796 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m14:17:27.125800 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m14:17:27.125800 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m14:17:27.130594 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m14:17:27.130594 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:17:27.130594 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m14:17:27.130594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:27.176255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m14:17:27.176255 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:17:27.176255 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m14:17:27.176255 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:17:27.186911 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:17:27.186911 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m14:17:27.186911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:27.191631 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:17:27.192635 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m14:17:27.192635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:27.194417 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m14:17:27.194417 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:17:27.196423 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m14:17:27.235943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m14:17:27.242841 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m14:17:27.242841 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:17:27.242841 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m14:17:27.246868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:17:27.249888 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m14:17:27.249888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554C87DD0>]}
[0m14:17:27.249888 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:17:27.249888 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m14:17:27.254751 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m14:17:27.254751 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m14:17:27.254751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m14:17:27.254751 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m14:17:27.269202 [debug] [Thread-1 (]: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:17:27.269949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554D41B10>]}
[0m14:17:27.269949 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model public.hub_etablissement ................. [[31mERROR[0m in 0.02s]
[0m14:17:27.272446 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m14:17:27.273347 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m14:17:27.273760 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etablissement' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:17:27.274772 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m14:17:27.274772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m14:17:27.274772 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m14:17:27.278165 [debug] [Thread-1 (]: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:17:27.281680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554D31A10>]}
[0m14:17:27.281680 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model public.hub_etudiant ...................... [[31mERROR[0m in 0.00s]
[0m14:17:27.283308 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m14:17:27.284327 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m14:17:27.284327 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etudiant' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:17:27.286474 [info ] [Thread-1 (]: 6 of 6 START sql table model public.link_mobilite .............................. [RUN]
[0m14:17:27.287495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m14:17:27.288533 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m14:17:27.291273 [debug] [Thread-1 (]: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:17:27.291273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69d6a1d3-0e6e-4709-8b45-eafe650dfdca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E554EB3B50>]}
[0m14:17:27.291273 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model public.link_mobilite ..................... [[31mERROR[0m in 0.00s]
[0m14:17:27.295371 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m14:17:27.295371 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.link_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:17:27.298084 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:27.299098 [debug] [MainThread]: On master: BEGIN
[0m14:17:27.299098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:27.340459 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m14:17:27.340459 [debug] [MainThread]: On master: COMMIT
[0m14:17:27.340459 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:27.340459 [debug] [MainThread]: On master: COMMIT
[0m14:17:27.340459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:27.340459 [debug] [MainThread]: On master: Close
[0m14:17:27.343274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:27.343274 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m14:17:27.343274 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m14:17:27.343274 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m14:17:27.345285 [info ] [MainThread]: 
[0m14:17:27.346346 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m14:17:27.347353 [debug] [MainThread]: Command end result
[0m14:17:27.378654 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:17:27.382181 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:17:27.388525 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m14:17:27.388525 [info ] [MainThread]: 
[0m14:17:27.391420 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:17:27.391420 [info ] [MainThread]: 
[0m14:17:27.392722 [error] [MainThread]: [31mFailure in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)[0m
[0m14:17:27.393856 [error] [MainThread]:   Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:17:27.393856 [info ] [MainThread]: 
[0m14:17:27.393856 [error] [MainThread]: [31mFailure in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)[0m
[0m14:17:27.395197 [error] [MainThread]:   Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:17:27.395197 [info ] [MainThread]: 
[0m14:17:27.395197 [error] [MainThread]: [31mFailure in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)[0m
[0m14:17:27.397391 [error] [MainThread]:   Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:17:27.397391 [info ] [MainThread]: 
[0m14:17:27.397391 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=6
[0m14:17:27.400150 [debug] [MainThread]: Command `dbt run` failed at 14:17:27.398964 after 1.93 seconds
[0m14:17:27.400150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5542031D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5531B48D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E552348F10>]}
[0m14:17:27.400150 [debug] [MainThread]: Flushing usage events
[0m14:17:27.929130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:51.965460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E80F8FEA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E80F93DF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81094B950>]}


============================== 14:18:51.973867 | f23f954f-dd45-4e7c-87e9-d8bcda3f2a03 ==============================
[0m14:18:51.973867 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:18:51.973867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:18:52.092684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f23f954f-dd45-4e7c-87e9-d8bcda3f2a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81094B050>]}
[0m14:18:52.112752 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m14:18:52.112752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f23f954f-dd45-4e7c-87e9-d8bcda3f2a03', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E810B29CD0>]}
[0m14:18:52.127532 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageInstallPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:18:52.130552 [debug] [MainThread]: Command `dbt clean` succeeded at 14:18:52.130552 after 0.25 seconds
[0m14:18:52.130552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E80F904990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E80EA88E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E808B4FE90>]}
[0m14:18:52.130552 [debug] [MainThread]: Flushing usage events
[0m14:18:52.575593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:58.952039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE22BC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE32E0B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE22FE850>]}


============================== 14:18:58.957183 | 23726545-7a09-4358-9235-444db3a54830 ==============================
[0m14:18:58.957183 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:18:58.957183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:18:59.123623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3458250>]}
[0m14:18:59.170994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FDEB6B950>]}
[0m14:18:59.184510 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:18:59.355199 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:18:59.357205 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:18:59.358895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3755850>]}
[0m14:19:01.112413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3DDFED0>]}
[0m14:19:01.204343 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:19:01.218276 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:19:01.258245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3D41750>]}
[0m14:19:01.259250 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 705 macros
[0m14:19:01.260978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3D5EAD0>]}
[0m14:19:01.262984 [info ] [MainThread]: 
[0m14:19:01.262984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:01.266136 [info ] [MainThread]: 
[0m14:19:01.266136 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:01.274056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m14:19:01.439974 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m14:19:01.439974 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m14:19:01.439974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:01.487675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m14:19:01.489512 [debug] [ThreadPool]: On list_sid_lite: Close
[0m14:19:01.492235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m14:19:01.497724 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:19:01.497724 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m14:19:01.497724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:01.542572 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m14:19:01.542572 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m14:19:01.542572 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:19:01.542572 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m14:19:01.554334 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m14:19:01.554334 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m14:19:01.564459 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:01.564459 [debug] [MainThread]: On master: BEGIN
[0m14:19:01.564459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:01.603020 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:19:01.604122 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:01.604122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:19:01.611987 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m14:19:01.613732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE40062D0>]}
[0m14:19:01.613732 [debug] [MainThread]: On master: ROLLBACK
[0m14:19:01.613732 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:01.615189 [debug] [MainThread]: On master: BEGIN
[0m14:19:01.615189 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:19:01.616443 [debug] [MainThread]: On master: COMMIT
[0m14:19:01.616443 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:01.616443 [debug] [MainThread]: On master: COMMIT
[0m14:19:01.616443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:19:01.617757 [debug] [MainThread]: On master: Close
[0m14:19:01.621576 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m14:19:01.621576 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m14:19:01.621576 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m14:19:01.621576 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m14:19:01.628588 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m14:19:01.633260 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m14:19:01.661030 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m14:19:01.667185 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:19:01.667689 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m14:19:01.668708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:19:01.729598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m14:19:01.731660 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:19:01.731660 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation
from "sid_lite"."public"."etablissement"
  );
[0m14:19:01.739944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:19:01.750107 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:19:01.751632 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m14:19:01.753153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:01.756387 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:19:01.756387 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m14:19:01.757908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:19:01.773687 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m14:19:01.773687 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:19:01.775697 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m14:19:01.777445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:19:01.782554 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m14:19:01.790307 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m14:19:01.790307 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m14:19:01.791971 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:19:01.794915 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m14:19:01.799374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4007B90>]}
[0m14:19:01.799880 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:19:01.801888 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m14:19:01.801888 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m14:19:01.803050 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m14:19:01.804915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m14:19:01.806088 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m14:19:01.810164 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m14:19:01.812221 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m14:19:01.816236 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m14:19:01.817984 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:19:01.819332 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m14:19:01.819332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:01.869169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m14:19:01.869169 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:19:01.870719 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
    id_etudiant,
    prenom,
    nom,
    sexe,
    date_naissance,
    nationalite,
    discipline
from "sid_lite"."public"."etudiant"
  );
[0m14:19:01.876956 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:19:01.881039 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:19:01.882562 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m14:19:01.882562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:01.886562 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:19:01.886562 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m14:19:01.889653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:19:01.891748 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m14:19:01.891748 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:19:01.891748 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m14:19:01.898689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:19:01.901846 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m14:19:01.901846 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m14:19:01.901846 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m14:19:01.903853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:19:01.903853 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m14:19:01.906319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3FF35D0>]}
[0m14:19:01.906319 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:19:01.908326 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m14:19:01.908326 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m14:19:01.908326 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m14:19:01.911115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m14:19:01.911115 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m14:19:01.920819 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m14:19:01.921859 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m14:19:01.925536 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m14:19:01.925536 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:19:01.927774 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m14:19:01.927774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:01.958048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m14:19:01.958048 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:19:01.958048 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m14:19:01.969133 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:19:01.973244 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:19:01.973244 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m14:19:01.974769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:19:01.977825 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:19:01.977825 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m14:19:01.979364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:19:01.980895 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m14:19:01.980895 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:19:01.980895 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m14:19:02.004369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m14:19:02.010060 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m14:19:02.010060 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m14:19:02.010060 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m14:19:02.015177 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:19:02.016147 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m14:19:02.018153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4058B90>]}
[0m14:19:02.019169 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:19:02.020007 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m14:19:02.020007 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m14:19:02.021957 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m14:19:02.022946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m14:19:02.022946 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m14:19:02.032468 [debug] [Thread-1 (]: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:19:02.032468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3EB1E10>]}
[0m14:19:02.034219 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model public.hub_etablissement ................. [[31mERROR[0m in 0.01s]
[0m14:19:02.034219 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m14:19:02.035226 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m14:19:02.035226 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etablissement' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:19:02.036668 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m14:19:02.038133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m14:19:02.038945 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m14:19:02.042665 [debug] [Thread-1 (]: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:19:02.042665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE417E490>]}
[0m14:19:02.042665 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model public.hub_etudiant ...................... [[31mERROR[0m in 0.00s]
[0m14:19:02.042665 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m14:19:02.042665 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m14:19:02.042665 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etudiant' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:19:02.042665 [info ] [Thread-1 (]: 6 of 6 START sql table model public.link_mobilite .............................. [RUN]
[0m14:19:02.042665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m14:19:02.049456 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m14:19:02.053075 [debug] [Thread-1 (]: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:19:02.053075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23726545-7a09-4358-9235-444db3a54830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE38CE3D0>]}
[0m14:19:02.054949 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model public.link_mobilite ..................... [[31mERROR[0m in 0.01s]
[0m14:19:02.055453 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m14:19:02.056520 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.link_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:19:02.057536 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:02.057536 [debug] [MainThread]: On master: BEGIN
[0m14:19:02.058708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:02.091752 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:19:02.091752 [debug] [MainThread]: On master: COMMIT
[0m14:19:02.091752 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:02.091752 [debug] [MainThread]: On master: COMMIT
[0m14:19:02.091752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:19:02.091752 [debug] [MainThread]: On master: Close
[0m14:19:02.091752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:02.091752 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m14:19:02.091752 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m14:19:02.091752 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m14:19:02.101577 [info ] [MainThread]: 
[0m14:19:02.102266 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m14:19:02.103034 [debug] [MainThread]: Command end result
[0m14:19:02.135929 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m14:19:02.141304 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m14:19:02.141304 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m14:19:02.150235 [info ] [MainThread]: 
[0m14:19:02.150235 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:19:02.150235 [info ] [MainThread]: 
[0m14:19:02.153013 [error] [MainThread]: [31mFailure in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)[0m
[0m14:19:02.154498 [error] [MainThread]:   Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:19:02.155920 [info ] [MainThread]: 
[0m14:19:02.157575 [error] [MainThread]: [31mFailure in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)[0m
[0m14:19:02.158618 [error] [MainThread]:   Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:19:02.158618 [info ] [MainThread]: 
[0m14:19:02.158618 [error] [MainThread]: [31mFailure in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)[0m
[0m14:19:02.158618 [error] [MainThread]:   Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:19:02.158618 [info ] [MainThread]: 
[0m14:19:02.158618 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=6
[0m14:19:02.163664 [debug] [MainThread]: Command `dbt run` failed at 14:19:02.163664 after 3.31 seconds
[0m14:19:02.163664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE3307410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FDEB59A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE22BE990>]}
[0m14:19:02.163664 [debug] [MainThread]: Flushing usage events
[0m14:19:02.648517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:04.550248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93D1B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D92D11E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D92CCE790>]}


============================== 15:11:04.550248 | 9c928f7b-74fb-43a4-aae2-18315657413d ==============================
[0m15:11:04.550248 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:11:04.550248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:11:04.701884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c928f7b-74fb-43a4-aae2-18315657413d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93DA5450>]}
[0m15:11:04.727397 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-za_rwzwo'
[0m15:11:04.727397 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:11:04.814152 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:11:04.814152 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:11:05.005289 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:11:05.015522 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:11:05.076873 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:11:05.112382 [info ] [MainThread]: Updating lock file in file path: D:\GitHub\erasmus-sid-lite/package-lock.yml
[0m15:11:05.136893 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-8e5p9ixw'
[0m15:11:05.148559 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:11:05.645643 [info ] [MainThread]: Installed from version 0.11.2
[0m15:11:05.645643 [info ] [MainThread]: Up to date!
[0m15:11:05.650179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c928f7b-74fb-43a4-aae2-18315657413d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93F28210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93E42950>]}
[0m15:11:05.651629 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:11:06.257354 [info ] [MainThread]: Installed from version 1.3.0
[0m15:11:06.257354 [info ] [MainThread]: Up to date!
[0m15:11:06.257354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c928f7b-74fb-43a4-aae2-18315657413d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93E938D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93E7FE10>]}
[0m15:11:06.257354 [debug] [MainThread]: Command `dbt deps` succeeded at 15:11:06.257354 after 1.82 seconds
[0m15:11:06.257354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D8BFBF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D8BFBFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D91E68F10>]}
[0m15:11:06.257354 [debug] [MainThread]: Flushing usage events
[0m15:11:06.671740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:18.790760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ACDDE0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ADE2B690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ADE2ACD0>]}


============================== 15:11:18.793006 | 692b37f0-f20a-4694-a35c-daf25e33b1f2 ==============================
[0m15:11:18.793006 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:11:18.793006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:18.914577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '692b37f0-f20a-4694-a35c-daf25e33b1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ADECCD90>]}
[0m15:11:18.926563 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m15:11:18.926563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '692b37f0-f20a-4694-a35c-daf25e33b1f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ADF7EA10>]}
[0m15:11:18.939435 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageInstallPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:11:18.940576 [debug] [MainThread]: Command `dbt clean` succeeded at 15:11:18.940576 after 0.24 seconds
[0m15:11:18.940576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ADE2A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0ACDE4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A607FE90>]}
[0m15:11:18.940576 [debug] [MainThread]: Flushing usage events
[0m15:11:19.359814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:27.389766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0439E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A043DA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A043DB290>]}


============================== 15:11:27.394115 | 8096b25c-28d2-4cae-9e74-ec19fdb218bf ==============================
[0m15:11:27.394115 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:11:27.394115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:27.558117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A05567250>]}
[0m15:11:27.612632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A00D0DD50>]}
[0m15:11:27.621702 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:11:27.826489 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:11:27.829231 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:11:27.830248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A05628310>]}
[0m15:11:31.288264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A05E47310>]}
[0m15:11:31.406862 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m15:11:31.411523 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m15:11:31.438114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A05DF91D0>]}
[0m15:11:31.438114 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m15:11:31.439877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A05C97450>]}
[0m15:11:31.442267 [info ] [MainThread]: 
[0m15:11:31.442267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:31.442267 [info ] [MainThread]: 
[0m15:11:31.442267 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:31.450313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m15:11:31.591296 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m15:11:31.591296 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m15:11:31.591296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:31.639397 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m15:11:31.640485 [debug] [ThreadPool]: On list_sid_lite: Close
[0m15:11:31.643733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m15:11:31.647594 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m15:11:31.647594 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m15:11:31.647594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:31.686810 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m15:11:31.686810 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m15:11:31.688516 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:11:31.691436 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:11:31.691436 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m15:11:31.694994 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m15:11:31.701364 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:31.701364 [debug] [MainThread]: On master: BEGIN
[0m15:11:31.701364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:31.865948 [debug] [MainThread]: SQL status: BEGIN in 0.177 seconds
[0m15:11:31.881793 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:31.881793 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:31.900597 [debug] [MainThread]: SQL status: SELECT 3 in 0.016 seconds
[0m15:11:31.905911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0560A2D0>]}
[0m15:11:31.907006 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:31.907006 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:31.907006 [debug] [MainThread]: On master: BEGIN
[0m15:11:31.913081 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:11:31.913081 [debug] [MainThread]: On master: COMMIT
[0m15:11:31.915670 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:31.915670 [debug] [MainThread]: On master: COMMIT
[0m15:11:31.918712 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:11:31.921243 [debug] [MainThread]: On master: Close
[0m15:11:31.929643 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m15:11:31.929643 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m15:11:31.938783 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m15:11:31.938783 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m15:11:31.959733 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m15:11:31.993955 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m15:11:32.049826 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m15:11:32.065492 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:11:32.065492 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m15:11:32.065492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:32.144640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:11:32.144640 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:11:32.144640 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation
from "sid_lite"."public"."etablissement"
  );
[0m15:11:32.160551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m15:11:32.176456 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:11:32.176456 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m15:11:32.176456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:32.176456 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:11:32.176456 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m15:11:32.176456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:32.218895 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m15:11:32.218895 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:11:32.218895 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m15:11:32.259670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m15:11:32.274024 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m15:11:32.288080 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:11:32.288080 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m15:11:32.288080 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:11:32.288080 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m15:11:32.309892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A06163390>]}
[0m15:11:32.309892 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.37s]
[0m15:11:32.309892 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m15:11:32.314847 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m15:11:32.316733 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m15:11:32.319067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m15:11:32.320081 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m15:11:32.331952 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m15:11:32.336704 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m15:11:32.344010 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m15:11:32.344010 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:11:32.344010 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m15:11:32.344010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:32.432589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m15:11:32.436524 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:11:32.436524 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
    id_etudiant,
    prenom,
    nom,
    sexe,
    date_naissance,
    nationalite,
    discipline
from "sid_lite"."public"."etudiant"
  );
[0m15:11:32.443809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m15:11:32.450201 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:11:32.450201 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m15:11:32.450201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:32.459770 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:11:32.459770 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m15:11:32.467127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:32.469758 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m15:11:32.469758 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:11:32.472765 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m15:11:32.514893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m15:11:32.519701 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m15:11:32.525586 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:11:32.526457 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m15:11:32.529661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:11:32.535283 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m15:11:32.535283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0619A190>]}
[0m15:11:32.539103 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:11:32.539103 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m15:11:32.539103 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m15:11:32.544208 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m15:11:32.547545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m15:11:32.548085 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m15:11:32.556210 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m15:11:32.557016 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m15:11:32.561477 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m15:11:32.561477 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:11:32.561477 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m15:11:32.571984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:32.655815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:11:32.656866 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:11:32.658631 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m15:11:32.669853 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m15:11:32.676650 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:11:32.676650 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m15:11:32.676650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:32.689816 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:11:32.695230 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m15:11:32.695230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:32.695230 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m15:11:32.695230 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:11:32.703297 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m15:11:32.745766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m15:11:32.758102 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m15:11:32.759636 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:11:32.759636 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m15:11:32.759636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:11:32.759636 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m15:11:32.759636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0625CC50>]}
[0m15:11:32.759636 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m15:11:32.775345 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m15:11:32.775345 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m15:11:32.775345 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m15:11:32.782235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m15:11:32.784549 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m15:11:32.811390 [debug] [Thread-1 (]: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:11:32.811390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0626D6D0>]}
[0m15:11:32.811390 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model public.hub_etablissement ................. [[31mERROR[0m in 0.03s]
[0m15:11:32.811390 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m15:11:32.811390 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m15:11:32.811390 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etablissement' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:11:32.820432 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m15:11:32.825607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m15:11:32.827605 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m15:11:32.838986 [debug] [Thread-1 (]: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:11:32.841455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A06246910>]}
[0m15:11:32.841781 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model public.hub_etudiant ...................... [[31mERROR[0m in 0.02s]
[0m15:11:32.841781 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m15:11:32.846598 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m15:11:32.847645 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etudiant' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:11:32.847645 [info ] [Thread-1 (]: 6 of 6 START sql table model public.link_mobilite .............................. [RUN]
[0m15:11:32.847645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m15:11:32.847645 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m15:11:32.862873 [debug] [Thread-1 (]: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:11:32.862873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8096b25c-28d2-4cae-9e74-ec19fdb218bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0621E490>]}
[0m15:11:32.862873 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model public.link_mobilite ..................... [[31mERROR[0m in 0.02s]
[0m15:11:32.872700 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m15:11:32.874715 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.link_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:11:32.877170 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:32.877170 [debug] [MainThread]: On master: BEGIN
[0m15:11:32.877170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:32.973929 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m15:11:32.973929 [debug] [MainThread]: On master: COMMIT
[0m15:11:32.973929 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:32.973929 [debug] [MainThread]: On master: COMMIT
[0m15:11:32.978185 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:11:32.979216 [debug] [MainThread]: On master: Close
[0m15:11:32.980903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:32.980903 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m15:11:32.983342 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m15:11:32.984524 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m15:11:32.985542 [info ] [MainThread]: 
[0m15:11:32.985542 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m15:11:32.985542 [debug] [MainThread]: Command end result
[0m15:11:33.062791 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m15:11:33.069800 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m15:11:33.079130 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m15:11:33.079130 [info ] [MainThread]: 
[0m15:11:33.079130 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:11:33.084829 [info ] [MainThread]: 
[0m15:11:33.084829 [error] [MainThread]: [31mFailure in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)[0m
[0m15:11:33.084829 [error] [MainThread]:   Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:11:33.087222 [info ] [MainThread]: 
[0m15:11:33.087222 [error] [MainThread]: [31mFailure in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)[0m
[0m15:11:33.088642 [error] [MainThread]:   Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:11:33.090071 [info ] [MainThread]: 
[0m15:11:33.091241 [error] [MainThread]: [31mFailure in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)[0m
[0m15:11:33.091241 [error] [MainThread]:   Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:11:33.091241 [info ] [MainThread]: 
[0m15:11:33.091241 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=6
[0m15:11:33.095666 [debug] [MainThread]: Command `dbt run` failed at 15:11:33.091241 after 5.80 seconds
[0m15:11:33.095666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A053E7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0406D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A0414F310>]}
[0m15:11:33.095666 [debug] [MainThread]: Flushing usage events
[0m15:11:33.613914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:11.352582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA38CE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA491AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA491A910>]}


============================== 15:17:11.360050 | 5dcc7ada-0c5c-46ab-a0cd-3f9f788d965b ==============================
[0m15:17:11.360050 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:17:11.360050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:17:11.474793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dcc7ada-0c5c-46ab-a0cd-3f9f788d965b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA4A6CD90>]}
[0m15:17:11.594883 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-acm_0dts'
[0m15:17:11.595922 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:17:11.728902 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:17:11.730916 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:17:11.985653 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:17:12.001649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:17:12.059049 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:17:12.065817 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:17:12.609969 [info ] [MainThread]: Installed from version 0.11.2
[0m15:17:12.609969 [info ] [MainThread]: Up to date!
[0m15:17:12.609969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5dcc7ada-0c5c-46ab-a0cd-3f9f788d965b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA4A0A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA49E5750>]}
[0m15:17:12.609969 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:17:13.117809 [info ] [MainThread]: Installed from version 1.3.0
[0m15:17:13.117809 [info ] [MainThread]: Up to date!
[0m15:17:13.117809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5dcc7ada-0c5c-46ab-a0cd-3f9f788d965b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA4920D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2901CD0>]}
[0m15:17:13.117809 [debug] [MainThread]: Command `dbt deps` succeeded at 15:17:13.117809 after 1.90 seconds
[0m15:17:13.117809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9F1A5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9CB0F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9CB0FC50>]}
[0m15:17:13.117809 [debug] [MainThread]: Flushing usage events
[0m15:17:13.742983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:25.310725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FCF1E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FCCCFF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FCF62010>]}


============================== 15:17:25.313023 | 0257f575-44fe-42d6-bef7-804ed30e1fb7 ==============================
[0m15:17:25.313023 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:17:25.313023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:25.461793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0257f575-44fe-42d6-bef7-804ed30e1fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FE04A4D0>]}
[0m15:17:25.479353 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m15:17:25.479353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0257f575-44fe-42d6-bef7-804ed30e1fb7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FE147790>]}
[0m15:17:25.486117 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageInstallPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:25.488177 [debug] [MainThread]: Command `dbt clean` succeeded at 15:17:25.488177 after 0.27 seconds
[0m15:17:25.488177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FDF6BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FE087090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FCF24A50>]}
[0m15:17:25.488177 [debug] [MainThread]: Flushing usage events
[0m15:17:25.928303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:35.974437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE17F8E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE17FCAC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE17F8EA90>]}


============================== 15:18:35.978696 | fd8a43d7-b859-48a5-8d9f-241a000ede3d ==============================
[0m15:18:35.978696 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:18:35.979706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:36.109821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd8a43d7-b859-48a5-8d9f-241a000ede3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE1913A950>]}
[0m15:18:36.219292 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-n70bioj8'
[0m15:18:36.219292 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:18:36.355607 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:18:36.355607 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:18:36.555508 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:18:36.560538 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:18:36.618645 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:18:36.630145 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:18:37.167900 [info ] [MainThread]: Installed from version 0.11.2
[0m15:18:37.167900 [info ] [MainThread]: Up to date!
[0m15:18:37.167900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fd8a43d7-b859-48a5-8d9f-241a000ede3d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE17F8FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE190A4590>]}
[0m15:18:37.167900 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:18:37.756471 [info ] [MainThread]: Installed from version 1.3.0
[0m15:18:37.758483 [info ] [MainThread]: Up to date!
[0m15:18:37.758483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fd8a43d7-b859-48a5-8d9f-241a000ede3d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE18FE1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE191FC350>]}
[0m15:18:37.764524 [debug] [MainThread]: Command `dbt deps` succeeded at 15:18:37.764524 after 1.92 seconds
[0m15:18:37.766538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE17D3F510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE17D3FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE111FC210>]}
[0m15:18:37.766538 [debug] [MainThread]: Flushing usage events
[0m15:18:38.219975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:49.538036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001974629F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197462DE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197462DCA50>]}


============================== 15:18:49.542920 | 5c96eea3-6beb-4b4f-b4f1-904a95fbf212 ==============================
[0m15:18:49.542920 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:18:49.542920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:49.670608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c96eea3-6beb-4b4f-b4f1-904a95fbf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197473745D0>]}
[0m15:18:49.784483 [debug] [MainThread]: Command `dbt clean` succeeded at 15:18:49.784483 after 0.37 seconds
[0m15:18:49.784483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197462A4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019747366050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001973F4FFCD0>]}
[0m15:18:49.784483 [debug] [MainThread]: Flushing usage events
[0m15:18:50.236176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:58.909021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971CD1EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971DD67850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971DD67810>]}


============================== 15:18:58.913917 | 3e5fc098-590c-4e92-935d-b849353ce88d ==============================
[0m15:18:58.913917 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:18:58.915925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:18:59.082322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e5fc098-590c-4e92-935d-b849353ce88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971DF25FD0>]}
[0m15:18:59.137698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e5fc098-590c-4e92-935d-b849353ce88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297195DF650>]}
[0m15:18:59.137698 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:18:59.292705 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:18:59.292705 [debug] [MainThread]: Command `dbt run` failed at 15:18:59.292705 after 0.50 seconds
[0m15:18:59.294295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971DD733D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971CD24750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971CD1C290>]}
[0m15:18:59.294295 [debug] [MainThread]: Flushing usage events
[0m15:18:59.728020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:20.804884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BCECECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BCF0E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BCF0DF50>]}


============================== 15:19:20.811381 | dc777ed7-5544-433c-a352-b7a88403c359 ==============================
[0m15:19:20.811381 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:19:20.811381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:20.945839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc777ed7-5544-433c-a352-b7a88403c359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BDFF6C90>]}
[0m15:19:20.975498 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-f5tg2_jw'
[0m15:19:20.975498 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:19:21.077539 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:19:21.077539 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:19:21.141776 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:19:21.146721 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:19:21.206599 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:19:21.207623 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:19:21.741712 [info ] [MainThread]: Installed from version 0.11.2
[0m15:19:21.741712 [info ] [MainThread]: Up to date!
[0m15:19:21.743726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dc777ed7-5544-433c-a352-b7a88403c359', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA067650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BDF17B50>]}
[0m15:19:21.745741 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:19:22.340805 [info ] [MainThread]: Installed from version 1.3.0
[0m15:19:22.344327 [info ] [MainThread]: Up to date!
[0m15:19:22.345369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dc777ed7-5544-433c-a352-b7a88403c359', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BBF01B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BE135310>]}
[0m15:19:22.350422 [debug] [MainThread]: Command `dbt deps` succeeded at 15:19:22.349396 after 1.64 seconds
[0m15:19:22.350422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B614F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B614FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BDEF0950>]}
[0m15:19:22.352282 [debug] [MainThread]: Flushing usage events
[0m15:19:22.761029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:30.921331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001258726EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001258726DDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012588290910>]}


============================== 15:19:30.927011 | 44733def-9c37-45c7-b432-0651dce74f3a ==============================
[0m15:19:30.927011 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:19:30.927011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:31.100078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125884081D0>]}
[0m15:19:31.159852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012583B9B990>]}
[0m15:19:31.163604 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:19:31.370400 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:19:31.373968 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:19:31.373968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012588471BD0>]}
[0m15:19:33.533180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012586AFFF90>]}
[0m15:19:33.595162 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m15:19:33.615526 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m15:19:33.646131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012588E32890>]}
[0m15:19:33.646131 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m15:19:33.649413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012586B20090>]}
[0m15:19:33.651418 [info ] [MainThread]: 
[0m15:19:33.651418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:33.658789 [info ] [MainThread]: 
[0m15:19:33.661941 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:33.667716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m15:19:33.826097 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m15:19:33.826097 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m15:19:33.828103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:33.874223 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m15:19:33.876707 [debug] [ThreadPool]: On list_sid_lite: Close
[0m15:19:33.877243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m15:19:33.884687 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m15:19:33.884687 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m15:19:33.884687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:33.922448 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m15:19:33.922448 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m15:19:33.924199 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:19:33.928660 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:19:33.928660 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m15:19:33.928660 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m15:19:33.937665 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:33.937665 [debug] [MainThread]: On master: BEGIN
[0m15:19:33.937665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:33.972856 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:19:33.972856 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:33.972856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:33.981701 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m15:19:33.984236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012586A0A110>]}
[0m15:19:33.984236 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:33.984236 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:33.984236 [debug] [MainThread]: On master: BEGIN
[0m15:19:33.984236 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:19:33.984236 [debug] [MainThread]: On master: COMMIT
[0m15:19:33.984236 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:33.988539 [debug] [MainThread]: On master: COMMIT
[0m15:19:33.988539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:33.988539 [debug] [MainThread]: On master: Close
[0m15:19:33.994429 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m15:19:33.996170 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m15:19:33.997676 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m15:19:33.997676 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m15:19:33.999115 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m15:19:34.007118 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m15:19:34.045162 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m15:19:34.046857 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:19:34.047864 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m15:19:34.047864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:34.083121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m15:19:34.089563 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:19:34.089563 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation
from "sid_lite"."public"."etablissement"
  );
[0m15:19:34.093893 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:19:34.100664 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:19:34.100664 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m15:19:34.100664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:34.104140 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:19:34.104140 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m15:19:34.104140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:34.117513 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m15:19:34.117513 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:19:34.117513 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m15:19:34.144136 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m15:19:34.152483 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m15:19:34.158751 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m15:19:34.158751 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m15:19:34.161653 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:19:34.163660 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m15:19:34.167831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012588E8D990>]}
[0m15:19:34.168948 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:19:34.169463 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m15:19:34.170910 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m15:19:34.170910 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m15:19:34.170910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m15:19:34.170910 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m15:19:34.177551 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m15:19:34.178196 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m15:19:34.180633 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m15:19:34.180633 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:19:34.180633 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m15:19:34.180633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:34.220025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m15:19:34.220025 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:19:34.220025 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
    id_etudiant,
    prenom,
    nom,
    sexe,
    date_naissance,
    nationalite,
    discipline
from "sid_lite"."public"."etudiant"
  );
[0m15:19:34.228156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:19:34.233513 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:19:34.233513 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m15:19:34.233513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:34.238819 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:19:34.240822 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m15:19:34.240822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:34.242570 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m15:19:34.243937 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:19:34.243937 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m15:19:34.280349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m15:19:34.287221 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m15:19:34.287221 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m15:19:34.287221 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m15:19:34.287221 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:19:34.287221 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m15:19:34.287221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012588D27750>]}
[0m15:19:34.287221 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:34.287221 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m15:19:34.287221 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m15:19:34.287221 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m15:19:34.301187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m15:19:34.301187 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m15:19:34.301187 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m15:19:34.301187 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m15:19:34.301187 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m15:19:34.301187 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:19:34.301187 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m15:19:34.301187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:34.369490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m15:19:34.369490 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:19:34.369490 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m15:19:34.377573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:19:34.377573 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:19:34.377573 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m15:19:34.384079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:34.386083 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:19:34.387552 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m15:19:34.387552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:19:34.388977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m15:19:34.388977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:19:34.388977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m15:19:34.425752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m15:19:34.430422 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m15:19:34.430422 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m15:19:34.430422 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m15:19:34.430422 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:19:34.430422 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m15:19:34.439404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125885462D0>]}
[0m15:19:34.439912 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:19:34.441648 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m15:19:34.441648 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m15:19:34.441648 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m15:19:34.444214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m15:19:34.444214 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m15:19:34.452921 [debug] [Thread-1 (]: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:19:34.455429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012588FAD190>]}
[0m15:19:34.455429 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model public.hub_etablissement ................. [[31mERROR[0m in 0.01s]
[0m15:19:34.458924 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m15:19:34.460403 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m15:19:34.461841 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etablissement' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:19:34.461841 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m15:19:34.464709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m15:19:34.464709 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m15:19:34.469587 [debug] [Thread-1 (]: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:19:34.469587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125890ED150>]}
[0m15:19:34.469587 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model public.hub_etudiant ...................... [[31mERROR[0m in 0.01s]
[0m15:19:34.472140 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m15:19:34.472140 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m15:19:34.472140 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.hub_etudiant' to be skipped because of status 'error'.  Reason: Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:19:34.474178 [info ] [Thread-1 (]: 6 of 6 START sql table model public.link_mobilite .............................. [RUN]
[0m15:19:34.474178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m15:19:34.475517 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m15:19:34.478953 [debug] [Thread-1 (]: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:19:34.480958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44733def-9c37-45c7-b432-0651dce74f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001258910D390>]}
[0m15:19:34.480958 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model public.link_mobilite ..................... [[31mERROR[0m in 0.01s]
[0m15:19:34.480958 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m15:19:34.483408 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.link_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:19:34.484935 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:34.484935 [debug] [MainThread]: On master: BEGIN
[0m15:19:34.486000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:34.525663 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m15:19:34.526669 [debug] [MainThread]: On master: COMMIT
[0m15:19:34.526669 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:34.527332 [debug] [MainThread]: On master: COMMIT
[0m15:19:34.528432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:34.529191 [debug] [MainThread]: On master: Close
[0m15:19:34.529191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:34.529191 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m15:19:34.529191 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m15:19:34.529191 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m15:19:34.531993 [info ] [MainThread]: 
[0m15:19:34.531993 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m15:19:34.531993 [debug] [MainThread]: Command end result
[0m15:19:34.569994 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m15:19:34.569994 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m15:19:34.581092 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m15:19:34.583098 [info ] [MainThread]: 
[0m15:19:34.583098 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:19:34.584877 [info ] [MainThread]: 
[0m15:19:34.584877 [error] [MainThread]: [31mFailure in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)[0m
[0m15:19:34.586257 [error] [MainThread]:   Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:19:34.586257 [info ] [MainThread]: 
[0m15:19:34.586257 [error] [MainThread]: [31mFailure in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)[0m
[0m15:19:34.587600 [error] [MainThread]:   Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:19:34.587600 [info ] [MainThread]: 
[0m15:19:34.589221 [error] [MainThread]: [31mFailure in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)[0m
[0m15:19:34.589562 [error] [MainThread]:   Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  'dbtvault' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:19:34.589562 [info ] [MainThread]: 
[0m15:19:34.589562 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=6
[0m15:19:34.591511 [debug] [MainThread]: Command `dbt run` failed at 15:19:34.591511 after 3.77 seconds
[0m15:19:34.591511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125882B77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125863C20D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001258701F810>]}
[0m15:19:34.591511 [debug] [MainThread]: Flushing usage events
[0m15:19:35.162582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:33.679079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC0E2EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC0E270D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC0E27ED0>]}


============================== 15:21:33.683408 | 9066d047-933d-46ed-9f58-2a279fd14d84 ==============================
[0m15:21:33.683408 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:21:33.683408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:21:33.854820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9066d047-933d-46ed-9f58-2a279fd14d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC1FC3C50>]}
[0m15:21:33.897398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9066d047-933d-46ed-9f58-2a279fd14d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBD73E190>]}
[0m15:21:33.897398 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:34.082272 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:21:34.297570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:21:34.303583 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m15:21:34.303583 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m15:21:34.303583 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m15:21:34.542743 [error] [MainThread]: Encountered an error:
Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  macro 'dbt_macro__link' takes no keyword argument 'link_name'
[0m15:21:34.545222 [debug] [MainThread]: Command `dbt run` failed at 15:21:34.545222 after 0.96 seconds
[0m15:21:34.545222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC0B02050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC22EDC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC22CCA90>]}
[0m15:21:34.545222 [debug] [MainThread]: Flushing usage events
[0m15:21:34.983208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:59.663349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744BDEEF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744BE2DF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744BE2DDD0>]}


============================== 15:21:59.670773 | b03bfa3d-6b0c-48bf-94dc-64d5def5f735 ==============================
[0m15:21:59.670773 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:21:59.670773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:21:59.785997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b03bfa3d-6b0c-48bf-94dc-64d5def5f735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744BE2E890>]}
[0m15:21:59.900891 [debug] [MainThread]: Command `dbt clean` succeeded at 15:21:59.900891 after 0.33 seconds
[0m15:21:59.900891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744BDF4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744BDECE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002744CEC6110>]}
[0m15:21:59.900891 [debug] [MainThread]: Flushing usage events
[0m15:22:00.359590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:06.541474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C8F46F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C7F40910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C7F026D0>]}


============================== 15:22:06.541474 | 50e7c66f-5f06-40f5-a41c-dbe17ee7cb27 ==============================
[0m15:22:06.541474 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:22:06.541474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:06.724660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50e7c66f-5f06-40f5-a41c-dbe17ee7cb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C90BEB10>]}
[0m15:22:06.772112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50e7c66f-5f06-40f5-a41c-dbe17ee7cb27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C47BE210>]}
[0m15:22:06.787801 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:06.951390 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:22:06.954249 [debug] [MainThread]: Command `dbt run` failed at 15:22:06.954249 after 0.50 seconds
[0m15:22:06.954249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C7F04690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C8F53A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C8F53690>]}
[0m15:22:06.954249 [debug] [MainThread]: Flushing usage events
[0m15:22:07.375530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:15.662517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335D7AC2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335D7A7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335E7F7290>]}


============================== 15:22:15.662517 | 691dba98-4452-4575-87da-c9c2d147e67c ==============================
[0m15:22:15.662517 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:22:15.662517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:15.816978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '691dba98-4452-4575-87da-c9c2d147e67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335A2D2250>]}
[0m15:22:15.848428 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-a5c59uca'
[0m15:22:15.864145 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:22:15.974274 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:22:15.976665 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:22:16.229348 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:22:16.257693 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:22:16.312780 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:22:16.328716 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:22:16.951562 [info ] [MainThread]: Installed from version 0.11.2
[0m15:22:16.951562 [info ] [MainThread]: Up to date!
[0m15:22:16.963435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '691dba98-4452-4575-87da-c9c2d147e67c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335E9FE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335E9FFE90>]}
[0m15:22:16.963435 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:22:17.655152 [info ] [MainThread]: Installed from version 1.3.0
[0m15:22:17.655152 [info ] [MainThread]: Up to date!
[0m15:22:17.655152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '691dba98-4452-4575-87da-c9c2d147e67c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335E800C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335E8C5710>]}
[0m15:22:17.655152 [debug] [MainThread]: Command `dbt deps` succeeded at 15:22:17.655152 after 2.11 seconds
[0m15:22:17.655152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233590E5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233569EF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233569EFCD0>]}
[0m15:22:17.655152 [debug] [MainThread]: Flushing usage events
[0m15:22:18.076248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:32.237512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07C3E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07C79710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07C3EF10>]}


============================== 15:22:32.237512 | 1f696e57-83b9-4570-87ec-b7d750af7799 ==============================
[0m15:22:32.237512 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:22:32.237512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:32.406156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f696e57-83b9-4570-87ec-b7d750af7799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD08E33E50>]}
[0m15:22:32.469361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f696e57-83b9-4570-87ec-b7d750af7799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0453BA50>]}
[0m15:22:32.469361 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:32.645763 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:22:32.645763 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:22:32.645763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f696e57-83b9-4570-87ec-b7d750af7799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD08DD9610>]}
[0m15:22:34.429290 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  macro 'dbt_macro__hub' takes no keyword argument 'hub_name'
[0m15:22:34.429290 [debug] [MainThread]: Command `dbt run` failed at 15:22:34.429290 after 2.29 seconds
[0m15:22:34.429290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD08C93650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0928F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD08C7F410>]}
[0m15:22:34.437932 [debug] [MainThread]: Flushing usage events
[0m15:22:34.870337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:24.742488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5AE54C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5AE547710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5AF59B7D0>]}


============================== 15:24:24.747133 | 4993b27d-b046-4efb-81f1-b5295692a39b ==============================
[0m15:24:24.747133 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:24:24.747133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:24.864317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4993b27d-b046-4efb-81f1-b5295692a39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5AE54E910>]}
[0m15:24:24.969920 [debug] [MainThread]: Command `dbt clean` succeeded at 15:24:24.969920 after 0.36 seconds
[0m15:24:24.972879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5AE554910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5A77BFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5A77BFC90>]}
[0m15:24:24.972879 [debug] [MainThread]: Flushing usage events
[0m15:24:25.405878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:32.074514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D372E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D376A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D47774D0>]}


============================== 15:24:32.074514 | 852d8023-afc9-4203-b18e-7177f94e4c40 ==============================
[0m15:24:32.074514 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:24:32.074514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:32.202415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '852d8023-afc9-4203-b18e-7177f94e4c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D48D9610>]}
[0m15:24:32.218362 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-s5wojn7l'
[0m15:24:32.234203 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:24:32.348560 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:24:32.348560 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:24:32.445210 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:24:32.455238 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:24:32.506208 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:24:32.516493 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:24:33.120643 [info ] [MainThread]: Installed from version 0.11.2
[0m15:24:33.122167 [info ] [MainThread]: Up to date!
[0m15:24:33.122167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '852d8023-afc9-4203-b18e-7177f94e4c40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D3727210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D4868950>]}
[0m15:24:33.125737 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:24:33.674312 [info ] [MainThread]: Installed from version 1.3.0
[0m15:24:33.674312 [info ] [MainThread]: Up to date!
[0m15:24:33.674312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '852d8023-afc9-4203-b18e-7177f94e4c40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D4844950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D4845710>]}
[0m15:24:33.674312 [debug] [MainThread]: Command `dbt deps` succeeded at 15:24:33.674312 after 1.70 seconds
[0m15:24:33.674312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D28B9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253D372C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253CC96F090>]}
[0m15:24:33.674312 [debug] [MainThread]: Flushing usage events
[0m15:24:34.115185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:44.660433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11103E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F112087710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F112087D90>]}


============================== 15:24:44.664710 | cbb94a92-a5ec-47f1-9192-dc3d0bbab30a ==============================
[0m15:24:44.664710 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:24:44.664710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:44.870580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb94a92-a5ec-47f1-9192-dc3d0bbab30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F112245D10>]}
[0m15:24:44.928084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb94a92-a5ec-47f1-9192-dc3d0bbab30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10D91E6D0>]}
[0m15:24:44.930918 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:24:45.123765 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:24:45.125290 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:24:45.125290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbb94a92-a5ec-47f1-9192-dc3d0bbab30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1121D9510>]}
[0m15:24:46.782880 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  macro 'dbt_macro__hub' takes no keyword argument 'hub_name'
[0m15:24:46.782880 [debug] [MainThread]: Command `dbt run` failed at 15:24:46.782880 after 2.22 seconds
[0m15:24:46.787011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11103C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F111044910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10A3CFC90>]}
[0m15:24:46.788408 [debug] [MainThread]: Flushing usage events
[0m15:24:47.255458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:13.449669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99C2E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99C26D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99C27B50>]}


============================== 15:32:13.451682 | 475f9f01-f6b4-4cdb-ba13-f9c72963ad11 ==============================
[0m15:32:13.451682 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:32:13.455223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:32:13.633955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '475f9f01-f6b4-4cdb-ba13-f9c72963ad11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99E73E90>]}
[0m15:32:13.692481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '475f9f01-f6b4-4cdb-ba13-f9c72963ad11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D9550F790>]}
[0m15:32:13.694444 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:32:13.851717 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:32:13.851717 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:32:13.851717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '475f9f01-f6b4-4cdb-ba13-f9c72963ad11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99CA7610>]}
[0m15:32:15.269738 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  The object (""sid_lite"."public"."hub_etablissement"") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro is_list (macros\internal\helpers\is_checks.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
[0m15:32:15.285945 [debug] [MainThread]: Command `dbt run` failed at 15:32:15.285438 after 1.94 seconds
[0m15:32:15.285945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99C34A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D99D474D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D983EFE90>]}
[0m15:32:15.288989 [debug] [MainThread]: Flushing usage events
[0m15:32:15.924874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:40.109956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BD13F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BD137310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BD17E410>]}


============================== 15:38:40.115015 | b05e42bf-bb60-417c-a151-6bdb602c411f ==============================
[0m15:38:40.115015 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:38:40.115015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:40.289524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b05e42bf-bb60-417c-a151-6bdb602c411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BE346210>]}
[0m15:38:40.337102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b05e42bf-bb60-417c-a151-6bdb602c411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B99EB850>]}
[0m15:38:40.337102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:38:40.530113 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:38:40.530113 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:38:40.530113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b05e42bf-bb60-417c-a151-6bdb602c411f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BE5D8590>]}
[0m15:38:41.999276 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro postgres__hub (macros\tables\postgres\hub.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
[0m15:38:41.999276 [debug] [MainThread]: Command `dbt run` failed at 15:38:41.999276 after 1.98 seconds
[0m15:38:41.999276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BE837FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9B8A65A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9BC2C8F10>]}
[0m15:38:41.999276 [debug] [MainThread]: Flushing usage events
[0m15:38:42.432742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:22.002274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A7C7EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A7CC1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A7CC0B10>]}


============================== 15:39:22.007243 | 9a606cbc-2005-47df-912a-f3cc588f9084 ==============================
[0m15:39:22.007243 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:39:22.007243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:39:22.204112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a606cbc-2005-47df-912a-f3cc588f9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A6D72250>]}
[0m15:39:22.260404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a606cbc-2005-47df-912a-f3cc588f9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A453BA10>]}
[0m15:39:22.262409 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:39:22.441264 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:39:22.444449 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:39:22.444449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a606cbc-2005-47df-912a-f3cc588f9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A8DA9D50>]}
[0m15:39:23.976898 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  The object (""sid_lite"."public"."hub_etablissement"") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro is_list (macros\internal\helpers\is_checks.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
[0m15:39:23.976898 [debug] [MainThread]: Command `dbt run` failed at 15:39:23.976898 after 2.10 seconds
[0m15:39:23.976898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A7C84890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A938F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A9380710>]}
[0m15:39:23.992915 [debug] [MainThread]: Flushing usage events
[0m15:39:24.426284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:45.217958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC31BF790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC340C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC340E290>]}


============================== 15:42:45.222649 | 576f7cae-b5cd-4217-b920-ef4683d88da1 ==============================
[0m15:42:45.222649 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:42:45.224042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:45.349903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '576f7cae-b5cd-4217-b920-ef4683d88da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC455E450>]}
[0m15:42:45.448121 [debug] [MainThread]: Command `dbt clean` succeeded at 15:42:45.448121 after 0.35 seconds
[0m15:42:45.448121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3414B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC340E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC340C290>]}
[0m15:42:45.449211 [debug] [MainThread]: Flushing usage events
[0m15:42:45.912932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:52.314190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D84C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D8C2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D8C3950>]}


============================== 15:42:52.314190 | effd0acb-a659-4c8e-8e61-1b691b7aea2b ==============================
[0m15:42:52.314190 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:42:52.314190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:52.465414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'effd0acb-a659-4c8e-8e61-1b691b7aea2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D8C3050>]}
[0m15:42:52.497147 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-zudok9g7'
[0m15:42:52.497147 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:42:52.623211 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:42:52.625225 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:42:52.695972 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:42:52.701730 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:42:52.763233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:42:52.776907 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:42:53.386033 [info ] [MainThread]: Installed from version 0.11.2
[0m15:42:53.386033 [info ] [MainThread]: Up to date!
[0m15:42:53.386033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'effd0acb-a659-4c8e-8e61-1b691b7aea2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D8D12D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768DAD6F50>]}
[0m15:42:53.386033 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:42:54.017648 [info ] [MainThread]: Installed from version 1.3.0
[0m15:42:54.017648 [info ] [MainThread]: Up to date!
[0m15:42:54.025751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'effd0acb-a659-4c8e-8e61-1b691b7aea2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D994B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D995CD0>]}
[0m15:42:54.027152 [debug] [MainThread]: Command `dbt deps` succeeded at 15:42:54.027152 after 1.81 seconds
[0m15:42:54.030935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D84C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768D8DF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001768C551410>]}
[0m15:42:54.032379 [debug] [MainThread]: Flushing usage events
[0m15:42:54.666547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:00.572157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA853C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA8587850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA85856D0>]}


============================== 15:43:00.582820 | c3c558f3-7024-4939-8a39-917184a88836 ==============================
[0m15:43:00.582820 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:43:00.582820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:43:00.755708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c558f3-7024-4939-8a39-917184a88836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA87102D0>]}
[0m15:43:00.819921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c558f3-7024-4939-8a39-917184a88836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA3E1F550>]}
[0m15:43:00.823454 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:43:01.009910 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:43:01.018367 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:43:01.018367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c558f3-7024-4939-8a39-917184a88836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA86990D0>]}
[0m15:43:02.042780 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'dateadd' found within namespace: 'automate_dv'
      Searched for: 'postgres.postgres__dateadd', 'postgres.default__dateadd', 'default.postgres__dateadd', 'default.default__dateadd'
[0m15:43:02.042780 [debug] [MainThread]: Command `dbt run` failed at 15:43:02.042780 after 1.56 seconds
[0m15:43:02.042780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA6584610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA8537410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA8537D50>]}
[0m15:43:02.042780 [debug] [MainThread]: Flushing usage events
[0m15:43:02.531794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:28.192898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9219E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D921E3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D921E1610>]}


============================== 15:50:28.198941 | d7ed07b5-44aa-4ee6-a50b-cd3074c950f0 ==============================
[0m15:50:28.198941 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:50:28.198941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:28.329081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ed07b5-44aa-4ee6-a50b-cd3074c950f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D93349090>]}
[0m15:50:28.438353 [debug] [MainThread]: Command `dbt clean` succeeded at 15:50:28.438353 after 0.34 seconds
[0m15:50:28.438353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D921A4A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9219CBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D9219E950>]}
[0m15:50:28.438353 [debug] [MainThread]: Flushing usage events
[0m15:50:28.902824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:46.878788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E70CE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E70CEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E70CF3D0>]}


============================== 15:50:46.883243 | 54ef5851-2670-4557-bc08-3ac3b166d165 ==============================
[0m15:50:46.883243 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:50:46.883243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:47.007525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54ef5851-2670-4557-bc08-3ac3b166d165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E81D86D0>]}
[0m15:50:47.036364 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-wj0o4hgw'
[0m15:50:47.036364 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:50:47.153280 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:50:47.155288 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m15:50:47.328399 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m15:50:47.333043 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:50:47.392047 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:50:47.392047 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m15:50:47.900413 [info ] [MainThread]: Installed from version 0.11.2
[0m15:50:47.900413 [info ] [MainThread]: Up to date!
[0m15:50:47.900413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54ef5851-2670-4557-bc08-3ac3b166d165', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E70CF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E61B2050>]}
[0m15:50:47.904466 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:50:48.460121 [info ] [MainThread]: Installed from version 1.3.0
[0m15:50:48.462234 [info ] [MainThread]: Up to date!
[0m15:50:48.462234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54ef5851-2670-4557-bc08-3ac3b166d165', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E82369D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E8236C10>]}
[0m15:50:48.462234 [debug] [MainThread]: Command `dbt deps` succeeded at 15:50:48.462234 after 1.69 seconds
[0m15:50:48.468267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E811F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E033F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119E033FE90>]}
[0m15:50:48.468267 [debug] [MainThread]: Flushing usage events
[0m15:50:48.874773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:30.808789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692E95E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692DAF8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692E125590>]}


============================== 15:51:30.808789 | a8102156-6807-4107-91c9-eb9568f6802b ==============================
[0m15:51:30.808789 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:51:30.808789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:51:30.984171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8102156-6807-4107-91c9-eb9568f6802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692FAF3B10>]}
[0m15:51:31.047915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8102156-6807-4107-91c9-eb9568f6802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692B21A250>]}
[0m15:51:31.053861 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:31.232350 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:51:31.232350 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:51:31.232350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8102156-6807-4107-91c9-eb9568f6802b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692E899910>]}
[0m15:51:32.482579 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'dateadd' found within namespace: 'automate_dv'
      Searched for: 'postgres.postgres__dateadd', 'postgres.default__dateadd', 'default.postgres__dateadd', 'default.default__dateadd'
[0m15:51:32.482579 [debug] [MainThread]: Command `dbt run` failed at 15:51:32.482579 after 1.78 seconds
[0m15:51:32.482579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692FBD1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692B1A7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001692FF02690>]}
[0m15:51:32.482579 [debug] [MainThread]: Flushing usage events
[0m15:51:32.955984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:55.665854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3B23E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3AFEF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3C28BDD0>]}


============================== 15:51:55.670572 | 4b35a70d-cae4-4599-954c-f72431b6af77 ==============================
[0m15:51:55.670572 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:51:55.671771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:55.845402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b35a70d-cae4-4599-954c-f72431b6af77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3C4B37D0>]}
[0m15:51:55.900064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b35a70d-cae4-4599-954c-f72431b6af77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B37AFDFD0>]}
[0m15:51:55.900064 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:56.080564 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:51:56.082686 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:51:56.082686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b35a70d-cae4-4599-954c-f72431b6af77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3C6D8090>]}
[0m15:51:56.999878 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'dateadd' found within namespace: 'automate_dv'
      Searched for: 'postgres.postgres__dateadd', 'postgres.default__dateadd', 'default.postgres__dateadd', 'default.default__dateadd'
[0m15:51:57.015170 [debug] [MainThread]: Command `dbt run` failed at 15:51:57.015170 after 1.44 seconds
[0m15:51:57.015170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3C7E1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3C52F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3C4AB290>]}
[0m15:51:57.015170 [debug] [MainThread]: Flushing usage events
[0m15:51:57.435630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:51.445509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DE8E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DED27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8EEB4C90>]}


============================== 15:52:51.450105 | 843fb0fb-591e-4006-893d-d176add723e4 ==============================
[0m15:52:51.450105 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:52:51.451851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:51.621473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '843fb0fb-591e-4006-893d-d176add723e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DE97E90>]}
[0m15:52:51.676272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '843fb0fb-591e-4006-893d-d176add723e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8A74A110>]}
[0m15:52:51.679802 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:51.850976 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:52:51.850976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:52:51.850976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '843fb0fb-591e-4006-893d-d176add723e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8EED6650>]}
[0m15:52:52.186534 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "dateadd" in the project "automate_dv".
   To fix this error, rename or remove one of the following macros:
      - macros\internal\helpers\dateadd.sql
      - macros\postgres__dateadd.sql
[0m15:52:52.186534 [debug] [MainThread]: Command `dbt run` failed at 15:52:52.186534 after 0.84 seconds
[0m15:52:52.186534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DDCDA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DE8F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA8DE8CE10>]}
[0m15:52:52.186534 [debug] [MainThread]: Flushing usage events
[0m15:52:52.651391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:23.515762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8A88E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8A8D2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8B8D7490>]}


============================== 15:53:23.515762 | 766fc9d6-0214-4c5d-ab99-1c17310bcf92 ==============================
[0m15:53:23.515762 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:53:23.515762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:53:23.711361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '766fc9d6-0214-4c5d-ab99-1c17310bcf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8B8DD850>]}
[0m15:53:23.761172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '766fc9d6-0214-4c5d-ab99-1c17310bcf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8714F610>]}
[0m15:53:23.761172 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:53:23.933157 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:53:23.933157 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:53:23.933157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '766fc9d6-0214-4c5d-ab99-1c17310bcf92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8B8DE750>]}
[0m15:53:24.844518 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'dateadd' found within namespace: 'automate_dv'
      Searched for: 'postgres.postgres__dateadd', 'postgres.default__dateadd', 'default.postgres__dateadd', 'default.default__dateadd'
[0m15:53:24.860215 [debug] [MainThread]: Command `dbt run` failed at 15:53:24.860215 after 1.43 seconds
[0m15:53:24.860215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8BA97510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8BB1A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8BA7F090>]}
[0m15:53:24.860215 [debug] [MainThread]: Flushing usage events
[0m15:53:25.292540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:30.664679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA20BE790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA20FFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA20FE710>]}


============================== 15:54:30.664679 | c0b19e1a-6dc0-42ec-a1dd-342ceb9cbe5d ==============================
[0m15:54:30.664679 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:54:30.664679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:30.856258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b19e1a-6dc0-42ec-a1dd-342ceb9cbe5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA328AE90>]}
[0m15:54:30.916933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b19e1a-6dc0-42ec-a1dd-342ceb9cbe5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F9E97F590>]}
[0m15:54:30.916933 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:54:31.089683 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:54:31.102394 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:54:31.102394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0b19e1a-6dc0-42ec-a1dd-342ceb9cbe5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA3107610>]}
[0m15:54:32.042634 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'timestamp_add' found within namespace: 'automate_dv'
      Searched for: 'postgres.postgres__timestamp_add', 'postgres.default__timestamp_add', 'default.postgres__timestamp_add', 'default.default__timestamp_add'
[0m15:54:32.042634 [debug] [MainThread]: Command `dbt run` failed at 15:54:32.042634 after 1.48 seconds
[0m15:54:32.042634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA20BE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA20BC290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA331F4D0>]}
[0m15:54:32.042634 [debug] [MainThread]: Flushing usage events
[0m15:54:32.520604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:27.164543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CC15C390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CC19ACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD1A7BD0>]}


============================== 15:58:27.180237 | 28fdf899-ce32-4f89-82ba-9a6b41b37fd5 ==============================
[0m15:58:27.180237 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:58:27.180237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:27.355876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28fdf899-ce32-4f89-82ba-9a6b41b37fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD33ED90>]}
[0m15:58:27.422190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28fdf899-ce32-4f89-82ba-9a6b41b37fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0C8A3F610>]}
[0m15:58:27.422190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:27.589436 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:58:27.589436 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:58:27.605278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28fdf899-ce32-4f89-82ba-9a6b41b37fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD296A10>]}
[0m15:58:28.502408 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'timestamp_add' found within namespace: 'automate_dv'
      Searched for: 'postgres.postgres__timestamp_add', 'postgres.default__timestamp_add', 'default.postgres__timestamp_add', 'default.default__timestamp_add'
[0m15:58:28.502408 [debug] [MainThread]: Command `dbt run` failed at 15:58:28.502408 after 1.44 seconds
[0m15:58:28.502408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD74F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD27FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0CD7C6050>]}
[0m15:58:28.518082 [debug] [MainThread]: Flushing usage events
[0m15:58:28.939844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:23.029021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216835EFB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021683629E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216835EEAD0>]}


============================== 15:59:23.029021 | 0bebd1c3-383e-477a-91ef-1ca2d41576f6 ==============================
[0m15:59:23.029021 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:59:23.029021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:23.204408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bebd1c3-383e-477a-91ef-1ca2d41576f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021682DEB4D0>]}
[0m15:59:23.268051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bebd1c3-383e-477a-91ef-1ca2d41576f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FFEADE90>]}
[0m15:59:23.268051 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:59:23.439309 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:59:23.439309 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:59:23.439309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bebd1c3-383e-477a-91ef-1ca2d41576f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021684A86A10>]}
[0m15:59:24.340543 [error] [MainThread]: Encountered an error:
Compilation Error
  In dispatch: No macro named 'timestamp_add' found within namespace: 'automate_dv'
      Searched for: 'macros.postgres__timestamp_add', 'macros.default__timestamp_add', 'default.postgres__timestamp_add', 'default.default__timestamp_add'
[0m15:59:24.340543 [debug] [MainThread]: Command `dbt run` failed at 15:59:24.340543 after 1.41 seconds
[0m15:59:24.340543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168352DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168339F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168361C610>]}
[0m15:59:24.340543 [debug] [MainThread]: Flushing usage events
[0m15:59:24.798157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:45.038108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BB12EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BB12EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BB12E290>]}


============================== 16:00:45.038108 | 8e67b782-9d79-4cf5-bc85-7cf601ea1e02 ==============================
[0m16:00:45.038108 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:00:45.038108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:45.162087 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Invalid project dispatch config: {'search_order': ['macros', 'default']}

Error encountered in D:\GitHub\erasmus-sid-lite\dbt_project.yml
[0m16:00:45.162087 [debug] [MainThread]: Command `dbt run` failed at 16:00:45.162087 after 0.25 seconds
[0m16:00:45.162087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BA2C8E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BC217090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BC17F410>]}
[0m16:00:45.174656 [debug] [MainThread]: Flushing usage events
[0m16:00:45.631245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:07.054628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030DEC2A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030EF0BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030EF0A6D0>]}


============================== 16:01:07.060771 | ade9d970-9573-4d11-9357-1325dec08348 ==============================
[0m16:01:07.060771 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:01:07.060771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:01:07.222002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade9d970-9573-4d11-9357-1325dec08348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030CFA2310>]}
[0m16:01:07.290003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ade9d970-9573-4d11-9357-1325dec08348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030A76DCD0>]}
[0m16:01:07.292009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:01:07.460078 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:01:07.493308 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:01:07.497184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ade9d970-9573-4d11-9357-1325dec08348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030F313650>]}
[0m16:01:08.899896 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  The object (""sid_lite"."public"."hub_etablissement"") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro is_list (macros\internal\helpers\is_checks.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
[0m16:01:08.911419 [debug] [MainThread]: Command `dbt run` failed at 16:01:08.911419 after 1.95 seconds
[0m16:01:08.914492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030DEB7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030F67F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030DEC4650>]}
[0m16:01:08.915603 [debug] [MainThread]: Flushing usage events
[0m16:01:09.682212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:15.845784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2C62EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2D6778D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2C669E50>]}


============================== 16:03:15.847252 | 44833abf-54bd-4b6c-92da-92354114bd8b ==============================
[0m16:03:15.847252 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:03:15.847252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:03:16.010533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44833abf-54bd-4b6c-92da-92354114bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2D835810>]}
[0m16:03:16.073049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44833abf-54bd-4b6c-92da-92354114bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA28EEA010>]}
[0m16:03:16.073049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:03:16.243845 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:03:16.247384 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:03:16.247384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44833abf-54bd-4b6c-92da-92354114bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2D7C7C90>]}
[0m16:03:17.771656 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro postgres__hub (macros\tables\postgres\hub.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
[0m16:03:17.771656 [debug] [MainThread]: Command `dbt run` failed at 16:03:17.771656 after 2.03 seconds
[0m16:03:17.771656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2DE1FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2BDDA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2C66A950>]}
[0m16:03:17.771656 [debug] [MainThread]: Flushing usage events
[0m16:03:18.257669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:47.700443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB64BDE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB65C26F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB64C1DC10>]}


============================== 16:03:47.704833 | 132c354c-3516-43f0-9766-8c8a987e5827 ==============================
[0m16:03:47.704833 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:03:47.704833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:47.861275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB65D9EA10>]}
[0m16:03:47.926531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB614DE0D0>]}
[0m16:03:47.926531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:03:48.100873 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:03:48.102879 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:03:48.104100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB64C1E950>]}
[0m16:03:49.852402 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hub_etudiant' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m16:03:49.852402 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hub_etablissement' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m16:03:49.859787 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'link_mobilite' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m16:03:49.865404 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etudiant' in package '' which was not found
[0m16:03:49.865404 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etudiant' in package '' which was not found
[0m16:03:49.872692 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etablissement' in package '' which was not found
[0m16:03:49.872692 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etablissement' in package '' which was not found
[0m16:03:49.872692 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'link_mobilite' in package '' which was not found
[0m16:03:49.872692 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'link_mobilite' in package '' which was not found
[0m16:03:50.058633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6657FE90>]}
[0m16:03:50.138910 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:03:50.138910 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:03:50.170639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6641D090>]}
[0m16:03:50.170639 [info ] [MainThread]: Found 3 models, 3 seeds, 6 data tests, 820 macros
[0m16:03:50.170639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB661C59D0>]}
[0m16:03:50.170639 [info ] [MainThread]: 
[0m16:03:50.170639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:50.170639 [info ] [MainThread]: 
[0m16:03:50.170639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:50.170639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:03:50.367513 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:03:50.367513 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:03:50.367513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:50.424920 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m16:03:50.430965 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:03:50.432891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:03:50.439231 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:03:50.439231 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:03:50.439231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:50.490364 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:03:50.490364 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:03:50.490364 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:03:50.498681 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m16:03:50.498681 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:03:50.498681 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:03:50.506970 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:50.506970 [debug] [MainThread]: On master: BEGIN
[0m16:03:50.506970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:50.542009 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m16:03:50.542009 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:50.542009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:50.542009 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m16:03:50.553798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB669896D0>]}
[0m16:03:50.553798 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:50.553798 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:50.553798 [debug] [MainThread]: On master: BEGIN
[0m16:03:50.553798 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:03:50.557122 [debug] [MainThread]: On master: COMMIT
[0m16:03:50.557122 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:50.557122 [debug] [MainThread]: On master: COMMIT
[0m16:03:50.558247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:50.558247 [debug] [MainThread]: On master: Close
[0m16:03:50.559456 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:03:50.559456 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:03:50.559456 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:03:50.559456 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:03:50.570491 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:03:50.573458 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:03:50.604139 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:03:50.609345 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:03:50.609345 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:03:50.609345 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:50.648105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m16:03:50.648105 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:03:50.648105 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:03:50.652868 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:03:50.658303 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:03:50.658303 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:03:50.658303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:03:50.662333 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:03:50.662333 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:03:50.662333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:03:50.665760 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:03:50.665760 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:03:50.665760 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:03:50.715524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m16:03:50.720659 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:03:50.720659 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:03:50.720659 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:03:50.731233 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:03:50.733939 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:03:50.737764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB66972E50>]}
[0m16:03:50.739885 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m16:03:50.740932 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:03:50.740932 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:03:50.740932 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:03:50.740932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:03:50.743911 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:03:50.747011 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:03:50.748475 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:03:50.754403 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:03:50.755415 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:03:50.755415 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:03:50.757006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:50.812867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m16:03:50.812867 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:03:50.812867 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:03:50.817593 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:03:50.819834 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:03:50.819834 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:03:50.821840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:03:50.825118 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:03:50.825118 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:03:50.829720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:03:50.831013 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:03:50.831013 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:03:50.831013 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:03:50.864554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m16:03:50.878436 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:03:50.878436 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:03:50.878436 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:03:50.880445 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:03:50.886388 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:03:50.886388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB666A3C50>]}
[0m16:03:50.888395 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:03:50.890402 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:03:50.890402 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:03:50.891537 [info ] [Thread-1 (]: 3 of 3 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:03:50.891537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:03:50.892719 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:03:50.896433 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:03:50.898795 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:03:50.901296 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:03:50.904781 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:03:50.904781 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:03:50.904781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:50.943337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:03:50.943337 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:03:50.943337 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:03:50.950863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:03:50.954794 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:03:50.954794 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:03:50.954794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:03:50.958599 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:03:50.958599 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:03:50.960134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:03:50.960134 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:03:50.961649 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:03:50.961649 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:03:50.990586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m16:03:50.994608 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:03:50.994608 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:03:50.994608 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:03:50.999577 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:03:50.999577 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:03:50.999577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132c354c-3516-43f0-9766-8c8a987e5827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB66A6C810>]}
[0m16:03:50.999577 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m16:03:50.999577 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:03:51.007048 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:51.007048 [debug] [MainThread]: On master: BEGIN
[0m16:03:51.008162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:51.043554 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m16:03:51.043554 [debug] [MainThread]: On master: COMMIT
[0m16:03:51.043554 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:51.043554 [debug] [MainThread]: On master: COMMIT
[0m16:03:51.043554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:51.043554 [debug] [MainThread]: On master: Close
[0m16:03:51.043554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:51.043554 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:03:51.043554 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:03:51.043554 [debug] [MainThread]: Connection 'model.sid_lite.stg_mobilite' was properly closed.
[0m16:03:51.052639 [info ] [MainThread]: 
[0m16:03:51.053148 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m16:03:51.053148 [debug] [MainThread]: Command end result
[0m16:03:51.082417 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:03:51.086515 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:03:51.095324 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:03:51.095324 [info ] [MainThread]: 
[0m16:03:51.095324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:51.095324 [info ] [MainThread]: 
[0m16:03:51.095324 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:03:51.099052 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:51.099052 after 3.50 seconds
[0m16:03:51.100209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB65C27150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5DEEFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5DEEF090>]}
[0m16:03:51.100209 [debug] [MainThread]: Flushing usage events
[0m16:03:51.543081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:35.146678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373D7C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373DC2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373DC30D0>]}


============================== 16:10:35.146678 | bfa9ed4a-1221-44c9-aa81-3e0e7ba89e8f ==============================
[0m16:10:35.146678 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:10:35.146678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m16:10:35.296651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa9ed4a-1221-44c9-aa81-3e0e7ba89e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373EECD90>]}
[0m16:10:35.400935 [debug] [MainThread]: Command `dbt clean` succeeded at 16:10:35.400935 after 0.36 seconds
[0m16:10:35.400935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373DFA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373F67090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C373D84990>]}
[0m16:10:35.400935 [debug] [MainThread]: Flushing usage events
[0m16:10:35.830555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:43.065421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A62AC110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A62AEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A62AC0D0>]}


============================== 16:10:43.072082 | d7a6daf1-1f73-418b-933f-2506925ccd5a ==============================
[0m16:10:43.072082 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:10:43.072082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:43.188713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7a6daf1-1f73-418b-933f-2506925ccd5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A62A7B90>]}
[0m16:10:43.223003 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-q820mz1l'
[0m16:10:43.223003 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:10:43.346344 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:10:43.347599 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m16:10:43.522536 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m16:10:43.533856 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:10:43.606338 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:10:43.615179 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m16:10:44.178961 [info ] [MainThread]: Installed from version 0.11.2
[0m16:10:44.183160 [info ] [MainThread]: Up to date!
[0m16:10:44.185361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd7a6daf1-1f73-418b-933f-2506925ccd5a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A7518850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A7518610>]}
[0m16:10:44.186921 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:10:44.837710 [info ] [MainThread]: Installed from version 1.3.0
[0m16:10:44.846251 [info ] [MainThread]: Up to date!
[0m16:10:44.848563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd7a6daf1-1f73-418b-933f-2506925ccd5a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A7518E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A7518B50>]}
[0m16:10:44.853508 [debug] [MainThread]: Command `dbt deps` succeeded at 16:10:44.853508 after 1.90 seconds
[0m16:10:44.853508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269F5CF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269F5CFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269F5CF0D0>]}
[0m16:10:44.853508 [debug] [MainThread]: Flushing usage events
[0m16:10:45.255092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:54.662025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695D7F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695DB8A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D696DC75D0>]}


============================== 16:10:54.668915 | 0a49f044-a078-428e-b96e-0db44d24a582 ==============================
[0m16:10:54.668915 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:10:54.668915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:10:54.829099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D696F80E50>]}
[0m16:10:54.892424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D69267F4D0>]}
[0m16:10:54.892424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:10:55.076400 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:10:55.082508 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:10:55.082508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D697007D90>]}
[0m16:10:57.022531 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hub_etudiant' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m16:10:57.022531 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hub_etablissement' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m16:10:57.028582 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'link_mobilite' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m16:10:57.036765 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etudiant' in package '' which was not found
[0m16:10:57.036765 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etudiant' in package '' which was not found
[0m16:10:57.036765 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etablissement' in package '' which was not found
[0m16:10:57.036765 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'hub_etablissement' in package '' which was not found
[0m16:10:57.045712 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'link_mobilite' in package '' which was not found
[0m16:10:57.045712 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'link_mobilite' in package '' which was not found
[0m16:10:57.209696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D697739910>]}
[0m16:10:57.288826 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:10:57.298125 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:10:57.322923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6973CFB50>]}
[0m16:10:57.322923 [info ] [MainThread]: Found 3 models, 3 seeds, 6 data tests, 821 macros
[0m16:10:57.322923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D692EF11D0>]}
[0m16:10:57.326244 [info ] [MainThread]: 
[0m16:10:57.326244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:57.326244 [info ] [MainThread]: 
[0m16:10:57.326244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:57.329399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:10:57.545432 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:10:57.545432 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:10:57.545432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:57.596885 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m16:10:57.598894 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:10:57.603241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:10:57.608910 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:10:57.608910 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:10:57.608910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:57.649772 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:10:57.649772 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:10:57.649772 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:57.657810 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m16:10:57.657810 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:10:57.657810 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:10:57.666316 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:57.666316 [debug] [MainThread]: On master: BEGIN
[0m16:10:57.666316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:57.698897 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m16:10:57.707011 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:57.707011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:57.715271 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m16:10:57.715271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D692699050>]}
[0m16:10:57.715271 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:57.715271 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:57.715271 [debug] [MainThread]: On master: BEGIN
[0m16:10:57.715271 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:10:57.715271 [debug] [MainThread]: On master: COMMIT
[0m16:10:57.715271 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:57.715271 [debug] [MainThread]: On master: COMMIT
[0m16:10:57.723304 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:57.723304 [debug] [MainThread]: On master: Close
[0m16:10:57.728566 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:10:57.728566 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:10:57.728566 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:10:57.728566 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:10:57.728566 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:10:57.764015 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:10:57.788631 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:10:57.788631 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:10:57.797061 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:10:57.797446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:57.828831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m16:10:57.828831 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:10:57.828831 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:10:57.845558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:10:57.851840 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:10:57.853412 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:10:57.853412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:57.858140 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:10:57.858140 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:10:57.859713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:57.866015 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:10:57.866015 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:10:57.866015 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:10:57.875701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:10:57.886129 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:10:57.891764 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:10:57.891764 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:10:57.891764 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:10:57.891764 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:10:57.891764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6977A4C90>]}
[0m16:10:57.891764 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:10:57.891764 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:10:57.907417 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:10:57.907417 [info ] [Thread-1 (]: 2 of 3 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:10:57.907417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:10:57.907417 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:10:57.907417 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:10:57.907417 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:10:57.907417 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:10:57.907417 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:10:57.907417 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:10:57.907417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:57.954819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m16:10:57.954819 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:10:57.954819 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:10:57.964050 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:10:57.964050 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:10:57.964050 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:10:57.964050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:57.970657 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:10:57.970657 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:10:57.970657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:57.970657 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:10:57.970657 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:10:57.970657 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:10:58.011662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m16:10:58.019314 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:10:58.019314 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:10:58.019314 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:10:58.019314 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:10:58.029267 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:10:58.029267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D697B42CD0>]}
[0m16:10:58.029267 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m16:10:58.031782 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:10:58.032966 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:10:58.032966 [info ] [Thread-1 (]: 3 of 3 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:10:58.034973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:10:58.034973 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:10:58.038321 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:10:58.038321 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:10:58.042332 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:10:58.042332 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:10:58.044337 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:10:58.044337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:58.084090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m16:10:58.085140 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:10:58.085140 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:10:58.086657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:10:58.092502 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:10:58.095480 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:10:58.095480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:58.099390 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:10:58.099390 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:10:58.099390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:58.101498 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:10:58.102558 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:10:58.102558 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:10:58.144881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m16:10:58.148454 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:10:58.148454 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:10:58.148454 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:10:58.148454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:10:58.156328 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:10:58.156328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a49f044-a078-428e-b96e-0db44d24a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D697C24150>]}
[0m16:10:58.160548 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m16:10:58.160548 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:10:58.162554 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:58.162554 [debug] [MainThread]: On master: BEGIN
[0m16:10:58.162554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:58.199955 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m16:10:58.199955 [debug] [MainThread]: On master: COMMIT
[0m16:10:58.199955 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:58.199955 [debug] [MainThread]: On master: COMMIT
[0m16:10:58.199955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:58.199955 [debug] [MainThread]: On master: Close
[0m16:10:58.199955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:58.199955 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:10:58.199955 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:10:58.199955 [debug] [MainThread]: Connection 'model.sid_lite.stg_mobilite' was properly closed.
[0m16:10:58.206859 [info ] [MainThread]: 
[0m16:10:58.206859 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:10:58.208309 [debug] [MainThread]: Command end result
[0m16:10:58.253312 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:10:58.258313 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:10:58.263900 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:10:58.266515 [info ] [MainThread]: 
[0m16:10:58.270535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:58.270535 [info ] [MainThread]: 
[0m16:10:58.270535 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:10:58.273040 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:58.273040 after 3.70 seconds
[0m16:10:58.274455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695D7E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D696DC7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D68F07FCD0>]}
[0m16:10:58.274455 [debug] [MainThread]: Flushing usage events
[0m16:10:58.731567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:06.233461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D66E8EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D66F03550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D66F03690>]}


============================== 16:11:06.233461 | deb7a342-a44d-4051-83da-d4581026dcbb ==============================
[0m16:11:06.233461 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:11:06.233461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:11:06.401204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deb7a342-a44d-4051-83da-d4581026dcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D670F0050>]}
[0m16:11:06.464406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deb7a342-a44d-4051-83da-d4581026dcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6277F850>]}
[0m16:11:06.464406 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:06.648148 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:11:06.862039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:06.862039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:06.901594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deb7a342-a44d-4051-83da-d4581026dcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6741B290>]}
[0m16:11:06.965367 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:11:06.965367 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:11:07.076916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deb7a342-a44d-4051-83da-d4581026dcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6714AF90>]}
[0m16:11:07.076916 [info ] [MainThread]: Found 3 models, 3 seeds, 6 data tests, 821 macros
[0m16:11:07.076916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb7a342-a44d-4051-83da-d4581026dcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D67364190>]}
[0m16:11:07.076916 [info ] [MainThread]: 
[0m16:11:07.076916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:07.076916 [info ] [MainThread]: 
[0m16:11:07.076916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:07.076916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:11:07.230162 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:11:07.230162 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:11:07.230162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:07.275660 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:11:07.279339 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:11:07.279339 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:11:07.284910 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m16:11:07.284910 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:11:07.284910 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:11:07.296761 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:07.296761 [debug] [MainThread]: On master: BEGIN
[0m16:11:07.296761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:07.333454 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m16:11:07.333454 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:07.336396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:07.341818 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m16:11:07.345169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb7a342-a44d-4051-83da-d4581026dcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D64EF8A90>]}
[0m16:11:07.345169 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:07.346192 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:07.346192 [debug] [MainThread]: On master: BEGIN
[0m16:11:07.347215 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:11:07.347215 [debug] [MainThread]: On master: COMMIT
[0m16:11:07.347215 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:07.347215 [debug] [MainThread]: On master: COMMIT
[0m16:11:07.347215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:07.347215 [debug] [MainThread]: On master: Close
[0m16:11:07.354442 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:11:07.355446 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_etablissement_oid_etablissement ................. [RUN]
[0m16:11:07.355446 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69'
[0m16:11:07.356979 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:11:07.367721 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:11:07.369258 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:11:07.383791 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:11:07.386075 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:11:07.386075 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m16:11:07.386075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:07.425400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:11:07.427704 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:11:07.428551 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m16:11:07.430082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:07.432871 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m16:11:07.432871 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m16:11:07.432871 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.08s]
[0m16:11:07.437945 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:11:07.437945 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:11:07.439951 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_etudiant_id_etudiant ............................ [RUN]
[0m16:11:07.439951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m16:11:07.439951 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:11:07.448083 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:11:07.449146 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:11:07.451857 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:11:07.453900 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:11:07.453900 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m16:11:07.453900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.495350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:11:07.496369 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:11:07.497280 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m16:11:07.499107 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:07.501837 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m16:11:07.501837 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m16:11:07.503379 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.06s]
[0m16:11:07.503379 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:11:07.503379 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:11:07.503379 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_mobilite_id_mobilite ............................ [RUN]
[0m16:11:07.507133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m16:11:07.507133 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:11:07.514203 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:11:07.515307 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:11:07.518729 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:11:07.519779 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:11:07.520932 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m16:11:07.520932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.557031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m16:11:07.557031 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:11:07.557031 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m16:11:07.560604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:07.562938 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m16:11:07.562938 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m16:11:07.564104 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.06s]
[0m16:11:07.565477 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:11:07.565477 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:11:07.565477 [info ] [Thread-1 (]: 4 of 6 START test unique_stg_etablissement_oid_etablissement ................... [RUN]
[0m16:11:07.565477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m16:11:07.565477 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:11:07.570259 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:11:07.599104 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:11:07.599104 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:11:07.613020 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:11:07.615428 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m16:11:07.615428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.657756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:11:07.657756 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:11:07.657756 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:11:07.665188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:07.667194 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m16:11:07.667194 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m16:11:07.667194 [info ] [Thread-1 (]: 4 of 6 PASS unique_stg_etablissement_oid_etablissement ......................... [[32mPASS[0m in 0.10s]
[0m16:11:07.669543 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:11:07.670658 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:11:07.670658 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_etudiant_id_etudiant .............................. [RUN]
[0m16:11:07.670658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m16:11:07.670658 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:11:07.670658 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:11:07.670658 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:11:07.678974 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:11:07.704497 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:11:07.706643 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m16:11:07.706643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.747645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m16:11:07.747645 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:11:07.747645 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:11:07.752526 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:07.752526 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m16:11:07.752526 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m16:11:07.752526 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_etudiant_id_etudiant .................................... [[32mPASS[0m in 0.08s]
[0m16:11:07.752526 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:11:07.757277 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:11:07.757277 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_mobilite_id_mobilite .............................. [RUN]
[0m16:11:07.757277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m16:11:07.757277 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:11:07.764275 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:11:07.764275 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:11:07.768969 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:11:07.795021 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:11:07.796035 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m16:11:07.796035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.842292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m16:11:07.844303 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:11:07.844303 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:11:07.845523 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:07.845523 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m16:11:07.845523 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m16:11:07.850162 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_mobilite_id_mobilite .................................... [[32mPASS[0m in 0.09s]
[0m16:11:07.851504 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:11:07.852508 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:07.852508 [debug] [MainThread]: On master: BEGIN
[0m16:11:07.852508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:07.886165 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m16:11:07.886165 [debug] [MainThread]: On master: COMMIT
[0m16:11:07.893258 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:07.893258 [debug] [MainThread]: On master: COMMIT
[0m16:11:07.893258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:07.895141 [debug] [MainThread]: On master: Close
[0m16:11:07.895939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:07.895939 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:11:07.897585 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m16:11:07.897585 [info ] [MainThread]: 
[0m16:11:07.897585 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m16:11:07.898936 [debug] [MainThread]: Command end result
[0m16:11:07.932316 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:11:07.934321 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:11:07.942885 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:11:07.942885 [info ] [MainThread]: 
[0m16:11:07.945308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:07.946372 [info ] [MainThread]: 
[0m16:11:07.946372 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:11:07.946372 [debug] [MainThread]: Command `dbt test` succeeded at 16:11:07.946372 after 1.81 seconds
[0m16:11:07.946372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5F14FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D5F14F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D65058F10>]}
[0m16:11:07.946372 [debug] [MainThread]: Flushing usage events
[0m16:11:08.405904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:16.156724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543A74E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543B797310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543B797350>]}


============================== 16:30:16.163343 | 4d21603c-8ce5-438b-a7cf-5b3b8cf135f2 ==============================
[0m16:30:16.163343 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:30:16.163343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:16.372269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d21603c-8ce5-438b-a7cf-5b3b8cf135f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025439832250>]}
[0m16:30:16.451840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d21603c-8ce5-438b-a7cf-5b3b8cf135f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025436FFF510>]}
[0m16:30:16.460660 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:16.635918 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:30:16.831956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:30:16.833960 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:30:16.833960 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:30:16.833960 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:30:17.095525 [error] [MainThread]: Encountered an error:
Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  invalid syntax for function call expression
    line 3
      {{ automate_dv.link(
[0m16:30:17.095525 [debug] [MainThread]: Command `dbt run` failed at 16:30:17.095525 after 1.06 seconds
[0m16:30:17.100021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543BC1DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543BC1DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543BC1F790>]}
[0m16:30:17.101031 [debug] [MainThread]: Flushing usage events
[0m16:30:17.545364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:13.526504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD04DEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD1526E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD04D7110>]}


============================== 16:34:13.536639 | bb48b566-fa9e-4adb-993e-7be913cb4883 ==============================
[0m16:34:13.536639 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:34:13.536639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:34:13.849497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb48b566-fa9e-4adb-993e-7be913cb4883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD16ECB10>]}
[0m16:34:13.944537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb48b566-fa9e-4adb-993e-7be913cb4883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BCCD8F010>]}
[0m16:34:13.960258 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:34:14.259579 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:34:14.592350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:34:14.592350 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:34:14.592350 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:34:14.592350 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:34:14.986921 [error] [MainThread]: Encountered an error:
Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  invalid syntax for function call expression
    line 3
      {{ automate_dv.link(
[0m16:34:14.986921 [debug] [MainThread]: Command `dbt run` failed at 16:34:14.986921 after 1.64 seconds
[0m16:34:14.986921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD1BC1ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD1BC0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028BD1BC1FD0>]}
[0m16:34:14.986921 [debug] [MainThread]: Flushing usage events
[0m16:34:15.474884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:54.179713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EB13E610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EC187B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EB137990>]}


============================== 16:35:54.190460 | 48699d9c-ad97-4fc4-b95a-190b64f9b988 ==============================
[0m16:35:54.190460 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:35:54.190460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:54.488796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48699d9c-ad97-4fc4-b95a-190b64f9b988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EC2EDD50>]}
[0m16:35:54.598886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48699d9c-ad97-4fc4-b95a-190b64f9b988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203E79FE050>]}
[0m16:35:54.598886 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:35:54.898704 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:35:55.228354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:35:55.228354 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:35:55.230932 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:35:55.230932 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:35:55.634605 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  The object (""sid_lite"."public"."hub_etablissement"") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro is_list (macros\internal\helpers\is_checks.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
[0m16:35:55.650502 [debug] [MainThread]: Command `dbt run` failed at 16:35:55.634605 after 1.63 seconds
[0m16:35:55.650502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EC602590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EC441BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EC85D8D0>]}
[0m16:35:55.650502 [debug] [MainThread]: Flushing usage events
[0m16:35:56.123212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:48.276961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D98F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270E9D7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270E9D77D0>]}


============================== 16:47:48.280961 | c1cbdd8f-6140-4eb0-8e40-9b2e8abb4854 ==============================
[0m16:47:48.280961 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:47:48.281963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:48.412256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1cbdd8f-6140-4eb0-8e40-9b2e8abb4854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270C177150>]}
[0m16:47:48.454956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1cbdd8f-6140-4eb0-8e40-9b2e8abb4854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270A23DF10>]}
[0m16:47:48.454956 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:47:48.569817 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:47:48.711661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:47:48.712661 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:47:48.712661 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:47:48.713665 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:47:48.924864 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro postgres__hub (macros\tables\postgres\hub.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
[0m16:47:48.929944 [debug] [MainThread]: Command `dbt run` failed at 16:47:48.929944 after 0.73 seconds
[0m16:47:48.929944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270EC77390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270EC76150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270EE7E890>]}
[0m16:47:48.932055 [debug] [MainThread]: Flushing usage events
[0m16:47:49.388869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:39.662225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689DCC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A688F58CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689E13890>]}


============================== 16:48:39.677278 | 270f19b6-4949-4a1e-84bf-03b68d030339 ==============================
[0m16:48:39.677278 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:48:39.678285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:39.802774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '270f19b6-4949-4a1e-84bf-03b68d030339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68AF0E210>]}
[0m16:48:39.846608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '270f19b6-4949-4a1e-84bf-03b68d030339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68667A2D0>]}
[0m16:48:39.846608 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:48:39.971707 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:48:40.113999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:48:40.115000 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:48:40.115000 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:48:40.115000 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:48:40.310288 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
  The object (""sid_lite"."public"."hub_etudiant"") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro is_list (macros\internal\helpers\is_checks.sql)
  > called by macro hub (macros\tables\snowflake\hub.sql)
  > called by model hub_etudiant (dbt/sid-lite/models\vault\hub_etudiant.sql)
[0m16:48:40.310288 [debug] [MainThread]: Command `dbt run` failed at 16:48:40.310288 after 0.71 seconds
[0m16:48:40.310288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689A9D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68B294950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68B2B3D50>]}
[0m16:48:40.310288 [debug] [MainThread]: Flushing usage events
[0m16:48:40.762989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:05.855883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DAC6E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DAA1FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DACAE690>]}


============================== 16:50:05.858883 | 5710c17c-43a9-433d-bc9b-99ac1b6bd8fa ==============================
[0m16:50:05.858883 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:50:05.860883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:05.985693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5710c17c-43a9-433d-bc9b-99ac1b6bd8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DBE35450>]}
[0m16:50:06.024397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5710c17c-43a9-433d-bc9b-99ac1b6bd8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D752F590>]}
[0m16:50:06.024397 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:50:06.136992 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:50:06.280209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:50:06.280209 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:50:06.280209 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:50:06.280209 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:50:06.531737 [error] [MainThread]: Encountered an error:
Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  invalid syntax for function call expression
    line 3
      {{ automate_dv.link(
[0m16:50:06.531737 [debug] [MainThread]: Command `dbt run` failed at 16:50:06.531737 after 0.75 seconds
[0m16:50:06.531737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D9E08C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DC12F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DBF7C710>]}
[0m16:50:06.531737 [debug] [MainThread]: Flushing usage events
[0m16:50:06.969594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:26.966884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F41874D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3F3FB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F41D0810>]}


============================== 16:50:26.976154 | f42e6179-5038-4fc2-a6f0-dac8d575bf1b ==============================
[0m16:50:26.976154 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:50:26.976154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:27.101960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42e6179-5038-4fc2-a6f0-dac8d575bf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F532AB10>]}
[0m16:50:27.138007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f42e6179-5038-4fc2-a6f0-dac8d575bf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F0A6F550>]}
[0m16:50:27.138007 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:50:27.254104 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:50:27.380999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:50:27.380999 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:50:27.380999 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:50:27.380999 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:50:27.619417 [error] [MainThread]: Encountered an error:
Compilation Error in model link_mobilite (dbt/sid-lite/models\vault\link_mobilite.sql)
  invalid syntax for function call expression
    line 3
      {{ automate_dv.link(
[0m16:50:27.619417 [debug] [MainThread]: Command `dbt run` failed at 16:50:27.619417 after 0.73 seconds
[0m16:50:27.635431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F568A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F5417090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F564CF10>]}
[0m16:50:27.635431 [debug] [MainThread]: Flushing usage events
[0m16:50:28.055008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:13.518532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EF4CE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EF4CEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EF4CEDD0>]}


============================== 16:51:13.534380 | 7c1a763a-4e36-4ed8-b0b3-246a7904c910 ==============================
[0m16:51:13.534380 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:51:13.534380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:51:13.656008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EDCF06D0>]}
[0m16:51:13.688150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EBD8E210>]}
[0m16:51:13.688150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:51:13.823288 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:51:13.936833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:51:13.936833 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m16:51:14.218253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F07DB650>]}
[0m16:51:14.272328 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:51:14.275223 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:51:14.289101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F0B64310>]}
[0m16:51:14.289101 [info ] [MainThread]: Found 4 models, 3 seeds, 6 data tests, 821 macros
[0m16:51:14.289101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EEC6B350>]}
[0m16:51:14.289101 [info ] [MainThread]: 
[0m16:51:14.289101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:14.289101 [info ] [MainThread]: 
[0m16:51:14.289101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:14.298005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:51:14.392604 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:51:14.393608 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:51:14.393608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:14.423092 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m16:51:14.423092 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:51:14.423092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:51:14.438983 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:51:14.438983 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:51:14.438983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:14.455094 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:51:14.455094 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:51:14.455094 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:51:14.471147 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m16:51:14.473158 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:51:14.473158 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:51:14.475165 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:14.475165 [debug] [MainThread]: On master: BEGIN
[0m16:51:14.475165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:14.507984 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m16:51:14.508989 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:14.509987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:14.513987 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m16:51:14.515989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EF4CDF50>]}
[0m16:51:14.515989 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:14.516988 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:14.516988 [debug] [MainThread]: On master: BEGIN
[0m16:51:14.517989 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:51:14.517989 [debug] [MainThread]: On master: COMMIT
[0m16:51:14.517989 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:14.519011 [debug] [MainThread]: On master: COMMIT
[0m16:51:14.519011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:51:14.519011 [debug] [MainThread]: On master: Close
[0m16:51:14.522434 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:51:14.522434 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:51:14.522434 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:51:14.522434 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:51:14.522434 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:51:14.522434 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:51:14.545043 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:51:14.545043 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:51:14.545043 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:51:14.545043 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:14.582362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:51:14.582362 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:51:14.583364 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:51:14.585564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:51:14.590592 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:51:14.590592 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:51:14.591593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:51:14.594590 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:51:14.594590 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:51:14.595591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:51:14.603590 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:51:14.604592 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:51:14.604592 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:51:14.606589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:51:14.606589 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:51:14.606589 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:51:14.606589 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:51:14.606589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:51:14.606589 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:51:14.606589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F11BC090>]}
[0m16:51:14.606589 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:51:14.606589 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:51:14.606589 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:51:14.622592 [info ] [Thread-1 (]: 2 of 4 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:51:14.622592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:51:14.622592 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:51:14.622592 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:51:14.622592 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:51:14.622592 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:51:14.622592 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:51:14.622592 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:51:14.622592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:14.660216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:51:14.660216 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:51:14.660216 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:51:14.663234 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:51:14.663234 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:51:14.663234 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:51:14.663234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:51:14.663234 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:51:14.672544 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:51:14.672544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:51:14.673553 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:51:14.674553 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:51:14.674553 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:51:14.675550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:51:14.677067 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:51:14.677067 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:51:14.677067 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:51:14.677067 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:51:14.677067 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:51:14.677067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F12CDF90>]}
[0m16:51:14.677067 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m16:51:14.677067 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:51:14.677067 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:51:14.677067 [info ] [Thread-1 (]: 3 of 4 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:51:14.677067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:51:14.677067 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:51:14.677067 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:51:14.677067 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:51:14.690830 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:51:14.691836 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:51:14.691836 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:51:14.691836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:14.822949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m16:51:14.822949 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:51:14.822949 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:51:14.822949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:51:14.838632 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:51:14.838632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:51:14.838632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:51:14.838632 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:51:14.838632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:51:14.838632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:51:14.838632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:51:14.838632 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:51:14.838632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:51:14.838632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:51:14.838632 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:51:14.838632 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:51:14.838632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:51:14.838632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:51:14.838632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:51:14.838632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F115C250>]}
[0m16:51:14.838632 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:51:14.838632 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:51:14.838632 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m16:51:14.854298 [info ] [Thread-1 (]: 4 of 4 START sql table model public.hub_etablissement .......................... [RUN]
[0m16:51:14.854298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m16:51:14.854298 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m16:51:14.854298 [info ] [Thread-1 (]: 16:51:14 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m16:51:14.867600 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m16:51:14.868407 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m16:51:14.878849 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m16:51:14.878849 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:51:14.878849 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m16:51:14.878849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:14.907418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:51:14.907418 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:51:14.907418 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:51:14.907418 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:51:14.924522 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:51:14.924522 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m16:51:14.925516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:51:14.926514 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:51:14.926514 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:51:14.927506 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:51:14.929165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:51:14.931169 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m16:51:14.932172 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:51:14.933171 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m16:51:14.933171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:51:14.934171 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m16:51:14.935173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1a763a-4e36-4ed8-b0b3-246a7904c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4F1377A50>]}
[0m16:51:14.936173 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.08s]
[0m16:51:14.936173 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m16:51:14.938168 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:14.939167 [debug] [MainThread]: On master: BEGIN
[0m16:51:14.939167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:14.961917 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m16:51:14.961917 [debug] [MainThread]: On master: COMMIT
[0m16:51:14.961917 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:14.961917 [debug] [MainThread]: On master: COMMIT
[0m16:51:14.961917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:51:14.961917 [debug] [MainThread]: On master: Close
[0m16:51:14.961917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:14.961917 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:51:14.961917 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:51:14.961917 [debug] [MainThread]: Connection 'model.sid_lite.hub_etablissement' was properly closed.
[0m16:51:14.961917 [info ] [MainThread]: 
[0m16:51:14.961917 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:51:14.972367 [debug] [MainThread]: Command end result
[0m16:51:14.995389 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:51:14.995389 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:51:15.002027 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:51:15.002027 [info ] [MainThread]: 
[0m16:51:15.002027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:15.002027 [info ] [MainThread]: 
[0m16:51:15.005794 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:51:15.006571 [debug] [MainThread]: Command `dbt run` succeeded at 16:51:15.006571 after 1.54 seconds
[0m16:51:15.006571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4EE49FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E874FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E874F090>]}
[0m16:51:15.006571 [debug] [MainThread]: Flushing usage events
[0m16:51:15.404077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:59.787906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DF0CEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DF0CE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DF0CE6D0>]}


============================== 16:51:59.793991 | 45adbec2-fd1b-435a-a000-998d6c4df2c3 ==============================
[0m16:51:59.793991 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:51:59.793991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:51:59.920692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0263ED0>]}
[0m16:51:59.952578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DB97F5D0>]}
[0m16:51:59.952578 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:52:00.071661 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:52:00.217990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:52:00.217990 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\hub_etudiant.sql
[0m16:52:00.496956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E01215D0>]}
[0m16:52:00.551605 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:52:00.551605 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:52:00.560244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0751BD0>]}
[0m16:52:00.560244 [info ] [MainThread]: Found 5 models, 3 seeds, 6 data tests, 821 macros
[0m16:52:00.560244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0A7C950>]}
[0m16:52:00.560244 [info ] [MainThread]: 
[0m16:52:00.560244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:00.560244 [info ] [MainThread]: 
[0m16:52:00.560244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:00.576039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:52:00.675183 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:52:00.676182 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:52:00.676182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:00.707090 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m16:52:00.707090 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:52:00.716186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:52:00.721996 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:52:00.721996 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:52:00.721996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:00.751864 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m16:52:00.751864 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:52:00.751864 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:52:00.755077 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m16:52:00.755077 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:52:00.755077 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:52:00.755077 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:00.755077 [debug] [MainThread]: On master: BEGIN
[0m16:52:00.755077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:00.790158 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m16:52:00.790158 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:00.790158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:00.790158 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m16:52:00.790158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0DB5E90>]}
[0m16:52:00.790158 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:00.790158 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:00.802643 [debug] [MainThread]: On master: BEGIN
[0m16:52:00.803435 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:52:00.803435 [debug] [MainThread]: On master: COMMIT
[0m16:52:00.803435 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:00.803435 [debug] [MainThread]: On master: COMMIT
[0m16:52:00.803435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:00.803435 [debug] [MainThread]: On master: Close
[0m16:52:00.803435 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:52:00.803435 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:52:00.803435 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:52:00.803435 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:52:00.803435 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:52:00.803435 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:52:00.826850 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:52:00.826850 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:52:00.826850 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:52:00.826850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:52:00.867406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:52:00.867406 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:52:00.868405 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:52:00.870673 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:52:00.873672 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:52:00.873672 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:52:00.873672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:00.873672 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:52:00.873672 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:52:00.873672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:00.889487 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:52:00.889487 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:52:00.889487 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:52:00.889487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:52:00.889487 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:52:00.889487 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:52:00.889487 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:52:00.889487 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:52:00.902506 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:52:00.905546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0D9BE50>]}
[0m16:52:00.905546 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:52:00.905546 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:52:00.905546 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:52:00.905546 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:52:00.905546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:52:00.905546 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:52:00.905546 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:52:00.905546 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:52:00.905546 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:52:00.905546 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:52:00.905546 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:52:00.905546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:00.942785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:52:00.942785 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:52:00.942785 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:52:00.942785 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:52:00.942785 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:52:00.942785 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:52:00.952177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:52:00.952177 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:52:00.952177 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:52:00.956242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:00.956242 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:52:00.956242 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:52:00.956242 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:52:00.956242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:52:00.956242 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:52:00.956242 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:52:00.956242 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:52:00.956242 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:52:00.956242 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:52:00.956242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0EDD810>]}
[0m16:52:00.956242 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m16:52:00.956242 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:52:00.956242 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:52:00.956242 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:52:00.956242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:52:00.956242 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:52:00.956242 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:52:00.956242 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:52:00.973805 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:52:00.973805 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:52:00.974924 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:52:00.974924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:00.990280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:52:00.990280 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:52:00.990280 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:52:01.009531 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:52:01.011532 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:52:01.011532 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:52:01.011532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:52:01.011532 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:52:01.011532 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:52:01.011532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:52:01.011532 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:52:01.011532 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:52:01.011532 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:52:01.011532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:52:01.011532 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:52:01.011532 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:52:01.011532 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:52:01.023472 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:52:01.023472 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:52:01.023472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0D1FED0>]}
[0m16:52:01.023472 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:52:01.023472 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:52:01.023472 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m16:52:01.023472 [info ] [Thread-1 (]: 4 of 5 START sql table model public.hub_etablissement .......................... [RUN]
[0m16:52:01.023472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m16:52:01.023472 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m16:52:01.023472 [info ] [Thread-1 (]: 16:52:01 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m16:52:01.041726 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m16:52:01.041726 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m16:52:01.052456 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m16:52:01.052456 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:52:01.056341 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m16:52:01.056900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:01.073541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m16:52:01.073541 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:52:01.073541 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:52:01.088665 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m16:52:01.090111 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:52:01.090111 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m16:52:01.090111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:01.090111 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:52:01.090111 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m16:52:01.090111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:01.090111 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:52:01.090111 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:52:01.090111 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:52:01.090111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:52:01.090111 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m16:52:01.106335 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:52:01.106861 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m16:52:01.108361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:52:01.108361 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m16:52:01.108361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0C9D510>]}
[0m16:52:01.108361 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.08s]
[0m16:52:01.108361 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m16:52:01.108361 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m16:52:01.108361 [info ] [Thread-1 (]: 5 of 5 START sql table model public.hub_etudiant ............................... [RUN]
[0m16:52:01.108361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m16:52:01.108361 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m16:52:01.108361 [info ] [Thread-1 (]: 16:52:01 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m16:52:01.120344 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m16:52:01.120344 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m16:52:01.124065 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m16:52:01.124065 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:52:01.124065 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m16:52:01.124065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:01.152594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:52:01.156290 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:52:01.156290 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:52:01.157297 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:52:01.157297 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:52:01.157297 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m16:52:01.157297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:01.157297 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:52:01.157297 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:52:01.157297 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:52:01.157297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:52:01.157297 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m16:52:01.157297 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:52:01.157297 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m16:52:01.157297 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:52:01.157297 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m16:52:01.173253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45adbec2-fd1b-435a-a000-998d6c4df2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E0F592D0>]}
[0m16:52:01.173253 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m16:52:01.174255 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m16:52:01.175253 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:01.176256 [debug] [MainThread]: On master: BEGIN
[0m16:52:01.176256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:01.194307 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m16:52:01.206297 [debug] [MainThread]: On master: COMMIT
[0m16:52:01.206765 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:01.206765 [debug] [MainThread]: On master: COMMIT
[0m16:52:01.206765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:01.206765 [debug] [MainThread]: On master: Close
[0m16:52:01.206765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:01.206765 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:52:01.206765 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:52:01.206765 [debug] [MainThread]: Connection 'model.sid_lite.hub_etudiant' was properly closed.
[0m16:52:01.206765 [info ] [MainThread]: 
[0m16:52:01.206765 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m16:52:01.206765 [debug] [MainThread]: Command end result
[0m16:52:01.234558 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:52:01.236563 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:52:01.243251 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:52:01.243251 [info ] [MainThread]: 
[0m16:52:01.244247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:01.244247 [info ] [MainThread]: 
[0m16:52:01.244247 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:52:01.245249 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:01.245249 after 1.52 seconds
[0m16:52:01.245249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8D836FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8D836F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8E06F5BD0>]}
[0m16:52:01.246247 [debug] [MainThread]: Flushing usage events
[0m16:52:01.671956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:09.165170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2257BE3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226807250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226807910>]}


============================== 16:56:09.165170 | d6d44ef2-ea51-4fee-9ad3-a83989b3a90f ==============================
[0m16:56:09.165170 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:56:09.165170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:56:09.289108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226959D10>]}
[0m16:56:09.336284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2220CE250>]}
[0m16:56:09.336284 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:56:09.457078 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:56:09.583376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:09.583376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:09.614881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226E8A410>]}
[0m16:56:09.678346 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:56:09.678346 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:56:09.759094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C224FC8810>]}
[0m16:56:09.759094 [info ] [MainThread]: Found 5 models, 3 seeds, 6 data tests, 821 macros
[0m16:56:09.759094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226EEACD0>]}
[0m16:56:09.759094 [info ] [MainThread]: 
[0m16:56:09.759094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:09.759094 [info ] [MainThread]: 
[0m16:56:09.759094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:56:09.759094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:56:09.864840 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:56:09.864840 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:56:09.864840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:09.898952 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m16:56:09.898952 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:56:09.904357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:56:09.908468 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:56:09.908468 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:56:09.908468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:09.937093 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m16:56:09.937093 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:56:09.937093 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:56:09.940204 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m16:56:09.940204 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:56:09.940204 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:56:09.940204 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:09.940204 [debug] [MainThread]: On master: BEGIN
[0m16:56:09.940204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:09.974833 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m16:56:09.974833 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:09.974833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:56:09.974833 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m16:56:09.974833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226E59810>]}
[0m16:56:09.985774 [debug] [MainThread]: On master: ROLLBACK
[0m16:56:09.985774 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:09.985774 [debug] [MainThread]: On master: BEGIN
[0m16:56:09.987513 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:56:09.987513 [debug] [MainThread]: On master: COMMIT
[0m16:56:09.987513 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:09.987513 [debug] [MainThread]: On master: COMMIT
[0m16:56:09.987513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:56:09.987513 [debug] [MainThread]: On master: Close
[0m16:56:09.987513 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:56:09.987513 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:56:09.987513 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:56:09.987513 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:56:09.987513 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:56:09.999465 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:56:10.009956 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:56:10.009956 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:56:10.009956 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:56:10.009956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:10.050859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:56:10.051857 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:56:10.051857 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:56:10.054197 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:56:10.059193 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:56:10.060194 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:56:10.060194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:10.060194 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:56:10.060194 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:56:10.060194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:56:10.060194 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:56:10.060194 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:56:10.060194 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:56:10.060194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:56:10.075972 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:56:10.075972 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:56:10.075972 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:56:10.075972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:56:10.075972 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:56:10.075972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22738FD90>]}
[0m16:56:10.075972 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:56:10.075972 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:56:10.075972 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:56:10.075972 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:56:10.075972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:56:10.091811 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:56:10.091811 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:56:10.091811 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:56:10.091811 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:56:10.091811 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:56:10.091811 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:56:10.091811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:10.127854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:56:10.128862 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:56:10.128862 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:56:10.130858 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:56:10.130858 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:56:10.130858 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:56:10.130858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:10.130858 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:56:10.130858 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:56:10.130858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:56:10.130858 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:56:10.130858 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:56:10.130858 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:56:10.142361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:56:10.142361 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:56:10.142361 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:56:10.142361 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:56:10.142361 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:56:10.142361 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:56:10.142361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C225648850>]}
[0m16:56:10.142361 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:56:10.142361 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:56:10.142361 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:56:10.142361 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:56:10.142361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:56:10.142361 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:56:10.152986 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:56:10.152986 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:56:10.152986 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:56:10.158324 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:56:10.158324 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:56:10.158324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:10.182085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m16:56:10.182085 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:56:10.182085 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:56:10.182085 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:56:10.193152 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:56:10.193152 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:56:10.193152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:56:10.193152 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:56:10.193152 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:56:10.193152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:56:10.193152 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:56:10.193152 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:56:10.193152 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:56:10.193152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:56:10.193152 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:56:10.193152 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:56:10.193152 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:56:10.193152 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:56:10.193152 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:56:10.208379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C22744EDD0>]}
[0m16:56:10.209107 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:56:10.209495 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:56:10.209495 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m16:56:10.209495 [info ] [Thread-1 (]: 4 of 5 START sql table model public.hub_etablissement .......................... [RUN]
[0m16:56:10.209495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m16:56:10.209495 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m16:56:10.227925 [info ] [Thread-1 (]: 16:56:10 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m16:56:10.260252 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m16:56:10.261252 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m16:56:10.266551 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m16:56:10.266551 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:56:10.266551 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m16:56:10.275848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:10.408922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m16:56:10.408922 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:56:10.408922 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:56:10.408922 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m16:56:10.424571 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:56:10.424571 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m16:56:10.424571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:10.424571 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:56:10.424571 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m16:56:10.424571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:10.424571 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:56:10.424571 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:56:10.424571 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:56:10.437307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:56:10.440250 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m16:56:10.440250 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:56:10.440250 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m16:56:10.440250 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:56:10.440250 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m16:56:10.440250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C226ED3790>]}
[0m16:56:10.440250 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.23s]
[0m16:56:10.448329 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m16:56:10.448329 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m16:56:10.448329 [info ] [Thread-1 (]: 5 of 5 START sql table model public.hub_etudiant ............................... [RUN]
[0m16:56:10.448329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m16:56:10.448329 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m16:56:10.448329 [info ] [Thread-1 (]: 16:56:10 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m16:56:10.455551 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m16:56:10.456463 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m16:56:10.459193 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m16:56:10.460160 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:56:10.460160 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m16:56:10.461197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:10.481420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:56:10.481420 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:56:10.481420 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:56:10.493507 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:56:10.493507 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:56:10.493507 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m16:56:10.493507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:56:10.493507 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:56:10.493507 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m16:56:10.493507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:10.493507 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:56:10.493507 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:56:10.493507 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:56:10.493507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:56:10.511381 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m16:56:10.512382 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:56:10.512382 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m16:56:10.515107 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:56:10.516105 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m16:56:10.517105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d44ef2-ea51-4fee-9ad3-a83989b3a90f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2274E2C10>]}
[0m16:56:10.517105 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m16:56:10.518106 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m16:56:10.520106 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:10.520106 [debug] [MainThread]: On master: BEGIN
[0m16:56:10.520106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:10.543688 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m16:56:10.543688 [debug] [MainThread]: On master: COMMIT
[0m16:56:10.543688 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:10.543688 [debug] [MainThread]: On master: COMMIT
[0m16:56:10.543688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:56:10.543688 [debug] [MainThread]: On master: Close
[0m16:56:10.543688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:10.543688 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:56:10.543688 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:56:10.543688 [debug] [MainThread]: Connection 'model.sid_lite.hub_etudiant' was properly closed.
[0m16:56:10.543688 [info ] [MainThread]: 
[0m16:56:10.543688 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m16:56:10.543688 [debug] [MainThread]: Command end result
[0m16:56:10.575789 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:56:10.579696 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:56:10.582695 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:56:10.582695 [info ] [MainThread]: 
[0m16:56:10.582695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:10.582695 [info ] [MainThread]: 
[0m16:56:10.582695 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:56:10.582695 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:10.582695 after 1.49 seconds
[0m16:56:10.582695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C225491350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C221165A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21EAAFC90>]}
[0m16:56:10.582695 [debug] [MainThread]: Flushing usage events
[0m16:56:11.041073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:27.059022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232320BF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023232100BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023232101A90>]}


============================== 16:58:27.059022 | dd777320-2848-482f-8423-1cfca97fb6f2 ==============================
[0m16:58:27.059022 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:58:27.059022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:58:27.206400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002323327E7D0>]}
[0m16:58:27.257461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002322E97B890>]}
[0m16:58:27.257461 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:58:27.376304 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:58:27.509676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:58:27.509676 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\link_mobilite.sql
[0m16:58:27.804738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232318B9CD0>]}
[0m16:58:27.868517 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:58:27.868517 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:58:27.884528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232337602D0>]}
[0m16:58:27.884528 [info ] [MainThread]: Found 6 models, 3 seeds, 6 data tests, 821 macros
[0m16:58:27.884528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233A99710>]}
[0m16:58:27.884528 [info ] [MainThread]: 
[0m16:58:27.884528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:27.884528 [info ] [MainThread]: 
[0m16:58:27.884528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:58:27.884528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:58:27.994629 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:58:27.994629 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:58:27.994629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:28.026296 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m16:58:28.026296 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:58:28.042178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:58:28.042178 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:58:28.042178 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:58:28.042178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:28.074002 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:58:28.074002 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:58:28.074002 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:58:28.074002 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m16:58:28.074002 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:58:28.074002 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:58:28.089733 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:28.089733 [debug] [MainThread]: On master: BEGIN
[0m16:58:28.089733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:28.105515 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m16:58:28.105515 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:28.121405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:58:28.122912 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m16:58:28.122912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023231889B10>]}
[0m16:58:28.122912 [debug] [MainThread]: On master: ROLLBACK
[0m16:58:28.122912 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:28.122912 [debug] [MainThread]: On master: BEGIN
[0m16:58:28.122912 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:58:28.122912 [debug] [MainThread]: On master: COMMIT
[0m16:58:28.122912 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:28.122912 [debug] [MainThread]: On master: COMMIT
[0m16:58:28.122912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:58:28.122912 [debug] [MainThread]: On master: Close
[0m16:58:28.122912 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:58:28.122912 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:58:28.122912 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:58:28.122912 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:58:28.137441 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:58:28.137441 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:58:28.161526 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:58:28.161526 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:58:28.161526 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:58:28.161526 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:58:28.197365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:58:28.197365 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:58:28.198360 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:58:28.201360 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:58:28.205360 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:58:28.206360 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:58:28.207360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:28.209363 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:58:28.209363 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:58:28.210364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:28.211368 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:58:28.211368 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:58:28.211368 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:58:28.211368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:58:28.222965 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:58:28.227030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:58:28.227030 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:58:28.227030 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:58:28.227030 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:58:28.227030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233D688D0>]}
[0m16:58:28.227030 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:58:28.227030 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:58:28.227030 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:58:28.227030 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:58:28.227030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:58:28.227030 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:58:28.242822 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:58:28.242822 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:58:28.242822 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:58:28.242822 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:58:28.242822 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:58:28.242822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.279964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:58:28.280965 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:58:28.280965 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:58:28.283964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:58:28.286964 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:58:28.286964 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:58:28.287968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:28.291964 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:58:28.291964 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:58:28.291964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:28.292964 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:58:28.293882 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:58:28.294200 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:58:28.294200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:58:28.294200 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:58:28.294200 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:58:28.294200 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:58:28.294200 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:58:28.294200 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:58:28.294200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233EDC790>]}
[0m16:58:28.294200 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:58:28.294200 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:58:28.294200 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:58:28.294200 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:58:28.294200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:58:28.294200 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:58:28.294200 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:58:28.294200 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:58:28.311572 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:58:28.312622 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:58:28.312622 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:58:28.313622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.333846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:58:28.333846 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:58:28.344062 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:58:28.344413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:58:28.344413 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:58:28.344413 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:58:28.344413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:28.344413 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:58:28.344413 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:58:28.344413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:28.344413 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:58:28.344413 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:58:28.344413 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:58:28.344413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:58:28.359786 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:58:28.359786 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:58:28.360619 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:58:28.361024 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:58:28.361024 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:58:28.361024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233F32610>]}
[0m16:58:28.361024 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:58:28.361024 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:58:28.361024 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m16:58:28.361024 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m16:58:28.361024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m16:58:28.361024 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m16:58:28.378358 [info ] [Thread-1 (]: 16:58:28 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m16:58:28.383554 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m16:58:28.383554 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m16:58:28.400373 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m16:58:28.400373 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:58:28.400373 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m16:58:28.400373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.435447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:58:28.435447 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:58:28.436447 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:58:28.442447 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:58:28.447522 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:58:28.448522 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m16:58:28.449522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:28.451522 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:58:28.451522 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m16:58:28.452522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:28.453523 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:58:28.453523 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:58:28.454522 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:58:28.455522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:58:28.457522 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m16:58:28.459522 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:58:28.459522 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m16:58:28.461107 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:58:28.461107 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m16:58:28.461107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233375590>]}
[0m16:58:28.461107 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m16:58:28.461107 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m16:58:28.461107 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m16:58:28.461107 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m16:58:28.461107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m16:58:28.461107 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m16:58:28.461107 [info ] [Thread-1 (]: 16:58:28 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m16:58:28.473865 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m16:58:28.473865 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m16:58:28.477863 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m16:58:28.478649 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:58:28.478649 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m16:58:28.478649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.500612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:58:28.510593 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:58:28.510593 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:58:28.512259 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:58:28.519980 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:58:28.519980 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m16:58:28.519980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:28.523497 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:58:28.523497 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m16:58:28.523497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:28.523497 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:58:28.527401 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:58:28.527401 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:58:28.529268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:58:28.534769 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m16:58:28.536780 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:58:28.536780 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m16:58:28.541803 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:58:28.541803 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m16:58:28.543807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232337EA310>]}
[0m16:58:28.545015 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.08s]
[0m16:58:28.546012 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m16:58:28.546012 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m16:58:28.547012 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.link_mobilite ........................ [RUN]
[0m16:58:28.548016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m16:58:28.548016 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m16:58:28.552011 [info ] [Thread-1 (]: 16:58:28 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m16:58:28.555011 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m16:58:28.556002 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m16:58:28.574908 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m16:58:28.577411 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:58:28.577411 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m16:58:28.578421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.607247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m16:58:28.611026 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:58:28.611026 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."link_mobilite"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:58:28.616023 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:58:28.619023 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m16:58:28.620023 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:58:28.620023 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m16:58:28.622028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:58:28.623536 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m16:58:28.624544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd777320-2848-482f-8423-1cfca97fb6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233FA6950>]}
[0m16:58:28.624544 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.link_mobilite ................... [[32mSELECT 500[0m in 0.08s]
[0m16:58:28.625545 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m16:58:28.627539 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:28.627539 [debug] [MainThread]: On master: BEGIN
[0m16:58:28.628594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:28.649417 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m16:58:28.649417 [debug] [MainThread]: On master: COMMIT
[0m16:58:28.649417 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:28.649417 [debug] [MainThread]: On master: COMMIT
[0m16:58:28.660629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:58:28.661538 [debug] [MainThread]: On master: Close
[0m16:58:28.661538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:28.661538 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:58:28.661538 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:58:28.661538 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m16:58:28.661538 [info ] [MainThread]: 
[0m16:58:28.661538 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m16:58:28.661538 [debug] [MainThread]: Command end result
[0m16:58:28.683406 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:58:28.683406 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:58:28.695803 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:58:28.695803 [info ] [MainThread]: 
[0m16:58:28.696810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:58:28.696810 [info ] [MainThread]: 
[0m16:58:28.697809 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:58:28.697809 [debug] [MainThread]: Command `dbt run` succeeded at 16:58:28.697809 after 1.71 seconds
[0m16:58:28.698808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023233107410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023231E6F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002322B3DF090>]}
[0m16:58:28.698808 [debug] [MainThread]: Flushing usage events
[0m16:58:29.208369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:15.768997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015523C5C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015523C9B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015524CABD50>]}


============================== 16:59:15.768997 | 1b699dde-c3c2-4fb6-b70c-5dc341b47f90 ==============================
[0m16:59:15.768997 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:59:15.768997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m16:59:15.861462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b699dde-c3c2-4fb6-b70c-5dc341b47f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015524D68CD0>]}
[0m16:59:15.909195 [debug] [MainThread]: Command `dbt clean` succeeded at 16:59:15.909195 after 0.21 seconds
[0m16:59:15.910195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015523C648D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001551CEDFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015522DE8F10>]}
[0m16:59:15.910195 [debug] [MainThread]: Flushing usage events
[0m16:59:16.340672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:22.204991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BA3CC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BB417710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BA3CEF50>]}


============================== 16:59:22.208598 | 7fb25921-d86d-4bdf-ac40-e3650af0b0e7 ==============================
[0m16:59:22.208598 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:59:22.208598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:22.326852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fb25921-d86d-4bdf-ac40-e3650af0b0e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BB645750>]}
[0m16:59:22.374330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fb25921-d86d-4bdf-ac40-e3650af0b0e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B6C7B910>]}
[0m16:59:22.374330 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:59:22.504035 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m16:59:22.506044 [debug] [MainThread]: Command `dbt run` failed at 16:59:22.506044 after 0.37 seconds
[0m16:59:22.506044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BA3D4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B9C9AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8B367FC90>]}
[0m16:59:22.506044 [debug] [MainThread]: Flushing usage events
[0m16:59:22.911108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:27.590859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13752E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1372DFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F137569F10>]}


============================== 16:59:27.590859 | 59d5dc6b-5a26-4983-9f96-5dbc9793e9a6 ==============================
[0m16:59:27.590859 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:59:27.590859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:59:27.684943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d5dc6b-5a26-4983-9f96-5dbc9793e9a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1386A34D0>]}
[0m16:59:27.711950 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-so_fw9q5'
[0m16:59:27.711950 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:59:27.865583 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:59:27.865583 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m16:59:27.913094 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m16:59:27.913094 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:59:27.960315 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:59:27.976348 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m16:59:28.373650 [info ] [MainThread]: Installed from version 0.11.2
[0m16:59:28.374655 [info ] [MainThread]: Up to date!
[0m16:59:28.375657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59d5dc6b-5a26-4983-9f96-5dbc9793e9a6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13878DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F138606C50>]}
[0m16:59:28.375657 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:28.745017 [info ] [MainThread]: Installed from version 1.3.0
[0m16:59:28.745017 [info ] [MainThread]: Up to date!
[0m16:59:28.745017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59d5dc6b-5a26-4983-9f96-5dbc9793e9a6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F138696CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1386D9490>]}
[0m16:59:28.745017 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:28.745017 after 1.23 seconds
[0m16:59:28.745017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13857AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13077F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13077FC90>]}
[0m16:59:28.745017 [debug] [MainThread]: Flushing usage events
[0m16:59:29.189685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:36.407872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022883CFE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022883D396D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022883D3A6D0>]}


============================== 16:59:36.411886 | 875bfc26-4fbe-4a54-8752-fb3bb84c76d3 ==============================
[0m16:59:36.411886 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:59:36.411886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:59:36.526085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022883CFF590>]}
[0m16:59:36.573750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022883487AD0>]}
[0m16:59:36.573750 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:59:36.709447 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:59:36.709447 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:59:36.709447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002288514FCD0>]}
[0m16:59:38.427406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885767F10>]}
[0m16:59:38.502161 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:59:38.505150 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:59:38.522794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228858DE610>]}
[0m16:59:38.523801 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m16:59:38.524793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885663250>]}
[0m16:59:38.526797 [info ] [MainThread]: 
[0m16:59:38.526797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:38.527794 [info ] [MainThread]: 
[0m16:59:38.528795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:38.531210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m16:59:38.636356 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m16:59:38.636356 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m16:59:38.637354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:38.678824 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m16:59:38.678824 [debug] [ThreadPool]: On list_sid_lite: Close
[0m16:59:38.682836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:59:38.686845 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:59:38.686845 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:59:38.688851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:38.716672 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:59:38.716672 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:59:38.718678 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:59:38.720683 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m16:59:38.722687 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:59:38.722687 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:59:38.728444 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:38.728444 [debug] [MainThread]: On master: BEGIN
[0m16:59:38.730449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:38.758007 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m16:59:38.758007 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:38.758007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:38.764025 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m16:59:38.764025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228857DA210>]}
[0m16:59:38.766031 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:38.766031 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:38.766031 [debug] [MainThread]: On master: BEGIN
[0m16:59:38.766031 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:59:38.768037 [debug] [MainThread]: On master: COMMIT
[0m16:59:38.768037 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:38.768037 [debug] [MainThread]: On master: COMMIT
[0m16:59:38.768037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:38.768037 [debug] [MainThread]: On master: Close
[0m16:59:38.771788 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m16:59:38.771788 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m16:59:38.771788 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m16:59:38.773795 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m16:59:38.777801 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m16:59:38.779807 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m16:59:38.795447 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m16:59:38.801042 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:59:38.801042 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m16:59:38.801042 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:38.832455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:59:38.833456 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:59:38.833456 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m16:59:38.836455 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:59:38.841471 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:59:38.842471 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m16:59:38.843472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:38.845460 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:59:38.845460 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m16:59:38.845460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:38.853817 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:59:38.853817 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:59:38.853817 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m16:59:38.853817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:38.861207 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m16:59:38.861207 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m16:59:38.861207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m16:59:38.861207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:59:38.861207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m16:59:38.861207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885A7FB90>]}
[0m16:59:38.861207 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:59:38.861207 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m16:59:38.861207 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m16:59:38.877657 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m16:59:38.877997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m16:59:38.877997 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m16:59:38.881055 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m16:59:38.882054 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m16:59:38.885055 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m16:59:38.886055 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:59:38.886055 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m16:59:38.886055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:38.916107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:59:38.917060 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:59:38.918071 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m16:59:38.921070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:59:38.922070 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:59:38.922070 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m16:59:38.922070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:38.922070 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:59:38.922070 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m16:59:38.928181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:38.928181 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:59:38.928181 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:59:38.928181 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m16:59:38.928181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:38.928181 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m16:59:38.928181 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m16:59:38.928181 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m16:59:38.928181 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:59:38.928181 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m16:59:38.928181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002288593BFD0>]}
[0m16:59:38.928181 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m16:59:38.928181 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m16:59:38.928181 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m16:59:38.928181 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m16:59:38.928181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m16:59:38.928181 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m16:59:38.945780 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m16:59:38.946789 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m16:59:38.950786 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m16:59:38.950786 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:59:38.950786 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m16:59:38.950786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:38.997273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:59:38.997273 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:59:38.997273 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m16:59:39.001286 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:59:39.005301 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:59:39.005301 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m16:59:39.007306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:39.010818 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:59:39.010818 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m16:59:39.012033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:39.012033 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:59:39.013834 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:59:39.013834 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m16:59:39.015843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:59:39.017852 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m16:59:39.017852 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m16:59:39.019862 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m16:59:39.019862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:59:39.021872 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m16:59:39.023881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885AE1650>]}
[0m16:59:39.023881 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:59:39.023881 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m16:59:39.026773 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m16:59:39.026773 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m16:59:39.028130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m16:59:39.028130 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m16:59:39.039521 [info ] [Thread-1 (]: 16:59:39 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m16:59:39.042520 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m16:59:39.043520 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m16:59:39.061315 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m16:59:39.062592 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:59:39.063379 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m16:59:39.064143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:39.095833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:59:39.095833 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:59:39.095833 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:59:39.101418 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:59:39.101418 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:59:39.101418 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m16:59:39.101418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:39.111461 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:59:39.111461 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m16:59:39.112481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:39.112481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:59:39.112481 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:59:39.112481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m16:59:39.112481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:39.112481 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m16:59:39.112481 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m16:59:39.112481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m16:59:39.112481 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:59:39.112481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m16:59:39.112481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885C06FD0>]}
[0m16:59:39.112481 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.08s]
[0m16:59:39.112481 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m16:59:39.128041 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m16:59:39.128878 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m16:59:39.128878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m16:59:39.128878 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m16:59:39.128878 [info ] [Thread-1 (]: 16:59:39 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m16:59:39.135799 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m16:59:39.136798 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m16:59:39.139798 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m16:59:39.139798 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:59:39.139798 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m16:59:39.139798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:39.168646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:59:39.168646 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:59:39.168646 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m16:59:39.178245 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m16:59:39.180114 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:59:39.180114 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m16:59:39.180114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:39.180114 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:59:39.180114 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m16:59:39.180114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:39.180114 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:59:39.180114 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:59:39.180114 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m16:59:39.180114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:59:39.194803 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m16:59:39.194803 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m16:59:39.195817 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m16:59:39.195817 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:59:39.195817 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m16:59:39.195817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885A7BA50>]}
[0m16:59:39.201447 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m16:59:39.201447 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m16:59:39.201447 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m16:59:39.201447 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.link_mobilite ........................ [RUN]
[0m16:59:39.201447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m16:59:39.201447 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m16:59:39.201447 [info ] [Thread-1 (]: 16:59:39 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m16:59:39.212449 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m16:59:39.213214 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m16:59:39.230095 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.231187 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp165939215220"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:59:39.231187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:39.262473 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m16:59:39.267243 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.267243 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m16:59:39.267243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:59:39.278128 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.278128 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp165939215220'
        
      order by ordinal_position

  
[0m16:59:39.286135 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m16:59:39.291138 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.291138 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:59:39.294138 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m16:59:39.300175 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.300175 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:59:39.303682 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m16:59:39.309682 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m16:59:39.310682 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.311686 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp165939215220"
    )


  
[0m16:59:39.312686 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:59:39.312686 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m16:59:39.312686 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m16:59:39.312686 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m16:59:39.312686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:39.312686 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m16:59:39.312686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '875bfc26-4fbe-4a54-8752-fb3bb84c76d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022885BA0650>]}
[0m16:59:39.312686 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m16:59:39.312686 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m16:59:39.312686 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:39.312686 [debug] [MainThread]: On master: BEGIN
[0m16:59:39.312686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:39.345879 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m16:59:39.345879 [debug] [MainThread]: On master: COMMIT
[0m16:59:39.345879 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:39.345879 [debug] [MainThread]: On master: COMMIT
[0m16:59:39.345879 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:39.345879 [debug] [MainThread]: On master: Close
[0m16:59:39.345879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:39.345879 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m16:59:39.345879 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:59:39.345879 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m16:59:39.345879 [info ] [MainThread]: 
[0m16:59:39.345879 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m16:59:39.345879 [debug] [MainThread]: Command end result
[0m16:59:39.379615 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:59:39.382136 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:59:39.385136 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:59:39.385136 [info ] [MainThread]: 
[0m16:59:39.385136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:39.385136 [info ] [MainThread]: 
[0m16:59:39.385136 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:59:39.385136 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:39.385136 after 3.05 seconds
[0m16:59:39.385136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FF595A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FCF9FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228FCF9F090>]}
[0m16:59:39.385136 [debug] [MainThread]: Flushing usage events
[0m16:59:39.902181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:56.218759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DBB4EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DBB4EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DBB4F8D0>]}


============================== 16:59:56.218759 | dde7f883-1682-4ff8-80e9-d67a5542032e ==============================
[0m16:59:56.218759 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:59:56.218759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:56.343234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dde7f883-1682-4ff8-80e9-d67a5542032e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D86CE0D0>]}
[0m16:59:56.390726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dde7f883-1682-4ff8-80e9-d67a5542032e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D847AB10>]}
[0m16:59:56.390726 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:59:56.519583 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:59:56.674790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:56.674790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:56.702635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dde7f883-1682-4ff8-80e9-d67a5542032e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DD1E4450>]}
[0m16:59:56.836307 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:59:56.838314 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:59:56.861874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dde7f883-1682-4ff8-80e9-d67a5542032e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D86E37D0>]}
[0m16:59:56.863881 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m16:59:56.863881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde7f883-1682-4ff8-80e9-d67a5542032e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DCFF2D50>]}
[0m16:59:56.866257 [info ] [MainThread]: 
[0m16:59:56.868263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:56.868263 [info ] [MainThread]: 
[0m16:59:56.868263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:56.870271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m16:59:56.962193 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:59:56.962193 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m16:59:56.962193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:57.108100 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m16:59:57.108100 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m16:59:57.108100 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:59:57.108100 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m16:59:57.120557 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m16:59:57.120557 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m16:59:57.125636 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.127647 [debug] [MainThread]: On master: BEGIN
[0m16:59:57.127647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:57.155139 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m16:59:57.155139 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.155139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:57.155139 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m16:59:57.155139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde7f883-1682-4ff8-80e9-d67a5542032e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3D8D22910>]}
[0m16:59:57.155139 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:57.155139 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.155139 [debug] [MainThread]: On master: BEGIN
[0m16:59:57.155139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:59:57.155139 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.155139 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.155139 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.155139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:57.155139 [debug] [MainThread]: On master: Close
[0m16:59:57.171170 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m16:59:57.171170 [info ] [Thread-1 (]: 1 of 12 START test not_null_hub_etablissement_hub_etablissement_hashkey ........ [RUN]
[0m16:59:57.171170 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30'
[0m16:59:57.173179 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m16:59:57.173179 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m16:59:57.173179 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m16:59:57.195587 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m16:59:57.198736 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m16:59:57.198736 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: BEGIN
[0m16:59:57.198736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:57.228514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:59:57.228514 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"
[0m16:59:57.228514 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hub_etablissement_hashkey
from "sid_lite"."public"."hub_etablissement"
where hub_etablissement_hashkey is null



  
  
      
    ) dbt_internal_test
[0m16:59:57.229575 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
LINE 16: select hub_etablissement_hashkey
                ^

[0m16:59:57.230572 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: ROLLBACK
[0m16:59:57.230572 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30: Close
[0m16:59:57.237572 [debug] [Thread-1 (]: Database Error in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
  LINE 16: select hub_etablissement_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql
[0m16:59:57.238572 [error] [Thread-1 (]: 1 of 12 ERROR not_null_hub_etablissement_hub_etablissement_hashkey ............. [[31mERROR[0m in 0.07s]
[0m16:59:57.239572 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30
[0m16:59:57.239572 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m16:59:57.239572 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30' to be skipped because of status 'error'.  Reason: Database Error in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
  LINE 16: select hub_etablissement_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql.
[0m16:59:57.240572 [info ] [Thread-1 (]: 2 of 12 START test not_null_hub_etudiant_hub_etudiant_hashkey .................. [RUN]
[0m16:59:57.241577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_hub_etablissement_hashkey.f546e94a30, now test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23)
[0m16:59:57.241577 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m16:59:57.245576 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m16:59:57.245576 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m16:59:57.245576 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m16:59:57.245576 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m16:59:57.245576 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: BEGIN
[0m16:59:57.245576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.279652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:59:57.280382 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"
[0m16:59:57.280382 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select hub_etudiant_hashkey
from "sid_lite"."public"."hub_etudiant"
where hub_etudiant_hashkey is null



  
  
      
    ) dbt_internal_test
[0m16:59:57.282390 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
LINE 16: select hub_etudiant_hashkey
                ^

[0m16:59:57.282390 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: ROLLBACK
[0m16:59:57.283389 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23: Close
[0m16:59:57.285388 [debug] [Thread-1 (]: Database Error in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
  LINE 16: select hub_etudiant_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql
[0m16:59:57.285388 [error] [Thread-1 (]: 2 of 12 ERROR not_null_hub_etudiant_hub_etudiant_hashkey ....................... [[31mERROR[0m in 0.04s]
[0m16:59:57.285388 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23
[0m16:59:57.285388 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m16:59:57.285388 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23' to be skipped because of status 'error'.  Reason: Database Error in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
  LINE 16: select hub_etudiant_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql.
[0m16:59:57.285388 [info ] [Thread-1 (]: 3 of 12 START test not_null_link_mobilite_link_mobilite_hashkey ................ [RUN]
[0m16:59:57.285388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_hub_etudiant_hashkey.05d91f7a23, now test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39)
[0m16:59:57.285388 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m16:59:57.285388 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m16:59:57.285388 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m16:59:57.285388 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m16:59:57.296053 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m16:59:57.296788 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: BEGIN
[0m16:59:57.296788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.320643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:59:57.320643 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"
[0m16:59:57.320643 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select link_mobilite_hashkey
from "sid_lite"."public"."link_mobilite"
where link_mobilite_hashkey is null



  
  
      
    ) dbt_internal_test
[0m16:59:57.328457 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
LINE 16: select link_mobilite_hashkey
                ^

[0m16:59:57.329613 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: ROLLBACK
[0m16:59:57.329613 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39: Close
[0m16:59:57.332536 [debug] [Thread-1 (]: Database Error in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
  LINE 16: select link_mobilite_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql
[0m16:59:57.332536 [error] [Thread-1 (]: 3 of 12 ERROR not_null_link_mobilite_link_mobilite_hashkey ..................... [[31mERROR[0m in 0.05s]
[0m16:59:57.332536 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39
[0m16:59:57.332536 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:59:57.332536 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39' to be skipped because of status 'error'.  Reason: Database Error in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
  LINE 16: select link_mobilite_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql.
[0m16:59:57.332536 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m16:59:57.332536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_link_mobilite_hashkey.15c5ad5e39, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m16:59:57.332536 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:59:57.332536 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:59:57.332536 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:59:57.332536 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:59:57.332536 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:59:57.332536 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m16:59:57.332536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.369140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:59:57.369140 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m16:59:57.369140 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m16:59:57.379844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:59:57.379844 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m16:59:57.379844 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m16:59:57.379844 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.05s]
[0m16:59:57.379844 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m16:59:57.379844 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:59:57.379844 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m16:59:57.379844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m16:59:57.379844 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:59:57.379844 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:59:57.379844 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:59:57.396532 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:59:57.397597 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:59:57.397597 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m16:59:57.398596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.420828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:59:57.428422 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m16:59:57.428422 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m16:59:57.429966 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:59:57.429966 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m16:59:57.429966 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m16:59:57.429966 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.05s]
[0m16:59:57.429966 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m16:59:57.429966 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:59:57.429966 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m16:59:57.429966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m16:59:57.429966 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:59:57.429966 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:59:57.429966 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:59:57.429966 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:59:57.429966 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:59:57.429966 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m16:59:57.429966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.468568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m16:59:57.468568 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m16:59:57.468568 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m16:59:57.478420 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:59:57.480037 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m16:59:57.480037 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m16:59:57.480037 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.05s]
[0m16:59:57.480037 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m16:59:57.480037 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m16:59:57.480037 [info ] [Thread-1 (]: 7 of 12 START test unique_hub_etablissement_hub_etablissement_hashkey .......... [RUN]
[0m16:59:57.480037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545)
[0m16:59:57.480037 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m16:59:57.480037 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m16:59:57.480037 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m16:59:57.480037 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m16:59:57.494960 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m16:59:57.495969 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: BEGIN
[0m16:59:57.496589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.520845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:59:57.520845 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"
[0m16:59:57.520845 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hub_etablissement_hashkey as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where hub_etablissement_hashkey is not null
group by hub_etablissement_hashkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:59:57.528433 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
LINE 15:     hub_etablissement_hashkey as unique_field,
             ^

[0m16:59:57.529441 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: ROLLBACK
[0m16:59:57.529441 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545: Close
[0m16:59:57.529441 [debug] [Thread-1 (]: Database Error in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
  LINE 15:     hub_etablissement_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql
[0m16:59:57.529441 [error] [Thread-1 (]: 7 of 12 ERROR unique_hub_etablissement_hub_etablissement_hashkey ............... [[31mERROR[0m in 0.05s]
[0m16:59:57.529441 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545
[0m16:59:57.529441 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m16:59:57.529441 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545' to be skipped because of status 'error'.  Reason: Database Error in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
  LINE 15:     hub_etablissement_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql.
[0m16:59:57.529441 [info ] [Thread-1 (]: 8 of 12 START test unique_hub_etudiant_hub_etudiant_hashkey .................... [RUN]
[0m16:59:57.529441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_hub_etablissement_hashkey.26f3b04545, now test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5)
[0m16:59:57.529441 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m16:59:57.529441 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m16:59:57.529441 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m16:59:57.529441 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m16:59:57.529441 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m16:59:57.529441 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: BEGIN
[0m16:59:57.529441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.568731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:59:57.568731 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"
[0m16:59:57.568731 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    hub_etudiant_hashkey as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where hub_etudiant_hashkey is not null
group by hub_etudiant_hashkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:59:57.568731 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
LINE 15:     hub_etudiant_hashkey as unique_field,
             ^

[0m16:59:57.568731 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: ROLLBACK
[0m16:59:57.568731 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5: Close
[0m16:59:57.568731 [debug] [Thread-1 (]: Database Error in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
  LINE 15:     hub_etudiant_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql
[0m16:59:57.568731 [error] [Thread-1 (]: 8 of 12 ERROR unique_hub_etudiant_hub_etudiant_hashkey ......................... [[31mERROR[0m in 0.04s]
[0m16:59:57.568731 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5
[0m16:59:57.578373 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m16:59:57.578373 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5' to be skipped because of status 'error'.  Reason: Database Error in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
  LINE 15:     hub_etudiant_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql.
[0m16:59:57.579384 [info ] [Thread-1 (]: 9 of 12 START test unique_link_mobilite_link_mobilite_hashkey .................. [RUN]
[0m16:59:57.579851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_hub_etudiant_hashkey.18748968f5, now test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550)
[0m16:59:57.579851 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m16:59:57.579851 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m16:59:57.579851 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m16:59:57.579851 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m16:59:57.579851 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m16:59:57.579851 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: BEGIN
[0m16:59:57.579851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.618460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:59:57.619460 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"
[0m16:59:57.619460 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    link_mobilite_hashkey as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where link_mobilite_hashkey is not null
group by link_mobilite_hashkey
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:59:57.621005 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
LINE 15:     link_mobilite_hashkey as unique_field,
             ^

[0m16:59:57.621005 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: ROLLBACK
[0m16:59:57.621005 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550: Close
[0m16:59:57.621005 [debug] [Thread-1 (]: Database Error in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
  LINE 15:     link_mobilite_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql
[0m16:59:57.621005 [error] [Thread-1 (]: 9 of 12 ERROR unique_link_mobilite_link_mobilite_hashkey ....................... [[31mERROR[0m in 0.04s]
[0m16:59:57.621005 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550
[0m16:59:57.621005 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:59:57.621005 [debug] [Thread-4 (]: Marking all children of 'test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550' to be skipped because of status 'error'.  Reason: Database Error in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
  LINE 15:     link_mobilite_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql.
[0m16:59:57.621005 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m16:59:57.621005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_link_mobilite_hashkey.e5bb1e5550, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m16:59:57.621005 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:59:57.630156 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:59:57.632163 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:59:57.634160 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:59:57.635161 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:59:57.635161 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m16:59:57.635161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.667505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m16:59:57.667505 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m16:59:57.668505 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:59:57.668505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:59:57.671582 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m16:59:57.673593 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m16:59:57.675603 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.05s]
[0m16:59:57.678402 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m16:59:57.679412 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:59:57.680786 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m16:59:57.682797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m16:59:57.684266 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:59:57.688272 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:59:57.689274 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:59:57.689274 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:59:57.692956 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:59:57.692956 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m16:59:57.692956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.724977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:59:57.724977 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m16:59:57.726987 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:59:57.729368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:59:57.729728 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m16:59:57.731654 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m16:59:57.731654 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.05s]
[0m16:59:57.731654 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m16:59:57.731654 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:59:57.731654 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m16:59:57.734957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m16:59:57.734957 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:59:57.738968 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:59:57.738968 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:59:57.740974 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:59:57.742979 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:59:57.742979 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m16:59:57.742979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.776447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:59:57.776447 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m16:59:57.778367 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:59:57.780129 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:59:57.782318 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m16:59:57.782318 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m16:59:57.782318 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.05s]
[0m16:59:57.782318 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m16:59:57.782318 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.782318 [debug] [MainThread]: On master: BEGIN
[0m16:59:57.782318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:57.813119 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m16:59:57.813119 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.813119 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.813119 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.813119 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:57.813119 [debug] [MainThread]: On master: Close
[0m16:59:57.813119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:57.813119 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m16:59:57.813119 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m16:59:57.821552 [info ] [MainThread]: 
[0m16:59:57.821552 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m16:59:57.821552 [debug] [MainThread]: Command end result
[0m16:59:57.846616 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m16:59:57.846616 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m16:59:57.846616 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m16:59:57.846616 [info ] [MainThread]: 
[0m16:59:57.846616 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m16:59:57.846616 [info ] [MainThread]: 
[0m16:59:57.860239 [error] [MainThread]: [31mFailure in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m16:59:57.860239 [error] [MainThread]:   Database Error in test not_null_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
  LINE 16: select hub_etablissement_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql
[0m16:59:57.860239 [info ] [MainThread]: 
[0m16:59:57.861252 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etablissement_hub_etablissement_hashkey.sql
[0m16:59:57.861252 [info ] [MainThread]: 
[0m16:59:57.862250 [error] [MainThread]: [31mFailure in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m16:59:57.862250 [error] [MainThread]:   Database Error in test not_null_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
  LINE 16: select hub_etudiant_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql
[0m16:59:57.863343 [info ] [MainThread]: 
[0m16:59:57.863343 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_hub_etudiant_hub_etudiant_hashkey.sql
[0m16:59:57.864390 [info ] [MainThread]: 
[0m16:59:57.864390 [error] [MainThread]: [31mFailure in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m16:59:57.864805 [error] [MainThread]:   Database Error in test not_null_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
  LINE 16: select link_mobilite_hashkey
                  ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql
[0m16:59:57.864805 [info ] [MainThread]: 
[0m16:59:57.864805 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\not_null_link_mobilite_link_mobilite_hashkey.sql
[0m16:59:57.864805 [info ] [MainThread]: 
[0m16:59:57.864805 [error] [MainThread]: [31mFailure in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m16:59:57.864805 [error] [MainThread]:   Database Error in test unique_hub_etablissement_hub_etablissement_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etablissement_hashkey » n'existe pas
  LINE 15:     hub_etablissement_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql
[0m16:59:57.864805 [info ] [MainThread]: 
[0m16:59:57.864805 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etablissement_hub_etablissement_hashkey.sql
[0m16:59:57.864805 [info ] [MainThread]: 
[0m16:59:57.864805 [error] [MainThread]: [31mFailure in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m16:59:57.864805 [error] [MainThread]:   Database Error in test unique_hub_etudiant_hub_etudiant_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « hub_etudiant_hashkey » n'existe pas
  LINE 15:     hub_etudiant_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql
[0m16:59:57.864805 [info ] [MainThread]: 
[0m16:59:57.864805 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_hub_etudiant_hub_etudiant_hashkey.sql
[0m16:59:57.864805 [info ] [MainThread]: 
[0m16:59:57.870164 [error] [MainThread]: [31mFailure in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)[0m
[0m16:59:57.870164 [error] [MainThread]:   Database Error in test unique_link_mobilite_link_mobilite_hashkey (dbt/sid-lite/models\vault\schema.yml)
  ERREUR:  la colonne « link_mobilite_hashkey » n'existe pas
  LINE 15:     link_mobilite_hashkey as unique_field,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql
[0m16:59:57.870164 [info ] [MainThread]: 
[0m16:59:57.871428 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\schema.yml\unique_link_mobilite_link_mobilite_hashkey.sql
[0m16:59:57.871428 [info ] [MainThread]: 
[0m16:59:57.871428 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=12
[0m16:59:57.872427 [debug] [MainThread]: Command `dbt test` failed at 16:59:57.872427 after 1.72 seconds
[0m16:59:57.872427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DBB54850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DCB71050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3DD75B790>]}
[0m16:59:57.873426 [debug] [MainThread]: Flushing usage events
[0m16:59:58.300759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:37.294526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F035E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F03577D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F13A7650>]}


============================== 17:04:37.294526 | 4bc49e23-760b-4b35-b79a-a55ee2233759 ==============================
[0m17:04:37.294526 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:04:37.298855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:37.414105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bc49e23-760b-4b35-b79a-a55ee2233759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F038B510>]}
[0m17:04:37.462034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bc49e23-760b-4b35-b79a-a55ee2233759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240ECC1B910>]}
[0m17:04:37.462034 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:04:37.595953 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:04:37.714831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:37.714831 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m17:04:37.920038 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  macro 'dbt_macro__hub' takes no keyword argument 'hub_pk_alias'
[0m17:04:37.920038 [debug] [MainThread]: Command `dbt run` failed at 17:04:37.920038 after 0.69 seconds
[0m17:04:37.920038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F1842CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F17F4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F1C771D0>]}
[0m17:04:37.920038 [debug] [MainThread]: Flushing usage events
[0m17:04:38.395579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:26.435915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0D90E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0D6BFE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0D90E890>]}


============================== 17:10:26.435915 | 86cb84ca-42e5-46a3-9313-cc8722be535c ==============================
[0m17:10:26.435915 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:10:26.435915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:26.567596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86cb84ca-42e5-46a3-9313-cc8722be535c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0CA02150>]}
[0m17:10:26.616848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86cb84ca-42e5-46a3-9313-cc8722be535c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0A1CB8D0>]}
[0m17:10:26.616848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:26.734334 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:10:26.860684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:26.860684 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m17:10:27.050457 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_etablissement (dbt/sid-lite/models\vault\hub_etablissement.sql)
  macro 'dbt_macro__hub' takes no keyword argument 'hub_pk_alias'
[0m17:10:27.050457 [debug] [MainThread]: Command `dbt run` failed at 17:10:27.050457 after 0.69 seconds
[0m17:10:27.060007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0D907DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0F217090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0D906E10>]}
[0m17:10:27.060007 [debug] [MainThread]: Flushing usage events
[0m17:10:27.629261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:48.388650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294EA4E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FA82ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FA83650>]}


============================== 17:10:48.388650 | 1aff2eba-02f9-446a-9f7c-9ec0f260fcb7 ==============================
[0m17:10:48.388650 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:10:48.404351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:48.520155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FCC7090>]}
[0m17:10:48.567220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294B31F550>]}
[0m17:10:48.567220 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:48.684141 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:10:48.815513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:48.815513 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\hub_etablissement.sql
[0m17:10:49.189674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FCD5250>]}
[0m17:10:49.234151 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:10:49.249822 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:10:49.249822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FCBCFD0>]}
[0m17:10:49.265532 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m17:10:49.265532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129503B01D0>]}
[0m17:10:49.265532 [info ] [MainThread]: 
[0m17:10:49.265532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:49.265532 [info ] [MainThread]: 
[0m17:10:49.265532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:49.265532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:10:49.364683 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:10:49.365682 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:10:49.365682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:49.401479 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m17:10:49.401479 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:10:49.401479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:10:49.401479 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:10:49.401479 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:10:49.401479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:49.433072 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:10:49.433072 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:10:49.433072 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:10:49.433072 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:10:49.433072 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:10:49.433072 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:10:49.449015 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:49.449015 [debug] [MainThread]: On master: BEGIN
[0m17:10:49.449015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:49.464682 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:10:49.464682 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:49.464682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:49.480656 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:10:49.480656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294D2A13D0>]}
[0m17:10:49.480656 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:49.480656 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:49.480656 [debug] [MainThread]: On master: BEGIN
[0m17:10:49.480656 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:10:49.480656 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.480656 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:49.480656 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.480656 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:49.480656 [debug] [MainThread]: On master: Close
[0m17:10:49.480656 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:10:49.480656 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:10:49.480656 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m17:10:49.480656 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:10:49.496462 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:10:49.496462 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:10:49.518300 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:10:49.519013 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:10:49.520018 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:10:49.520018 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:49.652022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m17:10:49.652022 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:10:49.652022 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:10:49.652022 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:49.652022 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:10:49.668019 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:10:49.668019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:49.668019 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:10:49.668019 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:10:49.668019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:49.668019 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:10:49.668019 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:10:49.668019 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:10:49.684335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:10:49.688535 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:10:49.691535 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:10:49.691535 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:10:49.693163 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:10:49.695167 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:10:49.698167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FF11350>]}
[0m17:10:49.698167 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m17:10:49.699170 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:10:49.699170 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:10:49.700167 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:10:49.700167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:10:49.701168 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:10:49.702167 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:10:49.702167 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:10:49.702167 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:10:49.702167 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:10:49.702167 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:10:49.702167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:49.735705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:10:49.735705 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:10:49.736713 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:10:49.740264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:10:49.742265 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:10:49.742265 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:10:49.742265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:49.742265 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:10:49.742265 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:10:49.742265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:49.742265 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:10:49.742265 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:10:49.742265 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:10:49.742265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:49.752284 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:10:49.753759 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:10:49.753759 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:10:49.753759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:10:49.753759 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:10:49.753759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001294FF1BA50>]}
[0m17:10:49.753759 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:10:49.753759 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:10:49.753759 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:10:49.759233 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:10:49.759233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:10:49.759233 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:10:49.759233 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:10:49.759233 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:10:49.759233 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:10:49.759233 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:10:49.759233 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:10:49.759233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:49.793061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:10:49.793061 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:10:49.793061 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m17:10:49.793061 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:49.802370 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:10:49.802370 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m17:10:49.803379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:49.804348 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:10:49.804348 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m17:10:49.804348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:49.804348 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:10:49.804348 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:10:49.804348 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:10:49.804348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:49.804348 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m17:10:49.804348 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:10:49.804348 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m17:10:49.804348 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:10:49.804348 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:10:49.804348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012950333850>]}
[0m17:10:49.804348 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:10:49.804348 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:10:49.804348 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:10:49.817378 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:10:49.817378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:10:49.817378 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:10:49.819907 [info ] [Thread-1 (]: 17:10:49 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:10:49.831280 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:10:49.832279 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:10:49.836593 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:10:49.836593 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:10:49.836593 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:10:49.836593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:49.870178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:10:49.870178 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:10:49.870178 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:10:49.870178 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:10:49.886481 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:10:49.886481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:10:49.886481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:49.886481 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:10:49.886481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:10:49.886481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:49.886481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:10:49.886481 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:10:49.886481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:10:49.886481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:49.886481 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:10:49.886481 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:10:49.886481 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:10:49.903326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:10:49.904326 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:10:49.905329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012950A3D190>]}
[0m17:10:49.905329 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.09s]
[0m17:10:49.906326 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:10:49.906326 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:10:49.907330 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:10:49.907330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:10:49.908327 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:10:49.911325 [info ] [Thread-1 (]: 17:10:49 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:10:49.914210 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:10:49.914210 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:10:49.918774 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:10:49.918774 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:10:49.918774 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:10:49.919940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:49.942105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:10:49.942105 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:10:49.942105 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:10:49.953285 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m17:10:49.953285 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:10:49.953285 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:10:49.953285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:49.953285 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:10:49.953285 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:10:49.953285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:49.953285 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:10:49.953285 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:10:49.953285 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:10:49.953285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:49.968934 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:10:49.968934 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:10:49.969942 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:10:49.971939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:10:49.971939 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:10:49.972939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012950AD3290>]}
[0m17:10:49.973939 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m17:10:49.974939 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:10:49.974939 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:10:49.974939 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.link_mobilite ........................ [RUN]
[0m17:10:49.975939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m17:10:49.975939 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m17:10:49.981938 [info ] [Thread-1 (]: 17:10:49 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m17:10:49.988667 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m17:10:49.988667 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m17:10:50.009587 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.009587 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp171050007587"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:10:50.009587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:50.045901 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m17:10:50.054827 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.055829 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m17:10:50.056804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:10:50.057820 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.057820 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp171050007587'
        
      order by ordinal_position

  
[0m17:10:50.063809 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m17:10:50.068809 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.069809 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:10:50.069809 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:10:50.069809 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.069809 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:10:50.069809 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:10:50.085760 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m17:10:50.085760 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.085760 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp171050007587"
    )


  
[0m17:10:50.085760 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m17:10:50.085760 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:10:50.085760 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:10:50.085760 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:10:50.085760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:50.085760 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m17:10:50.085760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aff2eba-02f9-446a-9f7c-9ec0f260fcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129505DA690>]}
[0m17:10:50.085760 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m17:10:50.085760 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:10:50.085760 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:50.085760 [debug] [MainThread]: On master: BEGIN
[0m17:10:50.085760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:50.120026 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:10:50.120026 [debug] [MainThread]: On master: COMMIT
[0m17:10:50.120026 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:50.120026 [debug] [MainThread]: On master: COMMIT
[0m17:10:50.120026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:50.120026 [debug] [MainThread]: On master: Close
[0m17:10:50.120026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:50.120026 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:10:50.120026 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:10:50.120026 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m17:10:50.120026 [info ] [MainThread]: 
[0m17:10:50.120026 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m17:10:50.120026 [debug] [MainThread]: Command end result
[0m17:10:50.250851 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:10:50.250851 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:10:50.250851 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:10:50.250851 [info ] [MainThread]: 
[0m17:10:50.250851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:50.250851 [info ] [MainThread]: 
[0m17:10:50.250851 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:10:50.250851 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:50.250851 after 1.93 seconds
[0m17:10:50.250851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012947CEF0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012947CEF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012947CFC210>]}
[0m17:10:50.250851 [debug] [MainThread]: Flushing usage events
[0m17:10:50.804121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:24.008149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD5B4C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD6B97950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD6B97910>]}


============================== 17:14:24.008149 | a36be372-b5ba-4f0a-a135-ef194d39f9d1 ==============================
[0m17:14:24.008149 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:14:24.012439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +hub_etablissement', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:24.134720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD6B97150>]}
[0m17:14:24.166299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD240A310>]}
[0m17:14:24.166299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:14:24.302822 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:14:24.429677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:24.429677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:24.461068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD71A0110>]}
[0m17:14:24.571653 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:14:24.571653 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:14:24.587683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD716BC10>]}
[0m17:14:24.587683 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m17:14:24.587683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD7011FD0>]}
[0m17:14:24.587683 [info ] [MainThread]: 
[0m17:14:24.587683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:24.587683 [info ] [MainThread]: 
[0m17:14:24.587683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:14:24.605645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:14:24.700898 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:14:24.700898 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:14:24.700898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:24.738084 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.036 seconds
[0m17:14:24.739083 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:14:24.739083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:14:24.742029 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:14:24.742029 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:14:24.742029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:24.770659 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m17:14:24.770659 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:14:24.770659 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:14:24.770659 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:14:24.770659 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:14:24.770659 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:14:24.784264 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:24.784264 [debug] [MainThread]: On master: BEGIN
[0m17:14:24.784264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:24.810612 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:14:24.810612 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:24.810612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:14:24.817894 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:14:24.817894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD76B5DD0>]}
[0m17:14:24.817894 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:24.817894 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:24.817894 [debug] [MainThread]: On master: BEGIN
[0m17:14:24.817894 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:14:24.817894 [debug] [MainThread]: On master: COMMIT
[0m17:14:24.817894 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:24.817894 [debug] [MainThread]: On master: COMMIT
[0m17:14:24.817894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:24.817894 [debug] [MainThread]: On master: Close
[0m17:14:24.817894 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:14:24.817894 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:14:24.817894 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m17:14:24.817894 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:14:24.830076 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:14:24.833629 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:14:24.840131 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:14:24.840131 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:14:24.840131 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:14:24.854837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:24.883736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:14:24.883736 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:14:24.884736 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:14:24.886736 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:14:24.888736 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:14:24.888736 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:14:24.888736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:14:24.888736 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:14:24.888736 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:14:24.888736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:14:24.904506 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:14:24.904506 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:14:24.904506 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:14:24.910091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:14:24.910091 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:14:24.920512 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:14:24.920512 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:14:24.920512 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:14:24.920512 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:14:24.930149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD76AF010>]}
[0m17:14:24.930149 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:14:24.930149 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:14:24.930149 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:14:24.930149 [info ] [Thread-1 (]: 2 of 2 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:14:24.930149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.hub_etablissement)
[0m17:14:24.930149 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:14:24.936223 [info ] [Thread-1 (]: 17:14:24 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:14:24.991725 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:14:24.991725 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:14:25.011686 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:14:25.012544 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:14:25.013562 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:14:25.013562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:25.039199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:14:25.039199 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:14:25.039199 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:14:25.039199 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:14:25.053249 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:14:25.053249 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:14:25.054994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:14:25.056998 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:14:25.056998 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:14:25.056998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:14:25.060793 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:14:25.060793 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:14:25.060793 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:14:25.060793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:14:25.065066 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:14:25.065066 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:14:25.067071 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:14:25.067071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:14:25.067071 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:14:25.070648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36be372-b5ba-4f0a-a135-ef194d39f9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD773F510>]}
[0m17:14:25.070648 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.14s]
[0m17:14:25.070648 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:14:25.070648 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:25.070648 [debug] [MainThread]: On master: BEGIN
[0m17:14:25.070648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:25.202965 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m17:14:25.202965 [debug] [MainThread]: On master: COMMIT
[0m17:14:25.202965 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:25.202965 [debug] [MainThread]: On master: COMMIT
[0m17:14:25.202965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:25.202965 [debug] [MainThread]: On master: Close
[0m17:14:25.202965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:25.202965 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:14:25.202965 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:14:25.202965 [debug] [MainThread]: Connection 'model.sid_lite.hub_etablissement' was properly closed.
[0m17:14:25.202965 [info ] [MainThread]: 
[0m17:14:25.202965 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m17:14:25.202965 [debug] [MainThread]: Command end result
[0m17:14:25.239854 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:14:25.240856 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:14:25.240856 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:14:25.240856 [info ] [MainThread]: 
[0m17:14:25.240856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:25.248354 [info ] [MainThread]: 
[0m17:14:25.248354 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:14:25.249377 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:25.249377 after 1.31 seconds
[0m17:14:25.249377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD5B4E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD58FF590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DACEE5F210>]}
[0m17:14:25.249377 [debug] [MainThread]: Flushing usage events
[0m17:14:25.721770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:57.369707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B9AAEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B9AF2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BAAF7E50>]}


============================== 17:16:57.369707 | 51fa1cbb-edda-4c94-b668-c0e949823ba5 ==============================
[0m17:16:57.369707 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:16:57.369707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:16:57.505234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BABED310>]}
[0m17:16:57.536370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B636BC10>]}
[0m17:16:57.536370 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:57.671371 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:16:57.803797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:57.805299 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\schema.yml
[0m17:16:58.186257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BB4F3E50>]}
[0m17:16:58.249499 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:16:58.249499 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:16:58.265293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BACA3BD0>]}
[0m17:16:58.265293 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m17:16:58.265293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BACC6FD0>]}
[0m17:16:58.265293 [info ] [MainThread]: 
[0m17:16:58.265293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:58.265293 [info ] [MainThread]: 
[0m17:16:58.265293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:58.265293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:16:58.370519 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:16:58.371519 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:16:58.371519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:58.406043 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.034 seconds
[0m17:16:58.406043 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:16:58.406043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:16:58.406043 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:16:58.406043 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:16:58.406043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:58.437350 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m17:16:58.437350 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:16:58.437350 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:16:58.437350 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:16:58.437350 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:16:58.437350 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:16:58.437350 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:58.453427 [debug] [MainThread]: On master: BEGIN
[0m17:16:58.453427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:58.469536 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:16:58.469536 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:58.469536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:58.485530 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m17:16:58.485530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BABED9D0>]}
[0m17:16:58.485530 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:58.485530 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:58.485530 [debug] [MainThread]: On master: BEGIN
[0m17:16:58.485530 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:16:58.485530 [debug] [MainThread]: On master: COMMIT
[0m17:16:58.485530 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:58.485530 [debug] [MainThread]: On master: COMMIT
[0m17:16:58.485530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:58.485530 [debug] [MainThread]: On master: Close
[0m17:16:58.485530 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:16:58.485530 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:16:58.485530 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m17:16:58.485530 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:16:58.501329 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:16:58.501329 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:16:58.522917 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:16:58.523601 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:16:58.523601 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:16:58.523601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:58.551939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:16:58.552944 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:16:58.552944 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:16:58.555942 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:16:58.561742 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:16:58.561742 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:16:58.562750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:58.564743 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:16:58.564743 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:16:58.565751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:58.573743 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:16:58.573743 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:16:58.573743 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:16:58.573743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:58.580953 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:16:58.582958 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:16:58.582958 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:16:58.582958 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:16:58.587550 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:16:58.589555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BB9E2790>]}
[0m17:16:58.589555 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:16:58.589555 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:16:58.589555 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:16:58.589555 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:16:58.589555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:16:58.589555 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:16:58.589555 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:16:58.589555 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:16:58.589555 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:16:58.589555 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:16:58.589555 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:16:58.589555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:58.630071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:16:58.630071 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:16:58.630071 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:16:58.630071 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:16:58.636571 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:16:58.636571 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:16:58.636571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:58.640771 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:16:58.640771 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:16:58.640771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:58.640771 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:16:58.640771 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:16:58.640771 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:16:58.643652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:58.646433 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:16:58.646433 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:16:58.648438 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:16:58.648438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:16:58.648438 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:16:58.648438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BBB8C690>]}
[0m17:16:58.651480 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:16:58.651480 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:16:58.651480 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:16:58.651480 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:16:58.651480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:16:58.651480 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:16:58.656454 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:16:58.657463 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:16:58.660188 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:16:58.661190 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:16:58.661190 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:16:58.661190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:58.691477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:16:58.692516 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:16:58.692516 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m17:16:58.695515 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:16:58.696516 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:16:58.696516 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m17:16:58.696516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:58.701178 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:16:58.701178 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m17:16:58.701178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:58.701178 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:16:58.701178 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:16:58.701178 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:16:58.704850 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m17:16:58.706354 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m17:16:58.707434 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:16:58.707434 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m17:16:58.707434 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:16:58.707434 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:16:58.707434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BBB6BC10>]}
[0m17:16:58.707434 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:16:58.707434 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:16:58.707434 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:16:58.707434 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:16:58.707434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:16:58.707434 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:16:58.723261 [info ] [Thread-1 (]: 17:16:58 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:16:58.725791 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:16:58.726790 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:16:58.739838 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:16:58.741559 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:16:58.741559 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:16:58.742597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:58.767718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:16:58.767718 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:16:58.767718 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:16:58.774551 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m17:16:58.781636 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:16:58.781636 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:16:58.783641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:58.785959 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:16:58.785959 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:16:58.785959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:58.785959 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:16:58.785959 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:16:58.785959 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:16:58.789749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:58.790818 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:16:58.790818 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:16:58.790818 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:16:58.790818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:16:58.790818 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:16:58.799622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BB4C1990>]}
[0m17:16:58.799622 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.09s]
[0m17:16:58.799622 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:16:58.799622 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:16:58.799622 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:16:58.799622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:16:58.799622 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:16:58.799622 [info ] [Thread-1 (]: 17:16:58 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:16:58.808689 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:16:58.808689 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:16:58.811722 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:16:58.812722 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:16:58.812722 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:16:58.812722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:58.842744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:16:58.843743 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:16:58.843743 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:16:58.846743 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m17:16:58.923096 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:16:58.923096 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:16:58.923096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:58.935108 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:16:58.935108 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:16:58.935108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:58.935108 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:16:58.935108 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:16:58.938843 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:16:58.938843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:58.941581 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:16:58.941581 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:16:58.941581 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:16:58.941581 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:16:58.941581 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:16:58.948500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BBB897D0>]}
[0m17:16:58.948500 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.14s]
[0m17:16:58.948500 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:16:58.948500 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:16:58.948500 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.link_mobilite ........................ [RUN]
[0m17:16:58.948500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m17:16:58.948500 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m17:16:58.954749 [info ] [Thread-1 (]: 17:16:58 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m17:16:58.959343 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m17:16:58.959343 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m17:16:58.977182 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:58.978181 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp171658972847"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:16:58.978181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:59.007045 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m17:16:59.022638 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:59.023259 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m17:16:59.023791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:16:59.023791 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:59.023791 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp171658972847'
        
      order by ordinal_position

  
[0m17:16:59.023791 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m17:16:59.036264 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:59.036264 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:59.040377 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:16:59.040377 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:59.040377 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:59.040377 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:16:59.054255 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m17:16:59.055763 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:59.056470 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp171658972847"
    )


  
[0m17:16:59.057757 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m17:16:59.058752 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:16:59.058752 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:16:59.059752 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:16:59.060860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:59.061885 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m17:16:59.062882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa1cbb-edda-4c94-b668-c0e949823ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BAD25DD0>]}
[0m17:16:59.062882 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m17:16:59.063868 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:16:59.064867 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:59.064867 [debug] [MainThread]: On master: BEGIN
[0m17:16:59.065867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:59.090332 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:16:59.090332 [debug] [MainThread]: On master: COMMIT
[0m17:16:59.090332 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:59.090332 [debug] [MainThread]: On master: COMMIT
[0m17:16:59.090332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:59.090332 [debug] [MainThread]: On master: Close
[0m17:16:59.090332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:59.090332 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:16:59.090332 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:16:59.090332 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m17:16:59.090332 [info ] [MainThread]: 
[0m17:16:59.090332 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m17:16:59.090332 [debug] [MainThread]: Command end result
[0m17:16:59.123169 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:16:59.126861 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:16:59.129859 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:16:59.129859 [info ] [MainThread]: 
[0m17:16:59.129859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:59.129859 [info ] [MainThread]: 
[0m17:16:59.129859 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:16:59.129859 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:59.129859 after 1.82 seconds
[0m17:16:59.129859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B53E5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B2CFFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B2CFF090>]}
[0m17:16:59.129859 [debug] [MainThread]: Flushing usage events
[0m17:16:59.655743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:05.139326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FD3EEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FE433550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FD42AA10>]}


============================== 17:17:05.139326 | cb68b9aa-a51d-49e1-b539-339f76aba11e ==============================
[0m17:17:05.139326 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:17:05.139326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:05.266919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb68b9aa-a51d-49e1-b539-339f76aba11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FD3EC7D0>]}
[0m17:17:05.305295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb68b9aa-a51d-49e1-b539-339f76aba11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F9CEDBD0>]}
[0m17:17:05.305295 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:17:05.423414 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:17:05.550176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:05.550176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:05.582311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb68b9aa-a51d-49e1-b539-339f76aba11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FE890D10>]}
[0m17:17:05.692833 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:17:05.708603 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:17:05.724603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb68b9aa-a51d-49e1-b539-339f76aba11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FEC37750>]}
[0m17:17:05.724603 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m17:17:05.724603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb68b9aa-a51d-49e1-b539-339f76aba11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FE894250>]}
[0m17:17:05.724603 [info ] [MainThread]: 
[0m17:17:05.724603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:05.724603 [info ] [MainThread]: 
[0m17:17:05.724603 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:05.740309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:17:05.835875 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:17:05.835875 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:17:05.836875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:05.873243 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m17:17:05.874251 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:17:05.874251 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:17:05.877250 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:17:05.879251 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:17:05.880250 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:17:05.886254 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:05.886254 [debug] [MainThread]: On master: BEGIN
[0m17:17:05.886254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:05.905128 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:17:05.905128 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:05.905128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:05.905128 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:17:05.920764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb68b9aa-a51d-49e1-b539-339f76aba11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FEC2F890>]}
[0m17:17:05.920764 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:05.920764 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:05.920764 [debug] [MainThread]: On master: BEGIN
[0m17:17:05.920764 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:17:05.920764 [debug] [MainThread]: On master: COMMIT
[0m17:17:05.920764 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:05.920764 [debug] [MainThread]: On master: COMMIT
[0m17:17:05.920764 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:17:05.920764 [debug] [MainThread]: On master: Close
[0m17:17:05.920764 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:17:05.920764 [info ] [Thread-1 (]: 1 of 12 START test not_null_hub_etablissement_oid_etablissement ................ [RUN]
[0m17:17:05.920764 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee'
[0m17:17:05.920764 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:17:05.939309 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:17:05.940376 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:17:05.945450 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:17:05.945450 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:17:05.945450 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: BEGIN
[0m17:17:05.945450 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:05.981007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:17:05.982013 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:17:05.983014 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m17:17:05.984011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:05.987010 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: ROLLBACK
[0m17:17:05.988010 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: Close
[0m17:17:05.989011 [info ] [Thread-1 (]: 1 of 12 PASS not_null_hub_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.07s]
[0m17:17:05.990012 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:17:05.991011 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:17:05.991011 [info ] [Thread-1 (]: 2 of 12 START test not_null_hub_etudiant_id_etudiant ........................... [RUN]
[0m17:17:05.991011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee, now test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22)
[0m17:17:05.991011 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:17:05.995382 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:17:05.995382 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:17:05.997387 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:17:05.997387 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:17:05.997387 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: BEGIN
[0m17:17:05.997387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.029954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:17:06.029954 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:17:06.029954 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."hub_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m17:17:06.029954 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.029954 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: ROLLBACK
[0m17:17:06.029954 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: Close
[0m17:17:06.029954 [info ] [Thread-1 (]: 2 of 12 PASS not_null_hub_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.04s]
[0m17:17:06.029954 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:17:06.036350 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:17:06.036350 [info ] [Thread-1 (]: 3 of 12 START test not_null_link_mobilite_id_mobilite .......................... [RUN]
[0m17:17:06.036350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22, now test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab)
[0m17:17:06.036350 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:17:06.039795 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:17:06.040800 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:17:06.043748 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:17:06.043748 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:17:06.044749 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: BEGIN
[0m17:17:06.044749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.073185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:17:06.074267 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:17:06.074641 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."link_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m17:17:06.076670 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.077672 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: ROLLBACK
[0m17:17:06.077672 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: Close
[0m17:17:06.078670 [info ] [Thread-1 (]: 3 of 12 PASS not_null_link_mobilite_id_mobilite ................................ [[32mPASS[0m in 0.04s]
[0m17:17:06.079669 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:17:06.079669 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:17:06.079669 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m17:17:06.079669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m17:17:06.079669 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:17:06.079669 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:17:06.079669 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:17:06.079669 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:17:06.079669 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:17:06.079669 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m17:17:06.079669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.113411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:17:06.113411 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:17:06.113411 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m17:17:06.113411 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.113411 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m17:17:06.113411 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m17:17:06.113411 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.03s]
[0m17:17:06.123330 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:17:06.124340 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:17:06.124803 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m17:17:06.124803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m17:17:06.124803 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:17:06.129024 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:17:06.129024 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:17:06.131029 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:17:06.131029 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:17:06.131029 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m17:17:06.133034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.163285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:17:06.163285 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:17:06.163285 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m17:17:06.163285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.163285 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m17:17:06.163285 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m17:17:06.163285 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.04s]
[0m17:17:06.163285 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:17:06.170288 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:17:06.170288 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m17:17:06.170288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m17:17:06.170288 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:17:06.174154 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:17:06.174154 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:17:06.174154 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:17:06.174154 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:17:06.174154 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m17:17:06.174154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.209175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:17:06.210175 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:17:06.210175 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m17:17:06.212175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.213177 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m17:17:06.213177 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m17:17:06.213177 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.04s]
[0m17:17:06.213177 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:17:06.215976 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:17:06.215976 [info ] [Thread-1 (]: 7 of 12 START test unique_hub_etablissement_oid_etablissement .................. [RUN]
[0m17:17:06.215976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5)
[0m17:17:06.215976 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:17:06.215976 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:17:06.215976 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:17:06.223202 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:17:06.224210 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:17:06.224813 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: BEGIN
[0m17:17:06.224813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.247215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:17:06.247215 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:17:06.256614 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:17:06.258268 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:17:06.258268 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: ROLLBACK
[0m17:17:06.258268 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: Close
[0m17:17:06.258268 [info ] [Thread-1 (]: 7 of 12 PASS unique_hub_etablissement_oid_etablissement ........................ [[32mPASS[0m in 0.04s]
[0m17:17:06.258268 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:17:06.258268 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:17:06.258268 [info ] [Thread-1 (]: 8 of 12 START test unique_hub_etudiant_id_etudiant ............................. [RUN]
[0m17:17:06.258268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5, now test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466)
[0m17:17:06.258268 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:17:06.258268 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:17:06.258268 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:17:06.258268 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:17:06.258268 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:17:06.258268 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: BEGIN
[0m17:17:06.258268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.413833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m17:17:06.414833 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:17:06.414833 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:17:06.416833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.418832 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: ROLLBACK
[0m17:17:06.418832 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: Close
[0m17:17:06.420832 [info ] [Thread-1 (]: 8 of 12 PASS unique_hub_etudiant_id_etudiant ................................... [[32mPASS[0m in 0.16s]
[0m17:17:06.422833 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:17:06.422833 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:17:06.423297 [info ] [Thread-1 (]: 9 of 12 START test unique_link_mobilite_id_mobilite ............................ [RUN]
[0m17:17:06.423297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466, now test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530)
[0m17:17:06.423297 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:17:06.423297 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:17:06.423297 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:17:06.423297 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:17:06.423297 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:17:06.423297 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: BEGIN
[0m17:17:06.423297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.460481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:17:06.461486 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:17:06.461486 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:17:06.464487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:17:06.464487 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: ROLLBACK
[0m17:17:06.464487 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: Close
[0m17:17:06.464487 [info ] [Thread-1 (]: 9 of 12 PASS unique_link_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.04s]
[0m17:17:06.468365 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:17:06.469375 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:17:06.469375 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m17:17:06.469375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m17:17:06.469375 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:17:06.473199 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:17:06.474203 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:17:06.476361 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:17:06.477359 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:17:06.477359 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m17:17:06.477359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.508209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:17:06.509241 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:17:06.509241 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:17:06.511239 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.512240 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m17:17:06.512240 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m17:17:06.513239 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.04s]
[0m17:17:06.513239 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:17:06.513239 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:17:06.513239 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m17:17:06.513239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m17:17:06.513239 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:17:06.518000 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:17:06.520004 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:17:06.521008 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:17:06.521008 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:17:06.521008 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m17:17:06.521008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.546862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m17:17:06.546862 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:17:06.546862 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:17:06.546862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:17:06.546862 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m17:17:06.546862 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m17:17:06.556750 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.03s]
[0m17:17:06.557755 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:17:06.558165 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:17:06.558165 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m17:17:06.558165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m17:17:06.558165 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:17:06.563185 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:17:06.563185 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:17:06.565190 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:17:06.565190 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:17:06.567194 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m17:17:06.567194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:06.596576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:17:06.596576 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:17:06.596576 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:17:06.596576 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:17:06.596576 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m17:17:06.596576 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m17:17:06.596576 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.04s]
[0m17:17:06.596576 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:17:06.596576 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:06.596576 [debug] [MainThread]: On master: BEGIN
[0m17:17:06.596576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:06.629789 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:17:06.629789 [debug] [MainThread]: On master: COMMIT
[0m17:17:06.629789 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:06.629789 [debug] [MainThread]: On master: COMMIT
[0m17:17:06.629789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:17:06.629789 [debug] [MainThread]: On master: Close
[0m17:17:06.629789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:06.629789 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:17:06.629789 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m17:17:06.629789 [info ] [MainThread]: 
[0m17:17:06.629789 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m17:17:06.629789 [debug] [MainThread]: Command end result
[0m17:17:06.661437 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:17:06.662438 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:17:06.662438 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:17:06.662438 [info ] [MainThread]: 
[0m17:17:06.662438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:06.662438 [info ] [MainThread]: 
[0m17:17:06.662438 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m17:17:06.662438 [debug] [MainThread]: Command `dbt test` succeeded at 17:17:06.662438 after 1.60 seconds
[0m17:17:06.662438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193FE433850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F671FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F671F090>]}
[0m17:17:06.662438 [debug] [MainThread]: Flushing usage events
[0m17:17:07.058018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:24.355156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E36FB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E26F22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E26F2D50>]}


============================== 17:34:24.371205 | 3c8b35cf-6f23-4bcb-aa0b-a5a1bb25c86d ==============================
[0m17:34:24.371205 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:34:24.371205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:24.459549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c8b35cf-6f23-4bcb-aa0b-a5a1bb25c86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E37DA710>]}
[0m17:34:24.505109 [debug] [MainThread]: Command `dbt clean` succeeded at 17:34:24.505109 after 0.23 seconds
[0m17:34:24.505109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DE045A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E26AC290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DB9DF0D0>]}
[0m17:34:24.505109 [debug] [MainThread]: Flushing usage events
[0m17:34:24.948298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:31.160727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE14FED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE14F7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE14FEBD0>]}


============================== 17:34:31.176788 | d61dcdb2-6481-4f0c-860b-a85a1c06cc65 ==============================
[0m17:34:31.176788 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:34:31.176788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:34:31.264765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd61dcdb2-6481-4f0c-860b-a85a1c06cc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE151FD10>]}
[0m17:34:31.282970 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-mxn99tni'
[0m17:34:31.282970 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:34:31.411329 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:34:31.414574 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m17:34:31.465240 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m17:34:31.473234 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:34:31.506878 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:34:31.524604 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m17:34:31.898737 [info ] [MainThread]: Installed from version 0.11.2
[0m17:34:31.898737 [info ] [MainThread]: Up to date!
[0m17:34:31.898737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd61dcdb2-6481-4f0c-860b-a85a1c06cc65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE05A1C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE0541B50>]}
[0m17:34:31.898737 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:34:32.293561 [info ] [MainThread]: Installed from version 1.3.0
[0m17:34:32.293561 [info ] [MainThread]: Up to date!
[0m17:34:32.293561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd61dcdb2-6481-4f0c-860b-a85a1c06cc65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE2638950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE26148D0>]}
[0m17:34:32.299097 [debug] [MainThread]: Command `dbt deps` succeeded at 17:34:32.299097 after 1.19 seconds
[0m17:34:32.299097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE1542510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE25D6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDA7BF090>]}
[0m17:34:32.299097 [debug] [MainThread]: Flushing usage events
[0m17:34:32.700284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:32.400728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF5BE7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF5BEE290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF5C30B90>]}


============================== 17:36:32.400728 | 167ba9e1-fe14-4f41-a69c-0f9e809d8497 ==============================
[0m17:36:32.400728 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:36:32.400728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:36:32.530942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF5387A90>]}
[0m17:36:32.566385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF24AAE90>]}
[0m17:36:32.566385 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:36:32.701236 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:36:32.701236 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:36:32.701236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF6D11D50>]}
[0m17:36:34.324188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF763F210>]}
[0m17:36:34.394728 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:36:34.396947 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:36:34.413913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF768CD10>]}
[0m17:36:34.414914 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m17:36:34.415911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF7689A90>]}
[0m17:36:34.416589 [info ] [MainThread]: 
[0m17:36:34.417858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:34.417858 [info ] [MainThread]: 
[0m17:36:34.418641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:36:34.421731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:36:34.517391 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:36:34.517391 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:36:34.517391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:34.548807 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.034 seconds
[0m17:36:34.548807 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:36:34.548807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:36:34.548807 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:36:34.548807 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:36:34.548807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:34.588195 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m17:36:34.589194 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:36:34.590193 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:36:34.593649 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m17:36:34.594650 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:36:34.595651 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:36:34.600886 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:34.600886 [debug] [MainThread]: On master: BEGIN
[0m17:36:34.602394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:34.616679 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:36:34.616679 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:34.616679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:36:34.632574 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m17:36:34.632574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF538FED0>]}
[0m17:36:34.632574 [debug] [MainThread]: On master: ROLLBACK
[0m17:36:34.632574 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:34.632574 [debug] [MainThread]: On master: BEGIN
[0m17:36:34.632574 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:36:34.632574 [debug] [MainThread]: On master: COMMIT
[0m17:36:34.632574 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:34.632574 [debug] [MainThread]: On master: COMMIT
[0m17:36:34.632574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:34.632574 [debug] [MainThread]: On master: Close
[0m17:36:34.632574 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:36:34.632574 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:36:34.632574 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m17:36:34.632574 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:36:34.648253 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:36:34.648253 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:36:34.669595 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:36:34.670594 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:36:34.670594 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:36:34.670594 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:36:34.700689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:34.701687 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:36:34.702687 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:36:34.705198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:36:34.710197 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:36:34.710197 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:36:34.711198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:36:34.714197 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:36:34.714197 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:36:34.715198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:34.723734 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:36:34.723734 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:36:34.724734 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:36:34.726547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:36:34.731568 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:36:34.734103 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:36:34.734103 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:36:34.734103 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:36:34.734103 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:36:34.734103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF79E6910>]}
[0m17:36:34.734103 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:36:34.734103 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:36:34.734103 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:36:34.734103 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:36:34.734103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:36:34.734103 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:36:34.734103 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:36:34.734103 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:36:34.734103 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:36:34.734103 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:36:34.750057 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:36:34.750057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:34.767463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m17:36:34.767463 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:36:34.767463 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:36:34.767463 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:36:34.784085 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:36:34.784085 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:36:34.785081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:36:34.787081 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:36:34.787081 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:36:34.788087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:34.789088 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:36:34.789088 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:36:34.789088 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:36:34.790414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:36:34.791422 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:36:34.792420 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:36:34.792420 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:36:34.793835 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:36:34.793835 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:36:34.794841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF7968D10>]}
[0m17:36:34.795840 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:36:34.796840 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:36:34.796840 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:36:34.796840 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:36:34.797840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:36:34.797840 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:36:34.801785 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:36:34.802788 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:36:34.804855 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:36:34.805856 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:36:34.805856 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:36:34.805856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:34.836471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:36:34.836471 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:36:34.837473 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source               -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m17:36:34.839469 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:36:34.839469 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:36:34.839469 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m17:36:34.839469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:36:34.839469 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:36:34.839469 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m17:36:34.839469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:34.839469 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:36:34.839469 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:36:34.849584 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:36:34.850592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:36:34.850592 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m17:36:34.850592 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:36:34.850592 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m17:36:34.850592 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:36:34.850592 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:36:34.850592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF7AE1590>]}
[0m17:36:34.850592 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:36:34.859134 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:36:34.859134 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:36:34.859134 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:36:34.859134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:36:34.859134 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:36:34.869907 [info ] [Thread-1 (]: 17:36:34 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:36:34.871954 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:36:34.872956 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:36:34.886696 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:36:34.887695 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:36:34.889698 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:36:34.889698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:34.918459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m17:36:34.918459 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:36:34.918459 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:36:34.927475 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m17:36:34.934248 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:36:34.935247 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:36:34.935247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:34.938245 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:36:34.938245 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:36:34.939661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:36:34.939661 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:36:34.939661 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:36:34.939661 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:36:34.939661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:36:34.939661 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:36:34.939661 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:36:34.939661 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:36:34.949610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:36:34.950615 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:36:34.951615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF7690410>]}
[0m17:36:34.952770 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.09s]
[0m17:36:34.952770 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:36:34.953770 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:36:34.953770 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:36:34.954769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:36:34.954769 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:36:34.957769 [info ] [Thread-1 (]: 17:36:34 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:36:34.959770 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:36:34.960769 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:36:34.963771 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:36:34.963771 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:36:34.964774 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:36:34.964774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:34.989773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:34.989773 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:36:34.989773 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:36:34.989773 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:36:35.002978 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:36:35.002978 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:36:35.002978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:35.002978 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:36:35.002978 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:36:35.002978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:36:35.002978 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:36:35.002978 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:36:35.002978 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:36:35.002978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:36:35.002978 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:36:35.002978 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:36:35.002978 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:36:35.017409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:36:35.017409 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:36:35.017409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF4C90650>]}
[0m17:36:35.017409 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m17:36:35.021962 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:36:35.021962 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:36:35.021962 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.link_mobilite ........................ [RUN]
[0m17:36:35.021962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m17:36:35.021962 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m17:36:35.021962 [info ] [Thread-1 (]: 17:36:35 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m17:36:35.031351 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m17:36:35.032352 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m17:36:35.049740 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.049740 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp173635034352"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:36:35.050750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:35.067836 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m17:36:35.083970 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.083970 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m17:36:35.083970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:36:35.083970 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.083970 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp173635034352'
        
      order by ordinal_position

  
[0m17:36:35.100761 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m17:36:35.106272 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.107273 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:36:35.109271 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:36:35.114270 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.114270 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:36:35.117669 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:36:35.123667 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m17:36:35.124671 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.124671 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp173635034352"
    )


  
[0m17:36:35.125668 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m17:36:35.126669 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:36:35.126669 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:36:35.126669 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:36:35.128659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:36:35.129666 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m17:36:35.130663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167ba9e1-fe14-4f41-a69c-0f9e809d8497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF7692810>]}
[0m17:36:35.130663 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m17:36:35.131663 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:36:35.132664 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:35.132664 [debug] [MainThread]: On master: BEGIN
[0m17:36:35.133665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:35.155716 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m17:36:35.155716 [debug] [MainThread]: On master: COMMIT
[0m17:36:35.155716 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:35.155716 [debug] [MainThread]: On master: COMMIT
[0m17:36:35.155716 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:35.155716 [debug] [MainThread]: On master: Close
[0m17:36:35.155716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:35.155716 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:36:35.155716 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:36:35.155716 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m17:36:35.155716 [info ] [MainThread]: 
[0m17:36:35.155716 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:36:35.155716 [debug] [MainThread]: Command end result
[0m17:36:35.188264 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:36:35.189268 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:36:35.189268 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:36:35.189268 [info ] [MainThread]: 
[0m17:36:35.189268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:35.189268 [info ] [MainThread]: 
[0m17:36:35.189268 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:36:35.189268 [debug] [MainThread]: Command `dbt run` succeeded at 17:36:35.189268 after 2.86 seconds
[0m17:36:35.189268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF5C32510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EEEE6FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EEEE6F090>]}
[0m17:36:35.189268 [debug] [MainThread]: Flushing usage events
[0m17:36:35.719810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:40.254636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025647007C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564581A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256470525D0>]}


============================== 17:36:40.254636 | 36f0f314-bc02-4fcb-8cad-d1db95d07371 ==============================
[0m17:36:40.254636 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:36:40.254636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:40.381326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36f0f314-bc02-4fcb-8cad-d1db95d07371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025648284250>]}
[0m17:36:40.428702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36f0f314-bc02-4fcb-8cad-d1db95d07371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256438BBC50>]}
[0m17:36:40.428702 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:36:40.547565 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:36:40.674061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:40.674061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:40.705548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f0f314-bc02-4fcb-8cad-d1db95d07371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564603F150>]}
[0m17:36:40.817189 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:36:40.817189 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:36:40.852791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f0f314-bc02-4fcb-8cad-d1db95d07371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643AE6D10>]}
[0m17:36:40.853792 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m17:36:40.853792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f0f314-bc02-4fcb-8cad-d1db95d07371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643851AD0>]}
[0m17:36:40.855789 [info ] [MainThread]: 
[0m17:36:40.856789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:40.856789 [info ] [MainThread]: 
[0m17:36:40.856789 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:36:40.860789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:36:40.959348 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:36:40.959348 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:36:40.960349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:40.983097 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m17:36:40.983097 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:36:40.983097 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:36:40.999213 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m17:36:40.999213 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:36:40.999213 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:36:40.999213 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:40.999213 [debug] [MainThread]: On master: BEGIN
[0m17:36:40.999213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:41.036132 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.036132 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:41.036132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:36:41.036132 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:36:41.036132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f0f314-bc02-4fcb-8cad-d1db95d07371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025645636D50>]}
[0m17:36:41.047040 [debug] [MainThread]: On master: ROLLBACK
[0m17:36:41.047040 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:41.047040 [debug] [MainThread]: On master: BEGIN
[0m17:36:41.047040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:36:41.047040 [debug] [MainThread]: On master: COMMIT
[0m17:36:41.047040 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:41.047040 [debug] [MainThread]: On master: COMMIT
[0m17:36:41.047040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:41.047040 [debug] [MainThread]: On master: Close
[0m17:36:41.047040 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:36:41.047040 [info ] [Thread-1 (]: 1 of 12 START test not_null_hub_etablissement_oid_etablissement ................ [RUN]
[0m17:36:41.047040 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee'
[0m17:36:41.047040 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:36:41.066392 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:36:41.066721 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:36:41.070929 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:36:41.070929 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:36:41.070929 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: BEGIN
[0m17:36:41.070929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:36:41.108978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:36:41.109978 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m17:36:41.110978 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m17:36:41.111978 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.114978 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: ROLLBACK
[0m17:36:41.114978 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: Close
[0m17:36:41.116386 [info ] [Thread-1 (]: 1 of 12 PASS not_null_hub_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.07s]
[0m17:36:41.116701 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m17:36:41.116701 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:36:41.117709 [info ] [Thread-1 (]: 2 of 12 START test not_null_hub_etudiant_id_etudiant ........................... [RUN]
[0m17:36:41.118712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee, now test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22)
[0m17:36:41.118712 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:36:41.121711 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:36:41.122711 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:36:41.124711 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:36:41.124711 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:36:41.125711 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: BEGIN
[0m17:36:41.125711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.153992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.154997 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m17:36:41.154997 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."hub_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m17:36:41.156995 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.156995 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: ROLLBACK
[0m17:36:41.156995 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: Close
[0m17:36:41.156995 [info ] [Thread-1 (]: 2 of 12 PASS not_null_hub_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.04s]
[0m17:36:41.156995 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m17:36:41.156995 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:36:41.156995 [info ] [Thread-1 (]: 3 of 12 START test not_null_link_mobilite_id_mobilite .......................... [RUN]
[0m17:36:41.156995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22, now test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab)
[0m17:36:41.156995 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:36:41.156995 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:36:41.156995 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:36:41.167484 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:36:41.167935 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:36:41.167935 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: BEGIN
[0m17:36:41.168983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.189735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m17:36:41.189735 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m17:36:41.189735 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."link_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m17:36:41.189735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.199692 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: ROLLBACK
[0m17:36:41.200701 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: Close
[0m17:36:41.201250 [info ] [Thread-1 (]: 3 of 12 PASS not_null_link_mobilite_id_mobilite ................................ [[32mPASS[0m in 0.04s]
[0m17:36:41.201250 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m17:36:41.201250 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:36:41.201250 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m17:36:41.201250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m17:36:41.201250 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:36:41.201250 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:36:41.201250 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:36:41.201250 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:36:41.201250 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:36:41.201250 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m17:36:41.201250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.239465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.240464 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m17:36:41.240464 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m17:36:41.240464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.240464 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m17:36:41.240464 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m17:36:41.240464 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.04s]
[0m17:36:41.240464 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m17:36:41.240464 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:36:41.240464 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m17:36:41.240464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m17:36:41.240464 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:36:41.249768 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:36:41.250778 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:36:41.253885 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:36:41.254885 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:36:41.254885 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m17:36:41.255889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.284472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.285474 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m17:36:41.285474 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m17:36:41.287473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.288476 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m17:36:41.288476 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m17:36:41.289475 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.05s]
[0m17:36:41.289475 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m17:36:41.289475 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:36:41.289475 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m17:36:41.289475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m17:36:41.289475 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:36:41.289475 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:36:41.289475 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:36:41.289475 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:36:41.299756 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:36:41.300765 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m17:36:41.300765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.323105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:36:41.323105 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m17:36:41.323105 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m17:36:41.333150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.334159 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m17:36:41.334159 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m17:36:41.336419 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.04s]
[0m17:36:41.336419 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m17:36:41.336419 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:36:41.336419 [info ] [Thread-1 (]: 7 of 12 START test unique_hub_etablissement_oid_etablissement .................. [RUN]
[0m17:36:41.336419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5)
[0m17:36:41.336419 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:36:41.336419 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:36:41.336419 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:36:41.336419 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:36:41.336419 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:36:41.336419 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: BEGIN
[0m17:36:41.336419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.373896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.373896 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m17:36:41.373896 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:41.373896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.373896 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: ROLLBACK
[0m17:36:41.373896 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: Close
[0m17:36:41.384096 [info ] [Thread-1 (]: 7 of 12 PASS unique_hub_etablissement_oid_etablissement ........................ [[32mPASS[0m in 0.05s]
[0m17:36:41.384583 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m17:36:41.384583 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:36:41.384583 [info ] [Thread-1 (]: 8 of 12 START test unique_hub_etudiant_id_etudiant ............................. [RUN]
[0m17:36:41.384583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5, now test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466)
[0m17:36:41.384583 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:36:41.384583 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:36:41.384583 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:36:41.384583 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:36:41.384583 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:36:41.384583 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: BEGIN
[0m17:36:41.384583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.422106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:36:41.423101 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m17:36:41.423101 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:41.423101 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.423101 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: ROLLBACK
[0m17:36:41.423101 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: Close
[0m17:36:41.423101 [info ] [Thread-1 (]: 8 of 12 PASS unique_hub_etudiant_id_etudiant ................................... [[32mPASS[0m in 0.04s]
[0m17:36:41.423101 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m17:36:41.423101 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:36:41.423101 [info ] [Thread-1 (]: 9 of 12 START test unique_link_mobilite_id_mobilite ............................ [RUN]
[0m17:36:41.423101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466, now test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530)
[0m17:36:41.423101 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:36:41.433011 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:36:41.434110 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:36:41.437257 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:36:41.438257 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:36:41.438257 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: BEGIN
[0m17:36:41.439263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.467788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.467788 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m17:36:41.468787 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:41.469790 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.470791 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: ROLLBACK
[0m17:36:41.471791 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: Close
[0m17:36:41.472792 [info ] [Thread-1 (]: 9 of 12 PASS unique_link_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.05s]
[0m17:36:41.472792 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m17:36:41.472792 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:36:41.472792 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m17:36:41.472792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m17:36:41.472792 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:36:41.472792 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:36:41.472792 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:36:41.472792 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:36:41.472792 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:36:41.472792 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m17:36:41.472792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.506873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:36:41.506873 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m17:36:41.506873 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:41.506873 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:36:41.506873 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m17:36:41.506873 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m17:36:41.516430 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.04s]
[0m17:36:41.517438 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m17:36:41.517438 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:36:41.517438 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m17:36:41.517438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m17:36:41.517438 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:36:41.517438 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:36:41.517438 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:36:41.517438 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:36:41.517438 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:36:41.517438 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m17:36:41.517438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.555401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:36:41.556412 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m17:36:41.556412 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:41.556412 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:36:41.556412 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m17:36:41.556412 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m17:36:41.556412 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.04s]
[0m17:36:41.556412 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m17:36:41.556412 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:36:41.556412 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m17:36:41.556412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m17:36:41.556412 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:36:41.556412 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:36:41.566450 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:36:41.569367 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:36:41.570365 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:36:41.570365 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m17:36:41.571366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.599740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:36:41.601126 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m17:36:41.601126 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:41.603171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:36:41.604173 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m17:36:41.605169 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m17:36:41.605169 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.05s]
[0m17:36:41.606173 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m17:36:41.606173 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:41.606173 [debug] [MainThread]: On master: BEGIN
[0m17:36:41.606173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:41.636977 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m17:36:41.636977 [debug] [MainThread]: On master: COMMIT
[0m17:36:41.636977 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:41.636977 [debug] [MainThread]: On master: COMMIT
[0m17:36:41.636977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:41.636977 [debug] [MainThread]: On master: Close
[0m17:36:41.636977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:41.636977 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:36:41.636977 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m17:36:41.636977 [info ] [MainThread]: 
[0m17:36:41.636977 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:36:41.636977 [debug] [MainThread]: Command end result
[0m17:36:41.667529 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:36:41.670777 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:36:41.673775 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:36:41.673775 [info ] [MainThread]: 
[0m17:36:41.673775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:41.673775 [info ] [MainThread]: 
[0m17:36:41.673775 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m17:36:41.673775 [debug] [MainThread]: Command `dbt test` succeeded at 17:36:41.673775 after 1.48 seconds
[0m17:36:41.673775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564026F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025648BA20D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564026F090>]}
[0m17:36:41.673775 [debug] [MainThread]: Flushing usage events
[0m17:36:42.113972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:00.744586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EE2E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EE2F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787EE2F450>]}


============================== 17:45:00.749870 | 73c644c9-00e9-4349-8b4c-e339800d287e ==============================
[0m17:45:00.749870 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:45:00.749870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:00.872174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787DF2A090>]}
[0m17:45:00.903658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787B6EBB50>]}
[0m17:45:00.903658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:45:01.037243 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:45:01.164909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:45:01.164909 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m17:45:01.164909 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:45:01.528350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780078D810>]}
[0m17:45:01.572083 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:45:01.572083 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:45:01.587312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800748790>]}
[0m17:45:01.587312 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:45:01.587312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787FF3ED90>]}
[0m17:45:01.603265 [info ] [MainThread]: 
[0m17:45:01.603265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:01.603265 [info ] [MainThread]: 
[0m17:45:01.603265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:01.603265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:45:01.702305 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:45:01.702305 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:45:01.703306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:01.738032 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.036 seconds
[0m17:45:01.738032 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:45:01.740903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:45:01.746081 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:45:01.746081 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:45:01.746081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:01.773619 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m17:45:01.773619 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:45:01.773619 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:45:01.773619 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:45:01.773619 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:45:01.773619 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:45:01.787404 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:01.787404 [debug] [MainThread]: On master: BEGIN
[0m17:45:01.787404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:01.922671 [debug] [MainThread]: SQL status: BEGIN in 0.137 seconds
[0m17:45:01.922671 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:01.922671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:01.922671 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:45:01.932250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787DE64C10>]}
[0m17:45:01.932250 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:01.932250 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:01.932250 [debug] [MainThread]: On master: BEGIN
[0m17:45:01.932250 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:45:01.932250 [debug] [MainThread]: On master: COMMIT
[0m17:45:01.932250 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:01.932250 [debug] [MainThread]: On master: COMMIT
[0m17:45:01.932250 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:45:01.932250 [debug] [MainThread]: On master: Close
[0m17:45:01.938027 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:45:01.938027 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:45:01.938027 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.sat_mobilite'
[0m17:45:01.938027 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:45:01.949567 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:45:01.951501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800D5E7D0>]}
[0m17:45:01.952522 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m17:45:01.952522 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:45:01.953522 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:45:01.953522 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:45:01.953522 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:45:01.954522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.sat_mobilite, now model.sid_lite.stg_etablissement)
[0m17:45:01.954522 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:45:01.954522 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:45:01.954522 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:45:01.976358 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:45:01.976358 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:45:01.976358 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:45:01.976358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:02.006776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:45:02.006776 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:45:02.006776 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:45:02.006776 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:45:02.006776 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:45:02.006776 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:45:02.022061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:45:02.023069 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:45:02.023069 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:45:02.023069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:45:02.023069 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:45:02.023069 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:45:02.023069 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:45:02.023069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:45:02.040780 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:45:02.043782 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:45:02.043782 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:45:02.045894 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:45:02.047092 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:45:02.048078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278007DC810>]}
[0m17:45:02.049073 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:45:02.049073 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:45:02.050073 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:45:02.050073 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:45:02.050073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:45:02.051577 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:45:02.053581 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:45:02.054581 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:45:02.058067 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:45:02.059068 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:45:02.059068 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:45:02.060066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:02.088754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:45:02.090025 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:45:02.090025 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:45:02.093022 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:45:02.096020 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:45:02.097020 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:45:02.097020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:45:02.099025 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:45:02.100023 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:45:02.100023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:45:02.101023 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:45:02.102020 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:45:02.102020 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:45:02.103023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:45:02.105021 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:45:02.105639 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:45:02.105639 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:45:02.105639 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:45:02.105639 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:45:02.105639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800EF7D50>]}
[0m17:45:02.105639 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:45:02.105639 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:45:02.105639 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:45:02.105639 [info ] [Thread-1 (]: 4 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:45:02.105639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:45:02.105639 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:45:02.105639 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:45:02.105639 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:45:02.105639 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:45:02.120901 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:45:02.120901 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:45:02.121879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:02.151832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:45:02.151832 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:45:02.151832 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source,
    DECODE(MD5(NULLIF(CONCAT_WS('||',
    COALESCE(NULLIF(UPPER(TRIM(CAST(date_debut AS VARCHAR))), ''), '^^'),
    COALESCE(NULLIF(UPPER(TRIM(CAST(date_fin AS VARCHAR))), ''), '^^'),
    COALESCE(NULLIF(UPPER(TRIM(CAST(type_mobilite AS VARCHAR))), ''), '^^'),
    COALESCE(NULLIF(UPPER(TRIM(CAST(statut_mobilite AS VARCHAR))), ''), '^^')
), '^^||^^||^^||^^')), 'hex') AS None as hashdiff_mobilite                   -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m17:45:02.151832 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « as »
LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None as hashdiff_mobilite  ...
                                               ^

[0m17:45:02.151832 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: ROLLBACK
[0m17:45:02.155342 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:45:02.158136 [debug] [Thread-1 (]: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « as »
  LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None as hashdiff_mobilite  ...
                                                 ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:45:02.158136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800F6BBD0>]}
[0m17:45:02.158136 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model public.stg_mobilite ....................... [[31mERROR[0m in 0.05s]
[0m17:45:02.158136 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:45:02.158136 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:45:02.158136 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.stg_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « as »
  LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None as hashdiff_mobilite  ...
                                                 ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql.
[0m17:45:02.158136 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:45:02.158136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:45:02.158136 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:45:02.177376 [info ] [Thread-1 (]: 17:45:02 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:45:02.211246 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:45:02.211246 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:45:02.223090 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:45:02.223090 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:45:02.223090 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:45:02.223090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:02.255843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:45:02.255843 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:45:02.255843 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:45:02.255843 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:45:02.255843 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:45:02.255843 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:45:02.255843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:45:02.272366 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:45:02.272366 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:45:02.273373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:45:02.274374 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:45:02.274374 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:45:02.274374 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:45:02.275934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:45:02.276942 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:45:02.278941 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:45:02.279940 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:45:02.282198 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:45:02.283198 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:45:02.283198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800F38590>]}
[0m17:45:02.284197 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.13s]
[0m17:45:02.285197 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:45:02.285197 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:45:02.285197 [info ] [Thread-1 (]: 6 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:45:02.286198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:45:02.287198 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:45:02.290884 [info ] [Thread-1 (]: 17:45:02 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:45:02.293462 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:45:02.294461 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:45:02.297461 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:45:02.298462 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:45:02.298462 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:45:02.298462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:02.323624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:45:02.323624 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:45:02.323624 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:45:02.323624 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:45:02.323624 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:45:02.338796 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:45:02.339816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:45:02.340236 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:45:02.340236 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:45:02.340236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:45:02.340236 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:45:02.340236 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:45:02.340236 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:45:02.340236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:45:02.340236 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:45:02.340236 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:45:02.340236 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:45:02.340236 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:45:02.351968 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:45:02.351968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c644c9-00e9-4349-8b4c-e339800d287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800D1FCD0>]}
[0m17:45:02.351968 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m17:45:02.351968 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:45:02.351968 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:45:02.351968 [info ] [Thread-1 (]: 7 of 7 SKIP relation public.link_mobilite ...................................... [[33mSKIP[0m]
[0m17:45:02.351968 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:45:02.355407 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:02.356412 [debug] [MainThread]: On master: BEGIN
[0m17:45:02.356412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:02.378541 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:45:02.378541 [debug] [MainThread]: On master: COMMIT
[0m17:45:02.378541 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:02.378541 [debug] [MainThread]: On master: COMMIT
[0m17:45:02.378541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:45:02.378541 [debug] [MainThread]: On master: Close
[0m17:45:02.378541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:02.378541 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:45:02.378541 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:45:02.378541 [debug] [MainThread]: Connection 'model.sid_lite.hub_etudiant' was properly closed.
[0m17:45:02.388719 [info ] [MainThread]: 
[0m17:45:02.389060 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:45:02.389787 [debug] [MainThread]: Command end result
[0m17:45:02.495086 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:45:02.498070 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:45:02.502070 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:45:02.502070 [info ] [MainThread]: 
[0m17:45:02.503070 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:45:02.504070 [info ] [MainThread]: 
[0m17:45:02.504070 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:45:02.504070 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:45:02.505071 [info ] [MainThread]: 
[0m17:45:02.505071 [error] [MainThread]: [31mFailure in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)[0m
[0m17:45:02.505071 [error] [MainThread]:   Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « as »
  LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None as hashdiff_mobilite  ...
                                                 ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:45:02.506070 [info ] [MainThread]: 
[0m17:45:02.506070 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:45:02.506070 [info ] [MainThread]: 
[0m17:45:02.506070 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=7
[0m17:45:02.506070 [debug] [MainThread]: Command `dbt run` failed at 17:45:02.506070 after 1.83 seconds
[0m17:45:02.506070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002787DFC8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278008703D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027800870190>]}
[0m17:45:02.506070 [debug] [MainThread]: Flushing usage events
[0m17:45:03.017191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:06.209151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E70EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18C8C8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E787810>]}


============================== 17:47:06.213422 | 4524da88-c7f9-4b6a-a8e8-70a679d8438e ==============================
[0m17:47:06.213422 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:47:06.213422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:06.339349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18C8221D0>]}
[0m17:47:06.373770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D189FEE850>]}
[0m17:47:06.373770 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:47:06.506528 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:47:06.640072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:06.640072 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:47:07.019406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E92C3D0>]}
[0m17:47:07.072859 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:47:07.076442 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:47:07.092716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F0C6850>]}
[0m17:47:07.092716 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:47:07.093714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E930950>]}
[0m17:47:07.094716 [info ] [MainThread]: 
[0m17:47:07.095716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:07.095716 [info ] [MainThread]: 
[0m17:47:07.096715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:07.100715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:47:07.233144 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:47:07.233144 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:47:07.233144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:07.269675 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.036 seconds
[0m17:47:07.272761 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:47:07.275579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:47:07.275579 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:47:07.280915 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:47:07.280915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:07.301483 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:47:07.301483 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:47:07.301483 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:47:07.301483 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m17:47:07.301483 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:47:07.301483 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:47:07.320282 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:07.321281 [debug] [MainThread]: On master: BEGIN
[0m17:47:07.321281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:07.340273 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:47:07.340273 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:07.340273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:07.355116 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:47:07.355116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F2D1810>]}
[0m17:47:07.355116 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:07.355116 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:07.355116 [debug] [MainThread]: On master: BEGIN
[0m17:47:07.355116 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:47:07.355116 [debug] [MainThread]: On master: COMMIT
[0m17:47:07.355116 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:07.355116 [debug] [MainThread]: On master: COMMIT
[0m17:47:07.355116 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:47:07.355116 [debug] [MainThread]: On master: Close
[0m17:47:07.363446 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:47:07.363446 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:47:07.363446 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.sat_mobilite'
[0m17:47:07.363446 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:47:07.375931 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:47:07.376933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F667590>]}
[0m17:47:07.376933 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m17:47:07.376933 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:47:07.376933 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:47:07.376933 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:47:07.376933 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:47:07.376933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.sat_mobilite, now model.sid_lite.stg_etablissement)
[0m17:47:07.376933 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:47:07.376933 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:47:07.376933 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:47:07.396900 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:47:07.396900 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:47:07.406882 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:47:07.406882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:07.435293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:47:07.435293 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:47:07.435293 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:47:07.441179 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:47:07.447030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:47:07.447030 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:47:07.447030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.447030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:47:07.447030 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:47:07.447030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.460961 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:47:07.461961 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:47:07.461961 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:47:07.463924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:47:07.468929 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:47:07.470929 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:47:07.471929 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:47:07.472930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:47:07.475327 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:47:07.476327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18EA25FD0>]}
[0m17:47:07.476327 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:47:07.477327 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:47:07.477327 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:47:07.478327 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:47:07.478327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:47:07.479327 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:47:07.481326 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:47:07.482326 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:47:07.484325 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:47:07.485326 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:47:07.485326 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:47:07.486327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.512499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:47:07.512499 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:47:07.512499 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:47:07.512499 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:47:07.521891 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:47:07.521891 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:47:07.521891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.524489 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:47:07.524489 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:47:07.524489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.524489 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:47:07.524489 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:47:07.524489 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:47:07.524489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:47:07.531472 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:47:07.531472 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:47:07.531472 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:47:07.531472 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:47:07.531472 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:47:07.536046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F7644D0>]}
[0m17:47:07.536046 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:47:07.536046 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:47:07.536046 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:47:07.536046 [info ] [Thread-1 (]: 4 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:47:07.536046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:47:07.536046 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:47:07.541781 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:47:07.541781 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:47:07.541781 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:47:07.541781 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:47:07.541781 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:47:07.541781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.578064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:47:07.579062 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:47:07.579062 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,    -- champ pour Data Vault
    'ERASMUS' as source,
    DECODE(MD5(NULLIF(CONCAT_WS('||',
    COALESCE(NULLIF(UPPER(TRIM(CAST(date_debut AS VARCHAR))), ''), '^^'),
    COALESCE(NULLIF(UPPER(TRIM(CAST(date_fin AS VARCHAR))), ''), '^^'),
    COALESCE(NULLIF(UPPER(TRIM(CAST(type_mobilite AS VARCHAR))), ''), '^^'),
    COALESCE(NULLIF(UPPER(TRIM(CAST(statut_mobilite AS VARCHAR))), ''), '^^')
), '^^||^^||^^||^^')), 'hex') AS None AS hashdiff_mobilite                   -- champ pour Data Vault
from "sid_lite"."public"."mobilite"
  );
[0m17:47:07.580063 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « AS »
LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None AS hashdiff_mobilite  ...
                                               ^

[0m17:47:07.580063 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: ROLLBACK
[0m17:47:07.580063 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:47:07.580063 [debug] [Thread-1 (]: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « AS »
  LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None AS hashdiff_mobilite  ...
                                                 ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:47:07.580063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F7C1C10>]}
[0m17:47:07.585592 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model public.stg_mobilite ....................... [[31mERROR[0m in 0.04s]
[0m17:47:07.585592 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:47:07.585592 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:47:07.585592 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.stg_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « AS »
  LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None AS hashdiff_mobilite  ...
                                                 ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql.
[0m17:47:07.585592 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:47:07.585592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:47:07.585592 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:47:07.597234 [info ] [Thread-1 (]: 17:47:07 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:47:07.630040 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:47:07.630040 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:47:07.641824 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:47:07.641824 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:47:07.641824 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:47:07.641824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.682618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:47:07.682618 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:47:07.683618 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:47:07.687617 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:47:07.693518 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:47:07.693518 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:47:07.694518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.697518 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:47:07.697518 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:47:07.698518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:47:07.699520 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:47:07.699520 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:47:07.700519 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:47:07.702077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:47:07.703083 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:47:07.705082 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:47:07.706082 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:47:07.708081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:47:07.708081 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:47:07.710346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F745FD0>]}
[0m17:47:07.710346 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.12s]
[0m17:47:07.710346 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:47:07.710346 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:47:07.710346 [info ] [Thread-1 (]: 6 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:47:07.710346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:47:07.710346 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:47:07.710346 [info ] [Thread-1 (]: 17:47:07 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:47:07.718000 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:47:07.718907 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:47:07.722686 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:47:07.723688 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:47:07.724197 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:47:07.724197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:07.748874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m17:47:07.748874 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:47:07.748874 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:47:07.757809 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m17:47:07.757809 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:47:07.757809 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:47:07.757809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.757809 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:47:07.757809 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:47:07.757809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:47:07.757809 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:47:07.757809 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:47:07.757809 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:47:07.757809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:47:07.771973 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:47:07.771973 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:47:07.771973 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:47:07.775049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:47:07.776049 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:47:07.776049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4524da88-c7f9-4b6a-a8e8-70a679d8438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F745FD0>]}
[0m17:47:07.777049 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m17:47:07.778049 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:47:07.778049 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:47:07.779048 [info ] [Thread-1 (]: 7 of 7 SKIP relation public.link_mobilite ...................................... [[33mSKIP[0m]
[0m17:47:07.779048 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:47:07.780068 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:07.780068 [debug] [MainThread]: On master: BEGIN
[0m17:47:07.781049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:07.809384 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m17:47:07.810443 [debug] [MainThread]: On master: COMMIT
[0m17:47:07.810443 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:07.811442 [debug] [MainThread]: On master: COMMIT
[0m17:47:07.811442 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:47:07.811442 [debug] [MainThread]: On master: Close
[0m17:47:07.812441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:07.812441 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:47:07.812441 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:47:07.813442 [debug] [MainThread]: Connection 'model.sid_lite.hub_etudiant' was properly closed.
[0m17:47:07.813442 [info ] [MainThread]: 
[0m17:47:07.813442 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m17:47:07.813442 [debug] [MainThread]: Command end result
[0m17:47:07.920386 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:47:07.923845 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:47:07.923845 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:47:07.923845 [info ] [MainThread]: 
[0m17:47:07.923845 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:47:07.923845 [info ] [MainThread]: 
[0m17:47:07.923845 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:47:07.923845 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:47:07.923845 [info ] [MainThread]: 
[0m17:47:07.923845 [error] [MainThread]: [31mFailure in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)[0m
[0m17:47:07.923845 [error] [MainThread]:   Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « AS »
  LINE 25: ), '^^||^^||^^||^^')), 'hex') AS None AS hashdiff_mobilite  ...
                                                 ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:47:07.923845 [info ] [MainThread]: 
[0m17:47:07.923845 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:47:07.923845 [info ] [MainThread]: 
[0m17:47:07.923845 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=7
[0m17:47:07.923845 [debug] [MainThread]: Command `dbt run` failed at 17:47:07.923845 after 1.79 seconds
[0m17:47:07.923845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F0E7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18699F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18C5D5E10>]}
[0m17:47:07.923845 [debug] [MainThread]: Flushing usage events
[0m17:47:08.464200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:44.214135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26B9EE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26B9EF210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26B9EC150>]}


============================== 17:48:44.216141 | 4249f711-8a25-49e9-a861-f4b19d5ee13c ==============================
[0m17:48:44.216141 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:48:44.216141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:44.338996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26AAE9F10>]}
[0m17:48:44.370928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2682AA1D0>]}
[0m17:48:44.386678 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:48:44.508561 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:48:44.637346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:44.637346 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:48:44.980414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26CF0F610>]}
[0m17:48:45.032460 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:48:45.032460 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:48:45.049691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26D358A10>]}
[0m17:48:45.049691 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:48:45.049691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26CF1C550>]}
[0m17:48:45.053604 [info ] [MainThread]: 
[0m17:48:45.053604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:45.053604 [info ] [MainThread]: 
[0m17:48:45.053604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:45.058146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:48:45.150119 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:48:45.150119 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:48:45.151120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:45.179909 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.037 seconds
[0m17:48:45.179909 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:48:45.190402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:48:45.192408 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:48:45.192408 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:48:45.192408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:45.221763 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m17:48:45.221763 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:48:45.221763 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:48:45.221763 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:48:45.221763 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:48:45.221763 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:48:45.234101 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:45.237504 [debug] [MainThread]: On master: BEGIN
[0m17:48:45.237504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:45.257593 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:48:45.257593 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:45.257593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:48:45.269299 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:48:45.269299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26D360D50>]}
[0m17:48:45.269299 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:45.269299 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:45.269299 [debug] [MainThread]: On master: BEGIN
[0m17:48:45.269299 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:48:45.269299 [debug] [MainThread]: On master: COMMIT
[0m17:48:45.269299 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:45.269299 [debug] [MainThread]: On master: COMMIT
[0m17:48:45.269299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:48:45.269299 [debug] [MainThread]: On master: Close
[0m17:48:45.278936 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:48:45.278936 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:48:45.278936 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.sat_mobilite'
[0m17:48:45.278936 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:48:45.285038 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:45.285038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26CEC4C90>]}
[0m17:48:45.285038 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m17:48:45.285038 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:48:45.293211 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:48:45.293837 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:48:45.294551 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:48:45.295933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.sat_mobilite, now model.sid_lite.stg_etablissement)
[0m17:48:45.295933 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:48:45.297930 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:48:45.298933 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:48:45.315252 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:48:45.315252 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:48:45.315252 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:48:45.315252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:45.342983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:48:45.342983 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:48:45.342983 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:48:45.342983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:48:45.359384 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:48:45.359384 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:48:45.359384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.359384 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:48:45.359384 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:48:45.359384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.374659 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:48:45.374659 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:48:45.375672 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:48:45.377422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:48:45.381426 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:48:45.384426 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:48:45.384426 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:48:45.386544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:48:45.387570 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:48:45.388566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26D7B5710>]}
[0m17:48:45.389566 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:48:45.390555 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:48:45.390555 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:48:45.391460 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:48:45.391460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:48:45.391460 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:48:45.394510 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:48:45.395511 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:48:45.397509 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:48:45.398511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:48:45.398511 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:48:45.398511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:45.427719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:48:45.428724 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:48:45.428724 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:48:45.431730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:48:45.431730 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:48:45.431730 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:48:45.431730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.431730 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:48:45.431730 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:48:45.431730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.431730 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:48:45.431730 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:48:45.431730 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:48:45.441204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:48:45.442571 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:48:45.442571 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:48:45.442571 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:48:45.442571 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:48:45.442571 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:48:45.442571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26D7B4090>]}
[0m17:48:45.442571 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:48:45.449356 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:48:45.449356 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:48:45.449356 [info ] [Thread-1 (]: 4 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:48:45.449356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:48:45.449356 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:48:45.449356 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:48:45.449356 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:48:45.449356 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:48:45.457963 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:48:45.457963 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:48:45.457963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:45.481654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m17:48:45.481654 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:48:45.481654 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    encode(
      digest(
        coalesce(cast(date_debut as text),'') || '|' ||
        coalesce(cast(date_fin as text),'') || '|' ||
        coalesce(cast(type_mobilite as text),'') || '|' ||
        coalesce(cast(statut_mobilite as text),''),
        'sha256'
      ),
      'hex'
    ) as hashdiff_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m17:48:45.481654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction digest(text, unknown) n'existe pas
LINE 21:       digest(
               ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m17:48:45.481654 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: ROLLBACK
[0m17:48:45.481654 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:48:45.492282 [debug] [Thread-1 (]: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  la fonction digest(text, unknown) n'existe pas
  LINE 21:       digest(
                 ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:48:45.492282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26DA4B6D0>]}
[0m17:48:45.492282 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model public.stg_mobilite ....................... [[31mERROR[0m in 0.04s]
[0m17:48:45.492282 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:48:45.492282 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:48:45.492282 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.stg_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  la fonction digest(text, unknown) n'existe pas
  LINE 21:       digest(
                 ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql.
[0m17:48:45.492282 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:48:45.492282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:48:45.492282 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:48:45.513506 [info ] [Thread-1 (]: 17:48:45 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:48:45.546052 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:48:45.547057 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:48:45.559045 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:48:45.560012 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:48:45.560012 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:48:45.560012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:45.581806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:48:45.581806 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:48:45.591222 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:48:45.596235 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m17:48:45.602236 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:48:45.602236 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:48:45.603239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.605238 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:48:45.605238 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:48:45.606238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.607238 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:48:45.608150 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:48:45.608150 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:48:45.609720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:48:45.610725 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:48:45.612725 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:48:45.613725 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:48:45.615921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:48:45.616921 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:48:45.616921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26DAA6790>]}
[0m17:48:45.617921 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.12s]
[0m17:48:45.618920 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:48:45.619920 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:48:45.619920 [info ] [Thread-1 (]: 6 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:48:45.619920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:48:45.620922 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:48:45.623920 [info ] [Thread-1 (]: 17:48:45 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:48:45.625999 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:48:45.627051 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:48:45.629075 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:48:45.630073 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:48:45.630073 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:48:45.631074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:45.659239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:48:45.659239 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:48:45.659239 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:48:45.659239 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:48:45.669278 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:48:45.669278 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:48:45.669278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.672793 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:48:45.672793 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:48:45.672793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:45.674668 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:48:45.674668 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:48:45.675635 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:48:45.675635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:48:45.679423 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:48:45.681429 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:48:45.681429 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:48:45.681429 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:48:45.681429 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:48:45.686492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4249f711-8a25-49e9-a861-f4b19d5ee13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26DB36950>]}
[0m17:48:45.686492 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m17:48:45.686492 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:48:45.686492 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:48:45.686492 [info ] [Thread-1 (]: 7 of 7 SKIP relation public.link_mobilite ...................................... [[33mSKIP[0m]
[0m17:48:45.686492 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:48:45.686492 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:45.690557 [debug] [MainThread]: On master: BEGIN
[0m17:48:45.691159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:45.712935 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:48:45.712935 [debug] [MainThread]: On master: COMMIT
[0m17:48:45.712935 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:45.712935 [debug] [MainThread]: On master: COMMIT
[0m17:48:45.712935 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:48:45.712935 [debug] [MainThread]: On master: Close
[0m17:48:45.712935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:45.712935 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:48:45.712935 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:48:45.712935 [debug] [MainThread]: Connection 'model.sid_lite.hub_etudiant' was properly closed.
[0m17:48:45.712935 [info ] [MainThread]: 
[0m17:48:45.712935 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m17:48:45.722827 [debug] [MainThread]: Command end result
[0m17:48:45.831112 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:48:45.834114 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:48:45.838112 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:48:45.838112 [info ] [MainThread]: 
[0m17:48:45.839114 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:48:45.840113 [info ] [MainThread]: 
[0m17:48:45.840113 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:48:45.840113 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:45.841113 [info ] [MainThread]: 
[0m17:48:45.841113 [error] [MainThread]: [31mFailure in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)[0m
[0m17:48:45.841113 [error] [MainThread]:   Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  la fonction digest(text, unknown) n'existe pas
  LINE 21:       digest(
                 ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:48:45.842114 [info ] [MainThread]: 
[0m17:48:45.842114 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:48:45.842114 [info ] [MainThread]: 
[0m17:48:45.842114 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=7
[0m17:48:45.843930 [debug] [MainThread]: Command `dbt run` failed at 17:48:45.842114 after 1.70 seconds
[0m17:48:45.844405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26D490A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26DAFB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26DAF9FD0>]}
[0m17:48:45.844709 [debug] [MainThread]: Flushing usage events
[0m17:48:46.373400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:58.772491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF5F6F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF6FB7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF6FB7990>]}


============================== 17:49:58.772491 | 59ec23a0-1492-4c68-8641-a8cd2eb570e4 ==============================
[0m17:49:58.772491 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:49:58.772491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:58.891031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF5F85950>]}
[0m17:49:58.938585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF281F550>]}
[0m17:49:58.938585 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:49:59.057240 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:49:59.199331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:59.199331 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:49:59.532641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF707DA10>]}
[0m17:49:59.590972 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:49:59.590972 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:49:59.606689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF7593FD0>]}
[0m17:49:59.606689 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:49:59.606689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF71E1290>]}
[0m17:49:59.606689 [info ] [MainThread]: 
[0m17:49:59.606689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:59.606689 [info ] [MainThread]: 
[0m17:49:59.606689 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:49:59.606689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:49:59.709687 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:49:59.709687 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:49:59.709687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.741312 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.035 seconds
[0m17:49:59.741312 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:49:59.741312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:49:59.741312 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:49:59.741312 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:49:59.741312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.773323 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:49:59.773323 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:49:59.773323 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:49:59.788490 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m17:49:59.788490 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:49:59.788490 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:49:59.788490 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:59.788490 [debug] [MainThread]: On master: BEGIN
[0m17:49:59.788490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:59.820438 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m17:49:59.820438 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:59.820438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:59.820438 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:49:59.820438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF30F2990>]}
[0m17:49:59.820438 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:59.820438 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:59.820438 [debug] [MainThread]: On master: BEGIN
[0m17:49:59.820438 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:49:59.820438 [debug] [MainThread]: On master: COMMIT
[0m17:49:59.820438 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:59.820438 [debug] [MainThread]: On master: COMMIT
[0m17:49:59.820438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:49:59.820438 [debug] [MainThread]: On master: Close
[0m17:49:59.836236 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:49:59.836236 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:49:59.836236 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.sat_mobilite'
[0m17:49:59.836236 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:49:59.842850 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:59.848054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF7DC73D0>]}
[0m17:49:59.848054 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m17:49:59.850221 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:49:59.850221 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:49:59.851151 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:49:59.851524 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:49:59.853392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.sat_mobilite, now model.sid_lite.stg_etablissement)
[0m17:49:59.853392 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:49:59.855391 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:49:59.855391 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:49:59.877407 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:49:59.878732 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:49:59.878732 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:49:59.878732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:59.904148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:49:59.904148 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:49:59.908748 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:49:59.909813 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:49:59.916497 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:49:59.916497 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:49:59.916497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:49:59.920679 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:49:59.920679 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:49:59.922683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:49:59.933437 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:49:59.933437 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:49:59.933437 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:49:59.936209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:49:59.940230 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:49:59.942228 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:49:59.943439 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:49:59.944818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:49:59.945847 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:49:59.946828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF7424390>]}
[0m17:49:59.947823 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:49:59.948822 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:49:59.948822 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:49:59.949822 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:49:59.949822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:49:59.949822 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:49:59.952821 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:49:59.953822 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:49:59.955821 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:49:59.956821 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:49:59.956821 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:49:59.957821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:59.982006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:49:59.982006 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:49:59.982006 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:49:59.982006 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:49:59.992257 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:49:59.992257 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:49:59.993288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:49:59.994159 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:49:59.994159 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:49:59.994159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:49:59.994159 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:49:59.994159 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:49:59.994159 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:49:59.994159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:49:59.994159 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:49:59.994159 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:49:59.994159 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:49:59.994159 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:49:59.994159 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:49:59.994159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF7FD0290>]}
[0m17:49:59.994159 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:49:59.994159 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:49:59.994159 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:49:59.994159 [info ] [Thread-1 (]: 4 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:49:59.994159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:49:59.994159 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:50:00.009718 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:50:00.009718 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:50:00.015401 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:50:00.015401 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:50:00.017407 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:50:00.017407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:00.046539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:50:00.047544 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:50:00.047544 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    
CREATE EXTENSION IF NOT EXISTS pgcrypto;

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    encode(
      digest(
        coalesce(cast(date_debut as text),'') || '|' ||
        coalesce(cast(date_fin as text),'') || '|' ||
        coalesce(cast(type_mobilite as text),'') || '|' ||
        coalesce(cast(statut_mobilite as text),''),
        'sha256'
      ),
      'hex'
    ) as hashdiff_mobilite
from "sid_lite"."public"."mobilite"
  );
[0m17:50:00.048544 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « CREATE »
LINE 8: CREATE EXTENSION IF NOT EXISTS pgcrypto;
        ^

[0m17:50:00.048544 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: ROLLBACK
[0m17:50:00.049544 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:50:00.049544 [debug] [Thread-1 (]: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « CREATE »
  LINE 8: CREATE EXTENSION IF NOT EXISTS pgcrypto;
          ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:50:00.049544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF79E6850>]}
[0m17:50:00.049544 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model public.stg_mobilite ....................... [[31mERROR[0m in 0.06s]
[0m17:50:00.049544 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:50:00.049544 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:50:00.049544 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.stg_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « CREATE »
  LINE 8: CREATE EXTENSION IF NOT EXISTS pgcrypto;
          ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql.
[0m17:50:00.049544 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:50:00.049544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:50:00.049544 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:50:00.065711 [info ] [Thread-1 (]: 17:50:00 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:50:00.099024 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:50:00.099024 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:50:00.110427 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:50:00.110427 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:50:00.110427 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:50:00.110427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:00.147119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:50:00.148119 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:50:00.149122 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:50:00.153119 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:50:00.159054 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:50:00.159054 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:50:00.160099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:50:00.162098 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:50:00.162098 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:50:00.163098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:50:00.164099 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:50:00.164099 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:50:00.164099 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:50:00.165486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:50:00.166494 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:50:00.168494 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:50:00.169493 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:50:00.172387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:50:00.172387 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:50:00.173890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF8064050>]}
[0m17:50:00.174895 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.12s]
[0m17:50:00.175898 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:50:00.175898 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:50:00.176896 [info ] [Thread-1 (]: 6 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:50:00.176896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:50:00.176896 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:50:00.176896 [info ] [Thread-1 (]: 17:50:00 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:50:00.183535 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:50:00.183836 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:50:00.186891 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:50:00.187891 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:50:00.187891 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:50:00.187891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:00.210607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:50:00.210607 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:50:00.210607 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:50:00.210607 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:50:00.226461 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:50:00.226919 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:50:00.226919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:50:00.226919 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:50:00.226919 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:50:00.226919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:00.226919 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:50:00.226919 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:50:00.226919 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:50:00.226919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:50:00.226919 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:50:00.226919 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:50:00.226919 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:50:00.226919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:50:00.226919 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:50:00.242022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ec23a0-1492-4c68-8641-a8cd2eb570e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF8099010>]}
[0m17:50:00.243029 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m17:50:00.243029 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:50:00.244032 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:50:00.244032 [info ] [Thread-1 (]: 7 of 7 SKIP relation public.link_mobilite ...................................... [[33mSKIP[0m]
[0m17:50:00.245028 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:50:00.246029 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:00.246029 [debug] [MainThread]: On master: BEGIN
[0m17:50:00.247030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:00.274162 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:50:00.274162 [debug] [MainThread]: On master: COMMIT
[0m17:50:00.275167 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:00.275167 [debug] [MainThread]: On master: COMMIT
[0m17:50:00.275167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:00.276169 [debug] [MainThread]: On master: Close
[0m17:50:00.277187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:00.277187 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:50:00.277187 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:50:00.277864 [debug] [MainThread]: Connection 'model.sid_lite.hub_etudiant' was properly closed.
[0m17:50:00.278187 [info ] [MainThread]: 
[0m17:50:00.278627 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:50:00.280055 [debug] [MainThread]: Command end result
[0m17:50:00.387831 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:50:00.391304 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:50:00.393306 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:50:00.393306 [info ] [MainThread]: 
[0m17:50:00.393306 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:50:00.393306 [info ] [MainThread]: 
[0m17:50:00.393306 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:50:00.393306 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:50:00.393306 [info ] [MainThread]: 
[0m17:50:00.393306 [error] [MainThread]: [31mFailure in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)[0m
[0m17:50:00.393306 [error] [MainThread]:   Database Error in model stg_mobilite (dbt/sid-lite/models\staging\stg_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « CREATE »
  LINE 8: CREATE EXTENSION IF NOT EXISTS pgcrypto;
          ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:50:00.393306 [info ] [MainThread]: 
[0m17:50:00.393306 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:50:00.393306 [info ] [MainThread]: 
[0m17:50:00.402086 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=7
[0m17:50:00.402559 [debug] [MainThread]: Command `dbt run` failed at 17:50:00.402559 after 1.70 seconds
[0m17:50:00.403219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCEF1CFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF7A10250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF7A10CD0>]}
[0m17:50:00.403219 [debug] [MainThread]: Flushing usage events
[0m17:50:00.905854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:05.169329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F418E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F51D7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F51D7910>]}


============================== 17:51:05.169329 | c3384cf2-9bcc-4eef-ae53-068e4380bbd7 ==============================
[0m17:51:05.169329 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:51:05.169329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:51:05.292822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F0A69650>]}
[0m17:51:05.340120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F0A4A010>]}
[0m17:51:05.340120 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:51:05.457846 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:51:05.598130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:05.598130 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m17:51:05.926235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5B54250>]}
[0m17:51:05.973075 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:51:05.973075 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:51:05.988738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5AFB410>]}
[0m17:51:05.988738 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:51:05.988738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5C509D0>]}
[0m17:51:06.004423 [info ] [MainThread]: 
[0m17:51:06.004423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:06.004423 [info ] [MainThread]: 
[0m17:51:06.004423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:06.004423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:51:06.101925 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:51:06.102925 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:51:06.102925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:06.130813 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.036 seconds
[0m17:51:06.130813 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:51:06.130813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:51:06.142478 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:51:06.142478 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:51:06.142478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:06.174453 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m17:51:06.174453 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:51:06.174453 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:51:06.174453 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m17:51:06.174453 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:51:06.174453 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:51:06.184607 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.184607 [debug] [MainThread]: On master: BEGIN
[0m17:51:06.184607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:06.206248 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m17:51:06.206248 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.206248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:06.206248 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:51:06.206248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F2977690>]}
[0m17:51:06.222378 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:06.222378 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.222378 [debug] [MainThread]: On master: BEGIN
[0m17:51:06.222378 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:51:06.222378 [debug] [MainThread]: On master: COMMIT
[0m17:51:06.222378 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.222378 [debug] [MainThread]: On master: COMMIT
[0m17:51:06.222378 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:06.222378 [debug] [MainThread]: On master: Close
[0m17:51:06.226815 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:51:06.226815 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:51:06.226815 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.sat_mobilite'
[0m17:51:06.226815 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:51:06.238194 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:51:06.239114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5C873D0>]}
[0m17:51:06.240259 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m17:51:06.240928 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:51:06.240928 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:51:06.240928 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:51:06.241930 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:51:06.242931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.sat_mobilite, now model.sid_lite.stg_etablissement)
[0m17:51:06.242931 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:51:06.244904 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:51:06.244904 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:51:06.265735 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:51:06.265735 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:51:06.265735 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:51:06.265735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:06.294534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m17:51:06.294534 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:51:06.294534 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:51:06.294534 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:51:06.294534 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:51:06.294534 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:51:06.294534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:06.310542 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:51:06.310542 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:51:06.310542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:51:06.310542 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:51:06.310542 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:51:06.310542 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:51:06.310542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:51:06.330936 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:51:06.333936 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:51:06.333936 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:51:06.336828 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:51:06.338834 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:51:06.339833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F61BD1D0>]}
[0m17:51:06.339833 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:51:06.340834 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:51:06.341834 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:51:06.341834 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:51:06.342834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:51:06.342834 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:51:06.346036 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:51:06.347036 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:51:06.349040 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:51:06.350041 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:51:06.350041 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:51:06.350041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:06.378566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:51:06.379564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:51:06.379564 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:51:06.379564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:51:06.379564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:51:06.379564 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:51:06.379564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:51:06.379564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:51:06.379564 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:51:06.379564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:51:06.379564 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:51:06.379564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:51:06.379564 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:51:06.392769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:51:06.393614 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:51:06.393614 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:51:06.393614 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:51:06.393614 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:51:06.393614 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:51:06.393614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F615C390>]}
[0m17:51:06.393614 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:51:06.393614 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:51:06.393614 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:51:06.393614 [info ] [Thread-1 (]: 4 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:51:06.393614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:51:06.393614 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:51:06.393614 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:51:06.393614 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:51:06.408583 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:51:06.409595 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:51:06.409595 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:51:06.409595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:06.436288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m17:51:06.436288 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:51:06.436288 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m17:51:06.441987 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:51:06.444909 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:51:06.444909 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m17:51:06.446911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:06.448909 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:51:06.448909 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m17:51:06.449915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:51:06.450913 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:51:06.450913 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:51:06.450913 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:51:06.453194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:51:06.455197 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m17:51:06.455197 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:51:06.455197 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m17:51:06.456199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:51:06.457200 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:51:06.458198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5D095D0>]}
[0m17:51:06.458198 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:51:06.459198 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:51:06.460198 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:51:06.460198 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:51:06.461199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:51:06.461199 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:51:06.476934 [info ] [Thread-1 (]: 17:51:06 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:51:06.509578 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:51:06.510588 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:51:06.517404 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:51:06.517404 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:51:06.517404 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:51:06.517404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:06.544988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:51:06.544988 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:51:06.544988 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:51:06.559551 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:51:06.564059 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:51:06.564059 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:51:06.565062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:06.568064 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:51:06.568064 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:51:06.569063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:51:06.570064 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:51:06.570064 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:51:06.570064 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:51:06.572372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:51:06.573377 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:51:06.575390 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:51:06.576376 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:51:06.578378 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:51:06.579377 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:51:06.580383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F6158890>]}
[0m17:51:06.581377 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.12s]
[0m17:51:06.581377 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:51:06.582376 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:51:06.582376 [info ] [Thread-1 (]: 6 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:51:06.583377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:51:06.583377 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:51:06.586376 [info ] [Thread-1 (]: 17:51:06 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:51:06.588376 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:51:06.589376 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:51:06.593053 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:51:06.594233 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:51:06.594233 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:51:06.594233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:06.615920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:51:06.615920 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:51:06.615920 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:51:06.627846 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m17:51:06.627846 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:51:06.627846 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:51:06.627846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:06.637176 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:51:06.637176 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:51:06.637176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:06.637176 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:51:06.637176 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:51:06.637176 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:51:06.640745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:51:06.644153 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:51:06.644153 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:51:06.644153 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:51:06.644153 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:51:06.644153 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:51:06.644153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F62956D0>]}
[0m17:51:06.644153 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m17:51:06.644153 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:51:06.644153 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:51:06.644153 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m17:51:06.644153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m17:51:06.644153 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m17:51:06.644153 [info ] [Thread-1 (]: 17:51:06 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m17:51:06.665951 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m17:51:06.665951 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m17:51:06.683682 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.683682 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp175106683682"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:51:06.683682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:06.710580 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m17:51:06.808636 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.809467 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m17:51:06.811527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:51:06.811527 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.812526 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp175106683682'
        
      order by ordinal_position

  
[0m17:51:06.818541 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m17:51:06.822525 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.822525 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:51:06.824530 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:51:06.826124 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.826124 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:51:06.826124 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:51:06.826124 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m17:51:06.826124 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.826124 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp175106683682"
    )


  
[0m17:51:06.841601 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m17:51:06.842818 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:51:06.842818 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:51:06.843327 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:51:06.845161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:51:06.845161 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m17:51:06.845161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3384cf2-9bcc-4eef-ae53-068e4380bbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5EC6410>]}
[0m17:51:06.845161 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.20s]
[0m17:51:06.845161 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:51:06.845161 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.845161 [debug] [MainThread]: On master: BEGIN
[0m17:51:06.845161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:06.877219 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:51:06.877219 [debug] [MainThread]: On master: COMMIT
[0m17:51:06.877219 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.877219 [debug] [MainThread]: On master: COMMIT
[0m17:51:06.877219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:06.877219 [debug] [MainThread]: On master: Close
[0m17:51:06.877219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:06.877219 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:51:06.877219 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:51:06.877219 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m17:51:06.877219 [info ] [MainThread]: 
[0m17:51:06.877219 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m17:51:06.877219 [debug] [MainThread]: Command end result
[0m17:51:06.898979 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:51:06.911088 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:51:06.915094 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:51:06.916092 [info ] [MainThread]: 
[0m17:51:06.916092 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:51:06.916092 [info ] [MainThread]: 
[0m17:51:06.916092 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:51:06.916092 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:51:06.916092 [info ] [MainThread]: 
[0m17:51:06.916092 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m17:51:06.916092 [debug] [MainThread]: Command `dbt run` failed at 17:51:06.916092 after 1.82 seconds
[0m17:51:06.916092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F3035F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F4077C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F5FF7190>]}
[0m17:51:06.916092 [debug] [MainThread]: Flushing usage events
[0m17:51:07.442163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:11.704076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D1AFF810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D1B3AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D1B3B750>]}


============================== 17:53:11.707670 | 97506592-73c8-45a8-ac77-0a32ca940397 ==============================
[0m17:53:11.707670 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:53:11.708669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:11.827166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D2D72410>]}
[0m17:53:11.874277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CE3BBB90>]}
[0m17:53:11.874277 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:53:11.994167 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:53:12.126700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:12.128711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:12.156243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D31E9E90>]}
[0m17:53:12.271292 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:53:12.273036 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:53:12.291946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D2F4FE50>]}
[0m17:53:12.291946 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:53:12.292950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D01479D0>]}
[0m17:53:12.292950 [info ] [MainThread]: 
[0m17:53:12.292950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:12.292950 [info ] [MainThread]: 
[0m17:53:12.292950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:12.292950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:53:12.395215 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:53:12.395215 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:53:12.396214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:12.431416 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.037 seconds
[0m17:53:12.431416 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:53:12.431416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:53:12.436834 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:53:12.436834 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:53:12.436834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:12.465847 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:53:12.465847 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:53:12.465847 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:53:12.465847 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m17:53:12.465847 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:53:12.465847 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:53:12.478686 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:12.478686 [debug] [MainThread]: On master: BEGIN
[0m17:53:12.478686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:12.508800 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:53:12.510270 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:12.510270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:12.510917 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:53:12.510917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D3049810>]}
[0m17:53:12.510917 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:12.510917 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:12.510917 [debug] [MainThread]: On master: BEGIN
[0m17:53:12.510917 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:53:12.510917 [debug] [MainThread]: On master: COMMIT
[0m17:53:12.510917 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:12.510917 [debug] [MainThread]: On master: COMMIT
[0m17:53:12.510917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:12.510917 [debug] [MainThread]: On master: Close
[0m17:53:12.510917 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:53:12.510917 [info ] [Thread-1 (]: 1 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:53:12.510917 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.sat_mobilite'
[0m17:53:12.510917 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:53:12.525914 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:53:12.525914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D3623CD0>]}
[0m17:53:12.525914 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m17:53:12.536146 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:53:12.536620 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:53:12.536929 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:53:12.537309 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:53:12.537731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.sat_mobilite, now model.sid_lite.stg_etablissement)
[0m17:53:12.538762 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:53:12.540761 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:53:12.541764 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:53:12.561953 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:53:12.562817 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:53:12.563847 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:53:12.563847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:12.592094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:53:12.594213 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:53:12.594213 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:53:12.595221 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:53:12.595221 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:53:12.595221 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:53:12.595221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:12.595221 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:53:12.595221 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:53:12.595221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:53:12.618017 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:53:12.619018 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:53:12.619018 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:53:12.621301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:53:12.625323 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:53:12.627914 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:53:12.627914 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:53:12.629989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:53:12.631988 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:53:12.632989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D31259D0>]}
[0m17:53:12.633992 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:53:12.633992 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:53:12.634992 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:53:12.634992 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:53:12.635989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:53:12.635989 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:53:12.638988 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:53:12.639989 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:53:12.641988 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:53:12.642795 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:53:12.642795 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:53:12.643835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:12.667518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m17:53:12.667518 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:53:12.667518 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:53:12.667518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:53:12.667518 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:53:12.677573 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:53:12.677573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:12.679174 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:53:12.679174 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:53:12.679174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:53:12.679174 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:53:12.679174 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:53:12.679174 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:53:12.679174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:53:12.679174 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:53:12.679174 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:53:12.679174 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:53:12.679174 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:53:12.679174 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:53:12.679174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D384F9D0>]}
[0m17:53:12.692013 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:53:12.692013 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:53:12.692013 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:53:12.694176 [info ] [Thread-1 (]: 4 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:53:12.695165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:53:12.695165 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:53:12.695165 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:53:12.695165 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:53:12.695165 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:53:12.695165 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:53:12.695165 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:53:12.695165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:12.733478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:53:12.734478 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:53:12.734478 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m17:53:12.734478 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:53:12.734478 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:53:12.734478 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m17:53:12.734478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:12.734478 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:53:12.744260 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m17:53:12.744260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:53:12.745895 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:53:12.745895 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:53:12.745895 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:53:12.745895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:53:12.745895 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m17:53:12.745895 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:53:12.745895 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m17:53:12.745895 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:53:12.745895 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:53:12.745895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D3803350>]}
[0m17:53:12.745895 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:53:12.745895 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:53:12.745895 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:53:12.745895 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:53:12.745895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:53:12.745895 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:53:12.767742 [info ] [Thread-1 (]: 17:53:12 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:53:12.800875 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:53:12.800875 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:53:12.812425 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:53:12.812425 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:53:12.812425 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:53:12.812425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:12.848308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:53:12.849308 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:53:12.849308 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:53:12.854312 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:53:12.859307 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:53:12.859307 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:53:12.860307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:12.862367 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:53:12.862367 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:53:12.863369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:53:12.864366 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:53:12.864366 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:53:12.864366 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:53:12.866833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:53:12.867842 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:53:12.869841 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:53:12.870840 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:53:12.873687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:53:12.873687 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:53:12.874690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D32C83D0>]}
[0m17:53:12.875689 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.13s]
[0m17:53:12.876687 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:53:12.876687 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:53:12.877695 [info ] [Thread-1 (]: 6 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:53:12.877695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:53:12.877695 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:53:12.878691 [info ] [Thread-1 (]: 17:53:12 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:53:12.884051 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:53:12.884490 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:53:12.888511 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:53:12.888511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:53:12.888511 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:53:12.888511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:12.913045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:53:12.913045 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:53:12.913045 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:53:12.913045 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:53:12.927664 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:53:12.928674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:53:12.928674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:12.928674 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:53:12.928674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:53:12.928674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:12.928674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:53:12.928674 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:53:12.928674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:53:12.928674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:53:12.928674 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:53:12.928674 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:53:12.928674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:53:12.928674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:53:12.928674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:53:12.928674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D3588FD0>]}
[0m17:53:12.944639 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.05s]
[0m17:53:12.944639 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:53:12.945673 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:53:12.945673 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m17:53:12.946670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m17:53:12.946670 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m17:53:12.952669 [info ] [Thread-1 (]: 17:53:12 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m17:53:12.964269 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m17:53:12.965269 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m17:53:12.979024 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:12.979024 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp175312979024"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:53:12.979024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:13.016852 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m17:53:13.025854 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:13.026856 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m17:53:13.028610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:53:13.028610 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:13.029613 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp175312979024'
        
      order by ordinal_position

  
[0m17:53:13.035293 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m17:53:13.040293 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:13.040293 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:53:13.042293 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:53:13.044290 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:13.044290 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:53:13.044290 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:53:13.056208 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m17:53:13.056208 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:13.058212 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp175312979024"
    )


  
[0m17:53:13.058212 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m17:53:13.059217 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:53:13.059217 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:53:13.061222 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:53:13.061222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:53:13.061222 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m17:53:13.061222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97506592-73c8-45a8-ac77-0a32ca940397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D31382D0>]}
[0m17:53:13.065397 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m17:53:13.065397 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:53:13.065397 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:13.065397 [debug] [MainThread]: On master: BEGIN
[0m17:53:13.065397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:13.095399 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:53:13.096394 [debug] [MainThread]: On master: COMMIT
[0m17:53:13.096394 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:13.096394 [debug] [MainThread]: On master: COMMIT
[0m17:53:13.096394 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:13.097394 [debug] [MainThread]: On master: Close
[0m17:53:13.098397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:13.098397 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:53:13.098397 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:53:13.098397 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m17:53:13.099395 [info ] [MainThread]: 
[0m17:53:13.099395 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m17:53:13.100396 [debug] [MainThread]: Command end result
[0m17:53:13.124442 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:53:13.128792 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:53:13.132551 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:53:13.132551 [info ] [MainThread]: 
[0m17:53:13.132551 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:53:13.132551 [info ] [MainThread]: 
[0m17:53:13.132551 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:53:13.132551 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:53:13.132551 [info ] [MainThread]: 
[0m17:53:13.132551 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m17:53:13.132551 [debug] [MainThread]: Command `dbt run` failed at 17:53:13.132551 after 1.50 seconds
[0m17:53:13.132551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D2B472D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D18AF410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221D02FF010>]}
[0m17:53:13.132551 [debug] [MainThread]: Flushing usage events
[0m17:53:13.702619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:41.120241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A167DE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A15F995D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A16820ED0>]}


============================== 17:53:41.120241 | 95e26197-05a3-44e3-933b-b3238b94e590 ==============================
[0m17:53:41.120241 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:53:41.120241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:41.246504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e26197-05a3-44e3-933b-b3238b94e590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A179A4790>]}
[0m17:53:41.289049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e26197-05a3-44e3-933b-b3238b94e590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A1308E0D0>]}
[0m17:53:41.289049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:53:41.409948 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:53:41.536485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:41.536485 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m17:53:41.727987 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  macro 'dbt_macro__sat' takes no keyword argument 'src_sat_columns'
[0m17:53:41.743254 [debug] [MainThread]: Command `dbt run` failed at 17:53:41.743254 after 0.69 seconds
[0m17:53:41.743254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A17AE1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A17AA5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A17AA78D0>]}
[0m17:53:41.743254 [debug] [MainThread]: Flushing usage events
[0m17:53:42.190518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:50.207001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C83F9E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C83F9F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C83F9EE10>]}


============================== 17:59:50.207001 | e77027f7-b264-467e-8a7e-e13618f5ed34 ==============================
[0m17:59:50.207001 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:59:50.222754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:59:50.346765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C830922D0>]}
[0m17:59:50.378319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8090A450>]}
[0m17:59:50.378319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:59:50.498462 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:59:50.639772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:50.639772 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m17:59:50.934773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85636290>]}
[0m17:59:50.986508 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:59:50.988252 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:59:51.003890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85439090>]}
[0m17:59:51.003890 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m17:59:51.006404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85626AD0>]}
[0m17:59:51.006404 [info ] [MainThread]: 
[0m17:59:51.006404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:51.006404 [info ] [MainThread]: 
[0m17:59:51.006404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:51.006404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m17:59:51.109602 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m17:59:51.109602 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m17:59:51.109602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:51.132647 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.035 seconds
[0m17:59:51.146462 [debug] [ThreadPool]: On list_sid_lite: Close
[0m17:59:51.146462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m17:59:51.146462 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:59:51.146462 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m17:59:51.146462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:51.178233 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:59:51.178233 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m17:59:51.178233 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:59:51.178233 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m17:59:51.178233 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m17:59:51.178233 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m17:59:51.178233 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:51.178233 [debug] [MainThread]: On master: BEGIN
[0m17:59:51.178233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:51.209642 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:59:51.209642 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:51.209642 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:51.225354 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m17:59:51.225354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C854824D0>]}
[0m17:59:51.225354 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:51.225354 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:51.225354 [debug] [MainThread]: On master: BEGIN
[0m17:59:51.225354 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:59:51.225354 [debug] [MainThread]: On master: COMMIT
[0m17:59:51.225354 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:51.225354 [debug] [MainThread]: On master: COMMIT
[0m17:59:51.225354 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:51.225354 [debug] [MainThread]: On master: Close
[0m17:59:51.225354 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m17:59:51.225354 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m17:59:51.225354 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m17:59:51.225354 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m17:59:51.240446 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m17:59:51.240446 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m17:59:51.249422 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m17:59:51.261097 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:59:51.261097 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m17:59:51.261097 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:51.290428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:59:51.291426 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:59:51.291426 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m17:59:51.294426 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:59:51.298427 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:59:51.299427 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m17:59:51.299427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:51.302240 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:59:51.302240 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m17:59:51.302240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:51.311216 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:59:51.311216 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:59:51.311216 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m17:59:51.311216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:59:51.317542 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m17:59:51.319546 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m17:59:51.321551 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m17:59:51.321551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:59:51.321551 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m17:59:51.324662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8567BF50>]}
[0m17:59:51.324662 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:51.324662 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m17:59:51.324662 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m17:59:51.324662 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m17:59:51.324662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m17:59:51.324662 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m17:59:51.331588 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m17:59:51.331588 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m17:59:51.331588 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m17:59:51.331588 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:59:51.331588 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m17:59:51.331588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:51.364925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m17:59:51.364925 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:59:51.365924 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m17:59:51.369043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:59:51.370042 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:59:51.370042 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m17:59:51.370042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:51.370042 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:59:51.370042 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m17:59:51.370042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:51.370042 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:59:51.378746 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:59:51.378746 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m17:59:51.378746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:59:51.382511 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m17:59:51.382511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m17:59:51.382511 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m17:59:51.382511 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:59:51.382511 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m17:59:51.386763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85D85010>]}
[0m17:59:51.386763 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:59:51.386763 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m17:59:51.386763 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m17:59:51.386763 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m17:59:51.386763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m17:59:51.386763 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m17:59:51.386763 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m17:59:51.386763 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m17:59:51.386763 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m17:59:51.386763 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:59:51.386763 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m17:59:51.386763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:51.421550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:59:51.421550 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:59:51.421550 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m17:59:51.421550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:59:51.432804 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:59:51.432804 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m17:59:51.432804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:51.438307 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:59:51.438307 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m17:59:51.438307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:51.438307 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:59:51.438307 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:59:51.438307 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m17:59:51.441212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:59:51.444605 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m17:59:51.444605 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m17:59:51.444605 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m17:59:51.444605 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:59:51.447825 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m17:59:51.448723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85C32810>]}
[0m17:59:51.449172 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:59:51.449172 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m17:59:51.449172 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m17:59:51.449172 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m17:59:51.449172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m17:59:51.449172 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m17:59:51.461328 [info ] [Thread-1 (]: 17:59:51 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m17:59:51.470611 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m17:59:51.470611 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m17:59:51.486870 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m17:59:51.487870 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:59:51.488871 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m17:59:51.488871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:51.515759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m17:59:51.515759 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:59:51.515759 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:59:51.515759 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m17:59:51.532545 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:59:51.532545 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m17:59:51.532545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:51.537032 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:59:51.537032 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m17:59:51.539036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:51.539036 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:59:51.539036 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:59:51.539036 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m17:59:51.541437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:59:51.544422 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m17:59:51.544422 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m17:59:51.546428 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m17:59:51.548646 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:59:51.549651 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m17:59:51.550651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C8567AE50>]}
[0m17:59:51.551651 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m17:59:51.551651 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m17:59:51.552650 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m17:59:51.552650 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m17:59:51.553650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m17:59:51.553650 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m17:59:51.556650 [info ] [Thread-1 (]: 17:59:51 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m17:59:51.559844 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m17:59:51.559844 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m17:59:51.563378 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m17:59:51.563378 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:59:51.564380 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m17:59:51.564380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:51.587700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m17:59:51.587700 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:59:51.587700 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:59:51.587700 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m17:59:51.599563 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:59:51.599563 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m17:59:51.599563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:51.605031 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:59:51.605031 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m17:59:51.605031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:51.605031 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:59:51.605031 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:59:51.605031 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m17:59:51.608679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:59:51.611694 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m17:59:51.611694 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m17:59:51.611694 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m17:59:51.611694 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:59:51.615368 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m17:59:51.616375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85D54310>]}
[0m17:59:51.616375 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m17:59:51.617373 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m17:59:51.617373 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m17:59:51.618373 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m17:59:51.618373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m17:59:51.618373 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m17:59:51.625373 [info ] [Thread-1 (]: 17:59:51 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m17:59:51.633318 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m17:59:51.633318 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m17:59:51.655285 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.655285 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp175951653285"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:59:51.655285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:51.691142 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m17:59:51.700124 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.700124 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m17:59:51.701528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:59:51.702534 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.702534 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp175951653285'
        
      order by ordinal_position

  
[0m17:59:51.708774 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m17:59:51.712776 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.712776 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:59:51.715780 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:59:51.716780 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.716780 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:59:51.716780 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:59:51.716780 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m17:59:51.716780 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.716780 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp175951653285"
    )


  
[0m17:59:51.716780 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m17:59:51.716780 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:59:51.716780 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m17:59:51.732668 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m17:59:51.732668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:59:51.732668 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m17:59:51.732668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C85EA6310>]}
[0m17:59:51.732668 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m17:59:51.732668 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m17:59:51.732668 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m17:59:51.732668 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m17:59:51.732668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m17:59:51.732668 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m17:59:51.752504 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m17:59:51.753552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77027f7-b264-467e-8a7e-e13618f5ed34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C837A9010>]}
[0m17:59:51.753552 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.02s]
[0m17:59:51.754553 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m17:59:51.755551 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql).
[0m17:59:51.756550 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:51.756550 [debug] [MainThread]: On master: BEGIN
[0m17:59:51.756550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:51.786252 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m17:59:51.787253 [debug] [MainThread]: On master: COMMIT
[0m17:59:51.787253 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:51.787253 [debug] [MainThread]: On master: COMMIT
[0m17:59:51.788253 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:51.788253 [debug] [MainThread]: On master: Close
[0m17:59:51.789257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:51.789257 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m17:59:51.789257 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m17:59:51.789257 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m17:59:51.789257 [info ] [MainThread]: 
[0m17:59:51.789257 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:59:51.789257 [debug] [MainThread]: Command end result
[0m17:59:51.815471 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m17:59:51.818538 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m17:59:51.822541 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m17:59:51.822541 [info ] [MainThread]: 
[0m17:59:51.822541 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:59:51.822541 [info ] [MainThread]: 
[0m17:59:51.822541 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m17:59:51.822541 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m17:59:51.822541 [info ] [MainThread]: 
[0m17:59:51.822541 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m17:59:51.822541 [debug] [MainThread]: Command `dbt run` failed at 17:59:51.822541 after 1.68 seconds
[0m17:59:51.822541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C83D4F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C83D4F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C83FA4A90>]}
[0m17:59:51.822541 [debug] [MainThread]: Flushing usage events
[0m17:59:52.350982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:51.394934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4E34C510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4E38E610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4E38EA90>]}


============================== 18:06:51.394934 | 4ebe5fd9-fd4c-4d30-83f6-fb6368395851 ==============================
[0m18:06:51.394934 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:06:51.406230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:51.518212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F555F10>]}
[0m18:06:51.565228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4AC0AE10>]}
[0m18:06:51.565228 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:06:51.684874 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:06:51.834026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:51.834026 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:06:52.119398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4ACFA050>]}
[0m18:06:52.182497 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:06:52.182497 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:06:52.198136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F80E950>]}
[0m18:06:52.198136 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:06:52.198136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F9B7910>]}
[0m18:06:52.206872 [info ] [MainThread]: 
[0m18:06:52.206872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:52.206872 [info ] [MainThread]: 
[0m18:06:52.206872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:52.206872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:06:52.305400 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:06:52.306903 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:06:52.306903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:52.337655 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.037 seconds
[0m18:06:52.337655 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:06:52.337655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:06:52.337655 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:06:52.337655 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:06:52.337655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:52.369748 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:06:52.369748 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:06:52.369748 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:06:52.385828 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m18:06:52.385828 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:06:52.385828 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:06:52.385828 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:52.385828 [debug] [MainThread]: On master: BEGIN
[0m18:06:52.385828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:52.417525 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:06:52.417525 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:52.417525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:52.417525 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:06:52.417525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FFA16D0>]}
[0m18:06:52.417525 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:52.417525 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:52.417525 [debug] [MainThread]: On master: BEGIN
[0m18:06:52.417525 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:06:52.417525 [debug] [MainThread]: On master: COMMIT
[0m18:06:52.417525 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:52.417525 [debug] [MainThread]: On master: COMMIT
[0m18:06:52.433186 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:52.433186 [debug] [MainThread]: On master: Close
[0m18:06:52.433186 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:06:52.433186 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:06:52.433186 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:06:52.433186 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:06:52.439100 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:06:52.439100 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:06:52.461149 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:06:52.463148 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:06:52.463148 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:06:52.463148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:52.493249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:06:52.494247 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:06:52.494247 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:06:52.497248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:06:52.502246 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:06:52.502246 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:06:52.503248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:52.504250 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:06:52.504250 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:06:52.504250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:52.506813 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:06:52.506813 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:06:52.506813 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:06:52.506813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:06:52.520311 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:06:52.520311 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:06:52.520311 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:06:52.520311 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:06:52.520311 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:06:52.520311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F651A90>]}
[0m18:06:52.520311 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:06:52.520311 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:06:52.520311 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:06:52.520311 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:06:52.520311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:06:52.520311 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:06:52.536072 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:06:52.536072 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:06:52.536072 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:06:52.536072 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:06:52.536072 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:06:52.536072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:52.568257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:06:52.569257 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:06:52.569257 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:06:52.574309 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:06:52.576965 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:06:52.576965 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:06:52.578970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:06:52.578970 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:06:52.578970 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:06:52.578970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:52.578970 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:06:52.578970 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:06:52.578970 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:06:52.578970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:06:52.586727 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:06:52.587237 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:06:52.587237 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:06:52.587237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:06:52.587237 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:06:52.587237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50105310>]}
[0m18:06:52.587237 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:06:52.587237 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:06:52.587237 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:06:52.592843 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:06:52.592843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:06:52.592843 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:06:52.594848 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:06:52.596852 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:06:52.598854 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:06:52.600856 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:06:52.600856 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:06:52.600856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:52.626472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:06:52.626472 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:06:52.626472 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m18:06:52.626472 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:06:52.626472 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:06:52.626472 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:06:52.637633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:06:52.637633 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:06:52.637633 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:06:52.637633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:52.637633 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:06:52.637633 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:06:52.637633 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:06:52.637633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:06:52.637633 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:06:52.637633 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:06:52.637633 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:06:52.637633 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:06:52.637633 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:06:52.637633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A501C4150>]}
[0m18:06:52.637633 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:06:52.637633 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:06:52.637633 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:06:52.637633 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:06:52.652972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:06:52.652972 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:06:52.654123 [info ] [Thread-1 (]: 18:06:52 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:06:52.671985 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:06:52.671985 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:06:52.690094 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:06:52.691591 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:06:52.691591 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:06:52.691591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:52.724028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:06:52.724028 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:06:52.724028 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:06:52.724028 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:06:52.737477 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:06:52.737477 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:06:52.737477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:52.741298 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:06:52.741298 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:06:52.741298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:06:52.741298 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:06:52.741298 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:06:52.741298 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:06:52.741298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:06:52.748562 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:06:52.750568 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:06:52.750568 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:06:52.753459 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:06:52.754465 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:06:52.754465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50152F90>]}
[0m18:06:52.755466 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m18:06:52.756463 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:06:52.756463 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:06:52.757464 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:06:52.757464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:06:52.757464 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:06:52.761463 [info ] [Thread-1 (]: 18:06:52 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:06:52.762464 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:06:52.763465 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:06:52.766020 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:06:52.767019 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:06:52.767019 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:06:52.767019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:52.792659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:06:52.792659 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:06:52.792659 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:06:52.792659 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:06:52.804593 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:06:52.804593 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:06:52.804593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:52.807271 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:06:52.807271 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:06:52.807271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:06:52.807271 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:06:52.812641 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:06:52.812641 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:06:52.812641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:06:52.816429 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:06:52.816429 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:06:52.816429 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:06:52.816429 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:06:52.820106 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:06:52.821113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A501D1190>]}
[0m18:06:52.822111 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:06:52.823111 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:06:52.823111 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:06:52.823111 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:06:52.824116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:06:52.824116 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:06:52.830111 [info ] [Thread-1 (]: 18:06:52 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:06:52.838249 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:06:52.838249 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:06:52.859573 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.860577 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp180652856574"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:06:52.860577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:52.887858 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m18:06:52.903605 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.904633 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:06:52.905618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:06:52.905618 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.907124 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp180652856574'
        
      order by ordinal_position

  
[0m18:06:52.913289 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:06:52.918290 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.918290 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:06:52.920289 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:06:52.925339 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.926341 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:06:52.928338 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:06:52.934341 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:06:52.935341 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.935341 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp180652856574"
    )


  
[0m18:06:52.936342 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m18:06:52.937342 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:06:52.937342 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:06:52.937342 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:06:52.939406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:06:52.939406 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:06:52.939406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50135C90>]}
[0m18:06:52.939406 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.12s]
[0m18:06:52.939406 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:06:52.939406 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:06:52.939406 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:06:52.939406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:06:52.939406 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:06:52.957293 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:06:52.958293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ebe5fd9-fd4c-4d30-83f6-fb6368395851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50255B50>]}
[0m18:06:52.958293 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.02s]
[0m18:06:52.959640 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:06:52.960016 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql).
[0m18:06:52.961258 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:52.962243 [debug] [MainThread]: On master: BEGIN
[0m18:06:52.963243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:52.993821 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:06:52.993821 [debug] [MainThread]: On master: COMMIT
[0m18:06:52.993821 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:52.993821 [debug] [MainThread]: On master: COMMIT
[0m18:06:52.993821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:52.993821 [debug] [MainThread]: On master: Close
[0m18:06:52.993821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:52.993821 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:06:52.993821 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:06:52.993821 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:06:52.993821 [info ] [MainThread]: 
[0m18:06:52.993821 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:06:52.993821 [debug] [MainThread]: Command end result
[0m18:06:53.021540 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:06:53.021540 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:06:53.021540 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:06:53.021540 [info ] [MainThread]: 
[0m18:06:53.021540 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:06:53.032086 [info ] [MainThread]: 
[0m18:06:53.033091 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:06:53.033091 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:06:53.033091 [info ] [MainThread]: 
[0m18:06:53.034091 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:06:53.034091 [debug] [MainThread]: Command `dbt run` failed at 18:06:53.034091 after 1.70 seconds
[0m18:06:53.035091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FEDF510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4DC2AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4E34C510>]}
[0m18:06:53.035091 [debug] [MainThread]: Flushing usage events
[0m18:06:53.535942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:18.652859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832B72910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832B67850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832BA85D0>]}


============================== 18:07:18.652859 | 76c109e0-62ea-403c-8154-d6d595239f80 ==============================
[0m18:07:18.652859 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:07:18.652859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:18.770768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832C46410>]}
[0m18:07:18.817917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E82E44E050>]}
[0m18:07:18.817917 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:07:18.935944 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:07:19.073149 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m18:07:19.073149 [debug] [MainThread]: Partial parsing: deleted file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:07:19.122060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832FEF5D0>]}
[0m18:07:19.233774 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:07:19.235526 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:07:19.251243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8330A35D0>]}
[0m18:07:19.251243 [info ] [MainThread]: Found 6 models, 3 seeds, 12 data tests, 821 macros
[0m18:07:19.251243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832EA1410>]}
[0m18:07:19.251243 [info ] [MainThread]: 
[0m18:07:19.251243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:19.251243 [info ] [MainThread]: 
[0m18:07:19.251243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:19.251243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:07:19.354235 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:07:19.354235 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:07:19.354235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:19.394331 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.037 seconds
[0m18:07:19.396333 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:07:19.398330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:07:19.403330 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:07:19.403701 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:07:19.403701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:19.423580 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:07:19.423580 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:07:19.423580 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:07:19.437010 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m18:07:19.437010 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:07:19.437010 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:07:19.443531 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:19.443531 [debug] [MainThread]: On master: BEGIN
[0m18:07:19.443531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:19.466717 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:07:19.466717 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:19.466717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:19.466717 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:07:19.466717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832D45810>]}
[0m18:07:19.466717 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:19.466717 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:19.482570 [debug] [MainThread]: On master: BEGIN
[0m18:07:19.482570 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:07:19.482570 [debug] [MainThread]: On master: COMMIT
[0m18:07:19.482570 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:19.482570 [debug] [MainThread]: On master: COMMIT
[0m18:07:19.482570 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:07:19.482570 [debug] [MainThread]: On master: Close
[0m18:07:19.487046 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:07:19.487046 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:07:19.487046 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:07:19.487046 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:07:19.487046 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:07:19.487046 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:07:19.504721 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:07:19.504721 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:07:19.504721 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:07:19.504721 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:19.545323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:07:19.546323 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:07:19.546323 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:07:19.549324 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:07:19.553829 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:07:19.553829 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:07:19.554832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:07:19.554832 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:07:19.554832 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:07:19.554832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:07:19.554832 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:07:19.554832 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:07:19.554832 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:07:19.554832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:07:19.570577 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:07:19.570577 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:07:19.570577 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:07:19.570577 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:07:19.570577 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:07:19.570577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83369BED0>]}
[0m18:07:19.570577 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:07:19.582216 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:07:19.582216 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:07:19.582216 [info ] [Thread-1 (]: 2 of 6 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:07:19.582216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:07:19.582216 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:07:19.586510 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:07:19.586510 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:07:19.586510 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:07:19.586510 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:07:19.586510 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:07:19.586510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:19.621530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:07:19.622443 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:07:19.622443 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:07:19.624498 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:07:19.624498 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:07:19.624498 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:07:19.624498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:07:19.624498 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:07:19.624498 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:07:19.624498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:07:19.624498 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:07:19.624498 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:07:19.624498 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:07:19.624498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:07:19.637043 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:07:19.637043 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:07:19.637043 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:07:19.637043 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:07:19.637043 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:07:19.637043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E833038950>]}
[0m18:07:19.637043 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:07:19.644020 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:07:19.644020 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:07:19.644020 [info ] [Thread-1 (]: 3 of 6 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:07:19.644020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:07:19.644020 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:07:19.644020 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:07:19.644020 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:07:19.644020 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:07:19.651274 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:07:19.651274 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:07:19.651274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:19.676486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:07:19.676486 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:07:19.676486 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m18:07:19.676486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:07:19.676486 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:07:19.687190 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:07:19.688078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:07:19.688078 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:07:19.688078 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:07:19.688078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:07:19.688078 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:07:19.688078 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:07:19.688078 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:07:19.688078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:07:19.688078 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:07:19.688078 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:07:19.688078 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:07:19.688078 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:07:19.688078 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:07:19.688078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E833870E50>]}
[0m18:07:19.688078 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:07:19.703053 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:07:19.703053 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:07:19.703721 [info ] [Thread-1 (]: 4 of 6 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:07:19.704291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:07:19.704291 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:07:19.721819 [info ] [Thread-1 (]: 18:07:19 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:07:19.753793 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:07:19.754800 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:07:19.761042 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:07:19.761042 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:07:19.761042 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:07:19.761042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:19.788129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:07:19.788129 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:07:19.788129 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:07:19.802472 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:07:19.807863 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:07:19.807863 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:07:19.808862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:07:19.811861 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:07:19.812862 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:07:19.812862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:07:19.813866 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:07:19.813866 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:07:19.814861 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:07:19.816349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:07:19.817357 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:07:19.819357 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:07:19.820356 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:07:19.822674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:07:19.823677 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:07:19.824677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832B73090>]}
[0m18:07:19.824677 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.12s]
[0m18:07:19.825674 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:07:19.825674 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:07:19.826674 [info ] [Thread-1 (]: 5 of 6 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:07:19.826674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:07:19.827673 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:07:19.830672 [info ] [Thread-1 (]: 18:07:19 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:07:19.832673 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:07:19.832673 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:07:19.835674 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:07:19.836674 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:07:19.836674 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:07:19.837090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:19.855145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:07:19.855145 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:07:19.855145 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:07:19.870462 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:07:19.871541 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:07:19.871541 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:07:19.871541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:07:19.871541 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:07:19.871541 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:07:19.871541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:07:19.871541 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:07:19.871541 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:07:19.871541 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:07:19.871541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:07:19.871541 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:07:19.871541 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:07:19.871541 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:07:19.888237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:07:19.889239 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:07:19.890237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83390C2D0>]}
[0m18:07:19.890237 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:07:19.891237 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:07:19.891237 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:07:19.892236 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:07:19.892236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:07:19.893237 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:07:19.898236 [info ] [Thread-1 (]: 18:07:19 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:07:19.905306 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:07:19.905306 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:07:19.926865 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:19.926865 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp180719925865"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:07:19.926865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:19.954825 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:07:19.972532 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:19.972532 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:07:19.974523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:07:19.975518 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:19.975518 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp180719925865'
        
      order by ordinal_position

  
[0m18:07:19.981516 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:07:19.985516 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:19.985516 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:07:19.988425 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:07:19.993424 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:19.993424 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:07:19.996424 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:07:20.002424 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:07:20.003424 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:20.004424 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp180719925865"
    )


  
[0m18:07:20.004424 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:07:20.005928 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:07:20.005928 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:07:20.005928 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:07:20.005928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:07:20.005928 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:07:20.005928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76c109e0-62ea-403c-8154-d6d595239f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83393C5D0>]}
[0m18:07:20.005928 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m18:07:20.005928 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:07:20.005928 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:20.005928 [debug] [MainThread]: On master: BEGIN
[0m18:07:20.005928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:20.038282 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:07:20.038282 [debug] [MainThread]: On master: COMMIT
[0m18:07:20.038282 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:20.038282 [debug] [MainThread]: On master: COMMIT
[0m18:07:20.038282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:07:20.038282 [debug] [MainThread]: On master: Close
[0m18:07:20.038282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:20.038282 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:07:20.038282 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:07:20.038282 [debug] [MainThread]: Connection 'model.sid_lite.link_mobilite' was properly closed.
[0m18:07:20.038282 [info ] [MainThread]: 
[0m18:07:20.038282 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:07:20.038282 [debug] [MainThread]: Command end result
[0m18:07:20.059832 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:07:20.073263 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:07:20.077267 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:07:20.077267 [info ] [MainThread]: 
[0m18:07:20.077267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:20.077267 [info ] [MainThread]: 
[0m18:07:20.077267 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m18:07:20.077267 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:20.077267 after 1.49 seconds
[0m18:07:20.077267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832BF3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E832BF3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E82AE1FE90>]}
[0m18:07:20.077267 [debug] [MainThread]: Flushing usage events
[0m18:07:20.602266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:06.789386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAB65EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAB69E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAB69CE50>]}


============================== 18:08:06.789386 | 479b6ae1-3950-4180-b57d-80fa43a60b9a ==============================
[0m18:08:06.789386 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:08:06.789386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:06.918106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAADF7B10>]}
[0m18:08:06.954187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA7F1B050>]}
[0m18:08:06.954187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:08:07.079921 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:08:07.214009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:08:07.214009 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:08:07.501688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAA6AA810>]}
[0m18:08:07.549219 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:08:07.564924 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:08:07.580187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DACC95290>]}
[0m18:08:07.580187 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:08:07.580187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DACCC4150>]}
[0m18:08:07.580187 [info ] [MainThread]: 
[0m18:08:07.580187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:07.580187 [info ] [MainThread]: 
[0m18:08:07.580187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:07.580187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:08:07.670511 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:08:07.670511 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:08:07.670511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:07.817034 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.148 seconds
[0m18:08:07.817034 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:08:07.817034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:08:07.833138 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:08:07.833138 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:08:07.833138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:07.856881 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:08:07.864841 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:08:07.864841 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:08:07.864841 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:08:07.864841 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:08:07.864841 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:08:07.864841 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.864841 [debug] [MainThread]: On master: BEGIN
[0m18:08:07.864841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:07.896762 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:08:07.896762 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.896762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:07.896762 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:08:07.896762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DACEBB150>]}
[0m18:08:07.896762 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:07.912685 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.912685 [debug] [MainThread]: On master: BEGIN
[0m18:08:07.912685 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:08:07.912685 [debug] [MainThread]: On master: COMMIT
[0m18:08:07.912685 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.912685 [debug] [MainThread]: On master: COMMIT
[0m18:08:07.912685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:07.912685 [debug] [MainThread]: On master: Close
[0m18:08:07.912685 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:08:07.912685 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:08:07.912685 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:08:07.912685 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:08:07.912685 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:08:07.912685 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:08:07.938570 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:08:07.938570 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:07.938570 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:08:07.938570 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:08:07.977984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m18:08:07.978984 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:07.978984 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:08:07.981529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:08:07.986551 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:07.987551 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:08:07.987551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:07.987551 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:07.987551 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:08:07.987551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:07.987551 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:08:07.987551 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:07.987551 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:08:08.004821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:08:08.004821 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:08:08.004821 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:08.004821 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:08:08.016320 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:08:08.020581 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:08:08.020581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAD352D50>]}
[0m18:08:08.020581 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:08:08.020581 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:08:08.020581 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:08:08.020581 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:08:08.020581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:08:08.020581 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:08:08.029427 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:08:08.029427 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:08:08.029427 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:08:08.029427 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:08.029427 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:08:08.029427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:08.061156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:08:08.061156 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:08.061156 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:08:08.061156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:08:08.071103 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:08.071103 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:08:08.072523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:08.072523 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:08.072523 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:08:08.072523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:08.072523 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:08:08.072523 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:08.072523 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:08:08.072523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:08.072523 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:08:08.081565 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:08.081565 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:08:08.081565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:08:08.081565 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:08:08.081565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAD2CD110>]}
[0m18:08:08.081565 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:08:08.081565 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:08:08.081565 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:08:08.087627 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:08:08.087627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:08:08.088611 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:08:08.088611 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:08:08.088611 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:08:08.088611 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:08:08.088611 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:08.088611 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:08:08.088611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:08.126068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:08:08.127074 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:08.128072 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m18:08:08.128072 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:08:08.128072 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:08.128072 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:08:08.128072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:08.128072 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:08.128072 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:08:08.128072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:08.137701 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:08:08.138708 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:08.138708 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:08:08.138708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:08.138708 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:08:08.138708 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:08.138708 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:08:08.138708 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:08:08.138708 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:08:08.138708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAD390050>]}
[0m18:08:08.138708 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:08:08.138708 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:08:08.138708 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:08:08.138708 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:08:08.138708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:08:08.138708 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:08:08.160748 [info ] [Thread-1 (]: 18:08:08 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:08:08.173045 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:08:08.174048 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:08:08.187692 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:08:08.188702 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:08.188702 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:08:08.188702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:08.209685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:08:08.209685 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:08.209685 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:08:08.222030 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m18:08:08.222030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:08.222030 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:08:08.222030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:08.222030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:08.222030 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:08:08.222030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:08.222030 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:08:08.222030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:08.222030 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:08:08.238183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:08:08.240186 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:08:08.241190 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:08.242186 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:08:08.244188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:08:08.245186 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:08:08.246188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAD333010>]}
[0m18:08:08.246188 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.11s]
[0m18:08:08.247189 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:08:08.247189 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:08:08.248187 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:08:08.248187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:08:08.249187 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:08:08.252185 [info ] [Thread-1 (]: 18:08:08 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:08:08.254188 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:08:08.255509 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:08:08.257554 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:08:08.258553 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:08.258553 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:08:08.258553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:08.288724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:08:08.288724 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:08.288724 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:08:08.288724 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m18:08:08.298635 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:08.298635 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:08:08.298635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:08.301959 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:08.301959 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:08:08.301959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:08.304482 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:08:08.304482 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:08.304482 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:08:08.306658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:08.308663 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:08:08.308663 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:08.308663 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:08:08.311662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:08:08.312664 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:08:08.313665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAC805950>]}
[0m18:08:08.313665 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m18:08:08.314661 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:08:08.314661 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:08:08.315663 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:08:08.315663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:08:08.316662 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:08:08.322035 [info ] [Thread-1 (]: 18:08:08 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:08:08.326078 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:08:08.326078 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:08:08.343673 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.343673 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp180808343673"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:08:08.343673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:08.382038 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m18:08:08.388703 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.388703 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:08:08.388703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:08:08.388703 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.388703 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp180808343673'
        
      order by ordinal_position

  
[0m18:08:08.406294 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m18:08:08.411295 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.412298 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:08.414294 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:08:08.419295 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.419295 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:08.421262 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:08:08.428305 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:08:08.428305 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.429306 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp180808343673"
    )


  
[0m18:08:08.430304 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m18:08:08.430304 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:08:08.431306 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:08.431306 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:08:08.433438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:08:08.433438 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:08:08.434461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAC8CFF90>]}
[0m18:08:08.435460 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.12s]
[0m18:08:08.436449 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:08:08.436449 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:08:08.437451 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:08:08.437451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:08:08.437451 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:08:08.438444 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:08:08.438444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '479b6ae1-3950-4180-b57d-80fa43a60b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAD4E2ED0>]}
[0m18:08:08.438444 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.00s]
[0m18:08:08.438444 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:08:08.451819 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql).
[0m18:08:08.453452 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:08.453452 [debug] [MainThread]: On master: BEGIN
[0m18:08:08.453452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:08.482097 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:08:08.482097 [debug] [MainThread]: On master: COMMIT
[0m18:08:08.482097 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:08.482097 [debug] [MainThread]: On master: COMMIT
[0m18:08:08.482097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:08.482097 [debug] [MainThread]: On master: Close
[0m18:08:08.482097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:08.482097 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:08:08.482097 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:08:08.482097 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:08:08.485426 [info ] [MainThread]: 
[0m18:08:08.485426 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m18:08:08.485426 [debug] [MainThread]: Command end result
[0m18:08:08.510546 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:08:08.510546 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:08:08.516741 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:08:08.516741 [info ] [MainThread]: 
[0m18:08:08.521106 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:08:08.521106 [info ] [MainThread]: 
[0m18:08:08.522489 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:08:08.522791 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:08:08.522791 [info ] [MainThread]: 
[0m18:08:08.523833 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:08:08.523833 [debug] [MainThread]: Command `dbt run` failed at 18:08:08.523833 after 1.82 seconds
[0m18:08:08.524832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAB657490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA6F35A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA48BF0D0>]}
[0m18:08:08.524832 [debug] [MainThread]: Flushing usage events
[0m18:08:09.039997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:48.833458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C3F1F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C3F1E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C3F1E310>]}


============================== 18:08:48.836451 | d682d946-3a59-46ef-8785-a429a0c841d1 ==============================
[0m18:08:48.836451 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:08:48.838086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:08:48.953862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C4F73850>]}
[0m18:08:49.001407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C07DBC50>]}
[0m18:08:49.001407 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:08:49.119876 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:08:49.271255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:49.271255 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:08:49.565442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C54DCB90>]}
[0m18:08:49.607377 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:08:49.607377 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:08:49.623205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C276EA50>]}
[0m18:08:49.623205 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:08:49.623205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C55E2390>]}
[0m18:08:49.638876 [info ] [MainThread]: 
[0m18:08:49.638876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:49.638876 [info ] [MainThread]: 
[0m18:08:49.638876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:49.638876 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:08:49.741998 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:08:49.741998 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:08:49.742998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:49.777942 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.037 seconds
[0m18:08:49.777942 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:08:49.783371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:08:49.787512 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:08:49.787512 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:08:49.787512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:49.808091 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m18:08:49.808091 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:08:49.808091 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:08:49.819291 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m18:08:49.819291 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:08:49.819291 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:08:49.824357 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:49.824357 [debug] [MainThread]: On master: BEGIN
[0m18:08:49.824357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:49.850863 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:08:49.850863 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:49.850863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:49.850863 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:08:49.850863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C53BB1D0>]}
[0m18:08:49.850863 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:49.850863 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:49.850863 [debug] [MainThread]: On master: BEGIN
[0m18:08:49.850863 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:08:49.850863 [debug] [MainThread]: On master: COMMIT
[0m18:08:49.850863 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:49.850863 [debug] [MainThread]: On master: COMMIT
[0m18:08:49.866592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:49.866954 [debug] [MainThread]: On master: Close
[0m18:08:49.867367 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:08:49.867367 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:08:49.871603 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:08:49.871603 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:08:49.876609 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:08:49.877608 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:08:49.888955 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:08:49.888955 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:49.888955 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:08:49.888955 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:08:49.925771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m18:08:49.925771 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:49.926774 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:08:49.928878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:08:49.933879 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:49.933879 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:08:49.934880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:49.936879 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:49.936879 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:08:49.937888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:49.938881 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:08:49.938881 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:49.938881 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:08:49.938881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:08:49.938881 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:08:49.954877 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:08:49.954877 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:08:49.954877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:08:49.954877 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:08:49.954877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C5CEAD90>]}
[0m18:08:49.954877 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:08:49.954877 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:08:49.954877 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:08:49.954877 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:08:49.954877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:08:49.954877 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:08:49.954877 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:08:49.954877 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:08:49.971464 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:08:49.972278 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:49.972597 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:08:49.972921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:49.994683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:08:49.994683 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:49.994683 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:08:50.005906 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:08:50.005906 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:50.005906 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:08:50.005906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:50.005906 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:50.005906 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:08:50.005906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:50.005906 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:08:50.005906 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:50.005906 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:08:50.005906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:50.005906 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:08:50.005906 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:08:50.005906 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:08:50.005906 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:08:50.021381 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:08:50.021381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C513E010>]}
[0m18:08:50.022482 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:08:50.022482 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:08:50.022482 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:08:50.022482 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:08:50.022482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:08:50.022482 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:08:50.022482 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:08:50.022482 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:08:50.022482 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:08:50.022482 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:50.022482 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:08:50.022482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:50.061399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:08:50.062396 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:50.062396 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m18:08:50.062396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:08:50.065657 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:50.065657 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:08:50.065657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:50.072550 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:50.072550 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:08:50.073114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:50.073114 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:08:50.073114 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:50.073114 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:08:50.073114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:50.073114 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:08:50.073114 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:08:50.073114 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:08:50.073114 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:08:50.073114 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:08:50.073114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C5D9DC90>]}
[0m18:08:50.073114 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:08:50.083939 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:08:50.083939 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:08:50.083939 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:08:50.083939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:08:50.083939 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:08:50.094840 [info ] [Thread-1 (]: 18:08:50 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:08:50.107483 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:08:50.108482 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:08:50.121537 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:08:50.122565 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:50.122565 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:08:50.122565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:50.139820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:08:50.139820 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:50.139820 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:08:50.155822 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m18:08:50.155822 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:50.155822 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:08:50.155822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:50.155822 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:50.155822 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:08:50.155822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:50.171495 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:08:50.171495 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:50.171495 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:08:50.173638 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:50.175642 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:08:50.176642 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:08:50.177642 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:08:50.179642 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:08:50.180643 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:08:50.181642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C5D20650>]}
[0m18:08:50.181642 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m18:08:50.182644 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:08:50.182644 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:08:50.183646 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:08:50.183646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:08:50.184643 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:08:50.187642 [info ] [Thread-1 (]: 18:08:50 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:08:50.188777 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:08:50.189816 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:08:50.192815 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:08:50.192815 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:50.193815 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:08:50.193815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:50.222511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:08:50.223137 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:50.223137 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:08:50.228144 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:08:50.228144 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:50.228144 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:08:50.228144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:50.228144 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:50.228144 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:08:50.228144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:50.228144 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:08:50.228144 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:50.228144 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:08:50.238116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:50.239125 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:08:50.239125 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:08:50.239125 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:08:50.239125 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:08:50.239125 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:08:50.239125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C5C21950>]}
[0m18:08:50.239125 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:08:50.239125 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:08:50.239125 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:08:50.239125 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:08:50.239125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:08:50.239125 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:08:50.256293 [info ] [Thread-1 (]: 18:08:50 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:08:50.261333 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:08:50.261333 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:08:50.279955 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.279955 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp180850279955"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:08:50.279955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:50.305929 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:08:50.322623 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.322623 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:08:50.322623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:08:50.322623 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.322623 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp180850279955'
        
      order by ordinal_position

  
[0m18:08:50.322623 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:08:50.339494 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.340491 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:50.342492 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:08:50.346491 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.347491 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:50.349491 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:08:50.355043 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:08:50.356081 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.356081 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp180850279955"
    )


  
[0m18:08:50.357084 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:08:50.358084 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:08:50.358084 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:08:50.359084 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:08:50.360544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:50.360544 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:08:50.361559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BF8ED690>]}
[0m18:08:50.362547 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.12s]
[0m18:08:50.362547 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:08:50.363550 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:08:50.363550 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:08:50.364548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:08:50.364548 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:08:50.376962 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:08:50.376962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd682d946-3a59-46ef-8785-a429a0c841d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C5BC51D0>]}
[0m18:08:50.376962 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.01s]
[0m18:08:50.376962 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:08:50.379384 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql).
[0m18:08:50.380390 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:50.381389 [debug] [MainThread]: On master: BEGIN
[0m18:08:50.381389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:50.411313 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m18:08:50.411313 [debug] [MainThread]: On master: COMMIT
[0m18:08:50.411313 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:50.411313 [debug] [MainThread]: On master: COMMIT
[0m18:08:50.411313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:50.411313 [debug] [MainThread]: On master: Close
[0m18:08:50.411313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:50.411313 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:08:50.411313 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:08:50.411313 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:08:50.411313 [info ] [MainThread]: 
[0m18:08:50.417140 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m18:08:50.417140 [debug] [MainThread]: Command end result
[0m18:08:50.440184 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:08:50.440184 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:08:50.440184 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:08:50.440184 [info ] [MainThread]: 
[0m18:08:50.440184 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:08:50.450891 [info ] [MainThread]: 
[0m18:08:50.450891 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:08:50.452052 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:08:50.452052 [info ] [MainThread]: 
[0m18:08:50.453062 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:08:50.454064 [debug] [MainThread]: Command `dbt run` failed at 18:08:50.454064 after 1.69 seconds
[0m18:08:50.454064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C30B8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BD1BFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7C3F16FD0>]}
[0m18:08:50.454064 [debug] [MainThread]: Flushing usage events
[0m18:08:50.967124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:18.260722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AD3E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AAEFE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717BD87710>]}


============================== 18:10:18.264721 | dbaa9da9-bccb-4861-b251-24a88d715d7d ==============================
[0m18:10:18.264721 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:10:18.265721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:10:18.388762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717BD918D0>]}
[0m18:10:18.420367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171775EDC90>]}
[0m18:10:18.436067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:10:18.553996 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:10:18.689547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:10:18.689547 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:10:18.981916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017179D7B750>]}
[0m18:10:19.027004 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:10:19.027004 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:10:19.043379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717C390050>]}
[0m18:10:19.043379 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:10:19.043379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717C3DCF50>]}
[0m18:10:19.043379 [info ] [MainThread]: 
[0m18:10:19.043379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:19.043379 [info ] [MainThread]: 
[0m18:10:19.043379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:19.058532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:10:19.153421 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:10:19.154426 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:10:19.154426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:19.189582 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.040 seconds
[0m18:10:19.189582 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:10:19.189582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:10:19.189582 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:10:19.189582 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:10:19.189582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:19.221312 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:10:19.221312 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:10:19.221312 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:10:19.221312 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:10:19.221312 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:10:19.237407 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:10:19.237407 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:19.237407 [debug] [MainThread]: On master: BEGIN
[0m18:10:19.237407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:19.269337 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:10:19.269337 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:19.269337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:19.269337 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:10:19.269337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717BFB29D0>]}
[0m18:10:19.269337 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:19.269337 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:19.269337 [debug] [MainThread]: On master: BEGIN
[0m18:10:19.269337 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:10:19.269337 [debug] [MainThread]: On master: COMMIT
[0m18:10:19.269337 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:19.269337 [debug] [MainThread]: On master: COMMIT
[0m18:10:19.269337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:19.269337 [debug] [MainThread]: On master: Close
[0m18:10:19.269337 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:10:19.269337 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:10:19.285321 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:10:19.285321 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:10:19.285321 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:10:19.285321 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:10:19.307875 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:10:19.307875 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:10:19.307875 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:10:19.307875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:19.340736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:10:19.341742 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:10:19.341742 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:10:19.345251 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:10:19.350249 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:10:19.350249 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:10:19.351249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.353249 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:10:19.353249 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:10:19.354249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.355833 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:10:19.355833 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:10:19.355833 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:10:19.364658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:10:19.371042 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:10:19.371042 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:10:19.371042 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:10:19.371042 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:10:19.371042 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:10:19.371042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CB0A7D0>]}
[0m18:10:19.371042 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:10:19.371042 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:10:19.371042 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:10:19.371042 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:10:19.371042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:10:19.371042 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:10:19.387067 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:10:19.387067 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:10:19.387067 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:10:19.387067 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:10:19.387067 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:10:19.387067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:19.408585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:10:19.422519 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:10:19.422519 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:10:19.425788 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:10:19.428787 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:10:19.428787 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:10:19.428787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.428787 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:10:19.428787 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:10:19.428787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.428787 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:10:19.428787 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:10:19.428787 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:10:19.428787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:19.428787 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:10:19.428787 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:10:19.439077 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:10:19.440176 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:10:19.440176 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:10:19.440176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CB2BC90>]}
[0m18:10:19.443340 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:10:19.443340 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:10:19.443340 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:10:19.443340 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:10:19.443340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:10:19.443340 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:10:19.443340 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:10:19.443340 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:10:19.443340 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:10:19.443340 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:10:19.443340 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:10:19.443340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:19.479387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:10:19.479387 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:10:19.479387 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m18:10:19.479387 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:10:19.479387 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:10:19.479387 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:10:19.479387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.490977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:10:19.490977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:10:19.490977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.490977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:10:19.490977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:10:19.490977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:10:19.490977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:19.490977 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:10:19.490977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:10:19.490977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:10:19.490977 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:10:19.490977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:10:19.490977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CBB3F90>]}
[0m18:10:19.490977 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:10:19.490977 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:10:19.490977 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:10:19.490977 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:10:19.505744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:10:19.505744 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:10:19.506718 [info ] [Thread-1 (]: 18:10:19 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:10:19.525339 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:10:19.525339 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:10:19.543414 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:10:19.543920 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:10:19.544929 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:10:19.544929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:19.672748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.138 seconds
[0m18:10:19.672748 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:10:19.672748 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:10:19.688339 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:10:19.688339 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:10:19.688339 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:10:19.688339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:19.688339 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:10:19.688339 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:10:19.688339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:19.688339 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:10:19.688339 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:10:19.688339 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:10:19.688339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:19.704087 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:10:19.704087 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:10:19.704087 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:10:19.704087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:19.704087 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:10:19.704087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CBFCA50>]}
[0m18:10:19.704087 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.21s]
[0m18:10:19.713456 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:10:19.713456 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:10:19.713456 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:10:19.713456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:10:19.713456 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:10:19.713456 [info ] [Thread-1 (]: 18:10:19 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:10:19.721665 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:10:19.721997 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:10:19.725317 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:10:19.726317 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:10:19.726317 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:10:19.726317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:19.745276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:10:19.745276 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:10:19.755932 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:10:19.756941 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m18:10:19.756941 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:10:19.756941 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:10:19.756941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.756941 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:10:19.756941 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:10:19.756941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:19.756941 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:10:19.756941 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:10:19.756941 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:10:19.756941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:10:19.772508 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:10:19.772508 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:10:19.773518 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:10:19.774515 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:10:19.775514 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:10:19.776514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CAC4A10>]}
[0m18:10:19.777514 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:10:19.777514 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:10:19.778514 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:10:19.778514 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:10:19.779516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:10:19.779516 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:10:19.786517 [info ] [Thread-1 (]: 18:10:19 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:10:19.793091 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:10:19.793091 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:10:19.812703 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.812703 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp181019812703"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:10:19.812703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:19.851211 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:10:19.859885 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.860885 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:10:19.861889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:10:19.861889 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.862887 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp181019812703'
        
      order by ordinal_position

  
[0m18:10:19.868885 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:10:19.872501 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.872501 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:10:19.872501 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:10:19.880257 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.880257 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:10:19.880257 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:10:19.889276 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:10:19.889276 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.891280 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp181019812703"
    )


  
[0m18:10:19.891280 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:10:19.893627 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:10:19.893627 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:10:19.893627 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:10:19.893627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:10:19.893627 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:10:19.893627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717C9EDC50>]}
[0m18:10:19.898315 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m18:10:19.898315 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:10:19.898315 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:10:19.898315 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:10:19.898315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:10:19.898315 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:10:19.908464 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m18:10:19.910467 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m18:10:19.912471 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m18:10:19.914479 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:10:19.914479 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m18:10:19.914479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:19.944508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:10:19.944508 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:10:19.944508 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."sat_mobilite"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.id_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.id_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.id_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.id_mobilite,
                1,
                CAST('FFFFFFFF' AS BYTEA)
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        ) AS b
    WHERE b.id_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.id_mobilite AS HASHDIFF, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:10:19.944508 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la référence à la colonne « id_mobilite » est ambiguë
LINE 30:             sd.id_mobilite, sd.id_mobilite, sd.date_debut, s...
                     ^

[0m18:10:19.944508 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: ROLLBACK
[0m18:10:19.944508 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m18:10:19.951163 [debug] [Thread-1 (]: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la référence à la colonne « id_mobilite » est ambiguë
  LINE 30:             sd.id_mobilite, sd.id_mobilite, sd.date_debut, s...
                       ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:10:19.951163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbaa9da9-bccb-4861-b251-24a88d715d7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CA23890>]}
[0m18:10:19.951163 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.05s]
[0m18:10:19.955927 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:10:19.955927 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la référence à la colonne « id_mobilite » est ambiguë
  LINE 30:             sd.id_mobilite, sd.id_mobilite, sd.date_debut, s...
                       ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql.
[0m18:10:19.956936 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:19.956936 [debug] [MainThread]: On master: BEGIN
[0m18:10:19.956936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:19.978769 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:10:19.978769 [debug] [MainThread]: On master: COMMIT
[0m18:10:19.978769 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:19.978769 [debug] [MainThread]: On master: COMMIT
[0m18:10:19.989167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:19.989167 [debug] [MainThread]: On master: Close
[0m18:10:19.990174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:19.990174 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:10:19.990174 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:10:19.990174 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:10:19.990174 [info ] [MainThread]: 
[0m18:10:19.990174 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m18:10:19.990174 [debug] [MainThread]: Command end result
[0m18:10:20.012212 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:10:20.017396 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:10:20.023603 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:10:20.024520 [info ] [MainThread]: 
[0m18:10:20.024520 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:10:20.025526 [info ] [MainThread]: 
[0m18:10:20.025526 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:10:20.025526 [error] [MainThread]:   Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la référence à la colonne « id_mobilite » est ambiguë
  LINE 30:             sd.id_mobilite, sd.id_mobilite, sd.date_debut, s...
                       ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:10:20.026531 [info ] [MainThread]: 
[0m18:10:20.026531 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:10:20.026531 [info ] [MainThread]: 
[0m18:10:20.026531 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:10:20.027525 [debug] [MainThread]: Command `dbt run` failed at 18:10:20.027525 after 1.83 seconds
[0m18:10:20.027525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AD37290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AC7DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717BF33E10>]}
[0m18:10:20.028524 [debug] [MainThread]: Flushing usage events
[0m18:10:20.572487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:18.321512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF02DE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF02D7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF02D71D0>]}


============================== 18:12:18.321512 | ac05cbae-0af4-4fd2-9f35-135e51e86b66 ==============================
[0m18:12:18.321512 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:12:18.325567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:18.438470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CEF3BE310>]}
[0m18:12:18.485669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CECB8E090>]}
[0m18:12:18.485669 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:12:18.605035 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:12:18.755476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:12:18.757146 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:12:19.058548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CEF3CBE90>]}
[0m18:12:19.107074 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:12:19.107074 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:12:19.125397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF0168650>]}
[0m18:12:19.125397 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:12:19.125397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF1953850>]}
[0m18:12:19.125397 [info ] [MainThread]: 
[0m18:12:19.125397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:19.125397 [info ] [MainThread]: 
[0m18:12:19.125397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:19.138194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:12:19.230396 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:12:19.231399 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:12:19.231399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:19.264231 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.037 seconds
[0m18:12:19.264231 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:12:19.264231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:12:19.272869 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:12:19.272869 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:12:19.272869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:19.304634 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:12:19.304634 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:12:19.304634 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:12:19.304634 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:12:19.304634 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:12:19.304634 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:12:19.304634 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:19.304634 [debug] [MainThread]: On master: BEGIN
[0m18:12:19.304634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:19.346801 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:12:19.347805 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:19.347805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:19.352804 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:12:19.353808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF1FB2610>]}
[0m18:12:19.353808 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:19.354807 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:19.355807 [debug] [MainThread]: On master: BEGIN
[0m18:12:19.355807 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:12:19.356807 [debug] [MainThread]: On master: COMMIT
[0m18:12:19.357136 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:19.357136 [debug] [MainThread]: On master: COMMIT
[0m18:12:19.357136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:19.357136 [debug] [MainThread]: On master: Close
[0m18:12:19.357136 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:12:19.357136 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:12:19.357136 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:12:19.357136 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:12:19.357136 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:12:19.357136 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:12:19.379628 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:12:19.379628 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:12:19.379628 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:12:19.379628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:19.416233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:12:19.417237 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:12:19.417237 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:12:19.420236 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:12:19.424140 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:12:19.425681 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:12:19.425681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:12:19.427685 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:12:19.428684 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:12:19.428684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:12:19.437684 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:12:19.437684 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:12:19.438685 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:12:19.440152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:12:19.441262 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:12:19.441262 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:12:19.441262 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:12:19.441262 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:12:19.441262 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:12:19.441262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF1FEFF90>]}
[0m18:12:19.441262 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:12:19.441262 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:12:19.441262 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:12:19.441262 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:12:19.457245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:12:19.457245 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:12:19.457245 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:12:19.457245 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:12:19.457245 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:12:19.457245 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:12:19.457245 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:12:19.457245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.496853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:12:19.496853 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:12:19.496853 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:12:19.496853 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:12:19.496853 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:12:19.496853 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:12:19.496853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:12:19.507175 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:12:19.507175 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:12:19.508358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:12:19.508826 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:12:19.508826 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:12:19.508826 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:12:19.508826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:12:19.512984 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:12:19.512984 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:12:19.512984 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:12:19.512984 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:12:19.512984 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:12:19.517239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF1F1C750>]}
[0m18:12:19.517239 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:12:19.517239 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:12:19.517239 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:12:19.517239 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:12:19.517239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:12:19.517239 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:12:19.517239 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:12:19.517239 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:12:19.525441 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:12:19.525945 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:12:19.525945 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:12:19.526951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.552793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:12:19.557151 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:12:19.557151 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    

select
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source
from "sid_lite"."public"."mobilite"
  );
[0m18:12:19.560547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:12:19.563546 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:12:19.563546 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:12:19.563546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:12:19.563546 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:12:19.563546 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:12:19.563546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:12:19.563546 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:12:19.563546 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:12:19.571603 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:12:19.571603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:12:19.574768 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:12:19.574768 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:12:19.574768 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:12:19.574768 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:12:19.574768 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:12:19.579180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF1FAD7D0>]}
[0m18:12:19.579180 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:12:19.579180 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:12:19.579180 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:12:19.579180 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:12:19.579180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:12:19.579180 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:12:19.595100 [info ] [Thread-1 (]: 18:12:19 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:12:19.598508 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:12:19.598508 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:12:19.608743 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:12:19.608743 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:12:19.608743 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:12:19.608743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.641655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:12:19.641655 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:12:19.641655 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:12:19.641655 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:12:19.658237 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:12:19.658237 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:12:19.658237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:12:19.663479 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:12:19.665488 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:12:19.665488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:12:19.665488 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:12:19.665488 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:12:19.665488 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:12:19.668023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:12:19.671120 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:12:19.671120 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:12:19.673903 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:12:19.675912 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:12:19.676912 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:12:19.677912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF217F410>]}
[0m18:12:19.678913 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m18:12:19.678913 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:12:19.679912 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:12:19.679912 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:12:19.680912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:12:19.680912 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:12:19.683911 [info ] [Thread-1 (]: 18:12:19 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:12:19.685911 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:12:19.686924 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:12:19.689571 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:12:19.690573 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:12:19.690573 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:12:19.691310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.718334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:12:19.720340 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:12:19.720340 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:12:19.726422 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m18:12:19.729428 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:12:19.729428 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:12:19.729428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:12:19.729428 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:12:19.729428 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:12:19.729428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:12:19.729428 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:12:19.729428 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:12:19.729428 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:12:19.729428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:12:19.729428 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:12:19.729428 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:12:19.729428 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:12:19.740818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:12:19.740818 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:12:19.740818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF2157350>]}
[0m18:12:19.740818 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:12:19.740818 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:12:19.740818 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:12:19.740818 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:12:19.740818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:12:19.740818 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:12:19.740818 [info ] [Thread-1 (]: 18:12:19 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:12:19.764441 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:12:19.764441 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:12:19.780545 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.780545 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp181219779545"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:12:19.780545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.808196 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:12:19.825218 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.825218 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:12:19.826571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:12:19.827604 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.828600 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp181219779545'
        
      order by ordinal_position

  
[0m18:12:19.834583 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:12:19.837583 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.838583 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:12:19.840583 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:12:19.844718 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.845717 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:12:19.847721 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:12:19.853718 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:12:19.853718 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.854718 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp181219779545"
    )


  
[0m18:12:19.854718 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:12:19.855719 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:12:19.855719 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:12:19.855719 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:12:19.857320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:12:19.857320 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:12:19.857320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF20951D0>]}
[0m18:12:19.857320 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.12s]
[0m18:12:19.857320 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:12:19.857320 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:12:19.857320 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:12:19.857320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:12:19.857320 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:12:19.874654 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:12:19.875268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac05cbae-0af4-4fd2-9f35-135e51e86b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CF20C7550>]}
[0m18:12:19.876296 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.02s]
[0m18:12:19.876296 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:12:19.876296 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql).
[0m18:12:19.878293 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:19.879293 [debug] [MainThread]: On master: BEGIN
[0m18:12:19.879293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:19.908225 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:12:19.908225 [debug] [MainThread]: On master: COMMIT
[0m18:12:19.908225 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:19.909218 [debug] [MainThread]: On master: COMMIT
[0m18:12:19.909218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:19.909218 [debug] [MainThread]: On master: Close
[0m18:12:19.910330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:19.910330 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:12:19.911330 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:12:19.911330 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:12:19.911330 [info ] [MainThread]: 
[0m18:12:19.912334 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:12:19.913333 [debug] [MainThread]: Command end result
[0m18:12:19.930637 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:12:19.940487 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:12:19.944238 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:12:19.944238 [info ] [MainThread]: 
[0m18:12:19.945240 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:12:19.945240 [info ] [MainThread]: 
[0m18:12:19.946239 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:12:19.946239 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:12:19.946239 [info ] [MainThread]: 
[0m18:12:19.947239 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:12:19.947239 [debug] [MainThread]: Command `dbt run` failed at 18:12:19.947239 after 1.69 seconds
[0m18:12:19.947239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CEFFAD510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE955F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CECB79910>]}
[0m18:12:19.947239 [debug] [MainThread]: Flushing usage events
[0m18:12:20.474265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:20:35.006391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014757CCE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014757A7FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014757D10350>]}


============================== 18:20:35.006391 | 4f86b409-ec38-4afd-8f52-5fcc1d22e3aa ==============================
[0m18:20:35.006391 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:20:35.006391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:35.143887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014758D54490>]}
[0m18:20:35.175787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001475458DC90>]}
[0m18:20:35.175787 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:20:35.298147 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:20:35.447076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:35.449079 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m18:20:35.772726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759187890>]}
[0m18:20:35.830093 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:20:35.830093 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:20:35.849351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759605890>]}
[0m18:20:35.849351 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:20:35.849351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759184C50>]}
[0m18:20:35.852051 [info ] [MainThread]: 
[0m18:20:35.852051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:35.852051 [info ] [MainThread]: 
[0m18:20:35.852051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:35.852051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:20:35.952537 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:20:35.953539 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:20:35.953539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:35.984942 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.035 seconds
[0m18:20:35.984942 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:20:35.991093 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:20:35.996453 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:20:35.998459 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:20:35.998459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:36.025808 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:20:36.025808 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:20:36.025808 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:20:36.030167 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:20:36.030167 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:20:36.030167 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:20:36.037352 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:36.037352 [debug] [MainThread]: On master: BEGIN
[0m18:20:36.037352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:36.062239 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m18:20:36.062239 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:36.062239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:36.062239 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:20:36.062239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759739810>]}
[0m18:20:36.062239 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:36.073498 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:36.073498 [debug] [MainThread]: On master: BEGIN
[0m18:20:36.073498 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:20:36.073498 [debug] [MainThread]: On master: COMMIT
[0m18:20:36.073498 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:36.073498 [debug] [MainThread]: On master: COMMIT
[0m18:20:36.073498 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:20:36.073498 [debug] [MainThread]: On master: Close
[0m18:20:36.073498 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:20:36.073498 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:20:36.073498 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:20:36.073498 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:20:36.073498 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:20:36.073498 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:20:36.096883 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:20:36.096883 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:20:36.096883 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:20:36.096883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:20:36.137329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:20:36.138327 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:20:36.138327 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:20:36.141327 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:20:36.146331 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:20:36.146331 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:20:36.147329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:20:36.147329 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:20:36.147329 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:20:36.147329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:20:36.147329 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:20:36.147329 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:20:36.147329 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:20:36.147329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:20:36.164025 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:20:36.164025 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:20:36.164025 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:20:36.164025 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:20:36.164025 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:20:36.164025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014758F96C50>]}
[0m18:20:36.164025 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:20:36.164025 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:20:36.164025 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:20:36.164025 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:20:36.164025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:20:36.164025 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:20:36.180395 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:20:36.181395 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:20:36.183392 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:20:36.184393 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:20:36.184393 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:20:36.185395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:36.212798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:20:36.213188 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:20:36.213876 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:20:36.215881 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:20:36.219414 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:20:36.219414 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:20:36.219414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:20:36.219414 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:20:36.219414 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:20:36.219414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:20:36.219414 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:20:36.219414 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:20:36.219414 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:20:36.219414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:20:36.219414 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:20:36.229454 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:20:36.229454 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:20:36.230853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:20:36.230853 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:20:36.230853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001475963B050>]}
[0m18:20:36.230853 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:20:36.230853 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:20:36.230853 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:20:36.230853 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:20:36.230853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:20:36.230853 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:20:36.230853 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:20:36.230853 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:20:36.230853 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:20:36.230853 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:20:36.230853 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:20:36.230853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:36.269906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:20:36.269906 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:20:36.269906 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    encode(
      digest(
        coalesce(cast(id_mobilite as text),'') || '|' ||
        coalesce(cast(date_debut as text),'') || '|' ||
        coalesce(cast(date_fin as text),'') || '|' ||
        coalesce(cast(type_mobilite as text),'') || '|' ||
        coalesce(cast(statut_mobilite as text),''),
        'sha256'
      ),
      'hex'
    ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m18:20:36.269906 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:20:36.269906 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:20:36.269906 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:20:36.279501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:20:36.280977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:20:36.280977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:20:36.280977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:20:36.280977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:20:36.280977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:20:36.280977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:20:36.280977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:20:36.280977 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:20:36.280977 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:20:36.280977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:20:36.280977 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:20:36.280977 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:20:36.280977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759B2B910>]}
[0m18:20:36.280977 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:20:36.280977 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:20:36.280977 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:20:36.280977 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:20:36.280977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:20:36.280977 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:20:36.296786 [info ] [Thread-1 (]: 18:20:36 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:20:36.336011 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:20:36.336011 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:20:36.352989 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:20:36.352989 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:20:36.352989 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:20:36.352989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:36.380908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:20:36.380908 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:20:36.380908 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:20:36.380908 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:20:36.399014 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:20:36.399014 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:20:36.400017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:20:36.402016 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:20:36.402016 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:20:36.403018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:20:36.404017 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:20:36.405018 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:20:36.405018 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:20:36.406465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:20:36.407470 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:20:36.410468 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:20:36.411468 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:20:36.413924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:20:36.414921 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:20:36.414921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759C97B50>]}
[0m18:20:36.415929 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.13s]
[0m18:20:36.416930 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:20:36.416930 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:20:36.417926 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:20:36.417926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:20:36.417926 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:20:36.420924 [info ] [Thread-1 (]: 18:20:36 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:20:36.422926 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:20:36.423924 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:20:36.426690 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:20:36.427691 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:20:36.427691 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:20:36.428690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:36.451489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:20:36.451489 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:20:36.451489 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:20:36.462738 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m18:20:36.463696 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:20:36.463696 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:20:36.463696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:20:36.463696 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:20:36.463696 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:20:36.463696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:20:36.463696 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:20:36.463696 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:20:36.463696 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:20:36.463696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:20:36.463696 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:20:36.463696 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:20:36.463696 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:20:36.480457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:20:36.482453 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:20:36.482453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759B1E010>]}
[0m18:20:36.483453 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:20:36.484452 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:20:36.484452 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:20:36.485453 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:20:36.485453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:20:36.485453 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:20:36.491454 [info ] [Thread-1 (]: 18:20:36 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:20:36.497453 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:20:36.497453 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:20:36.518985 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.518985 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp182036517985"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:20:36.518985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:36.547596 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m18:20:36.568772 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.568772 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:20:36.570774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:20:36.570774 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.570774 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp182036517985'
        
      order by ordinal_position

  
[0m18:20:36.578776 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m18:20:36.661137 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.661137 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:36.661137 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:20:36.661137 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.661137 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:36.661137 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:20:36.683524 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:20:36.684525 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.684525 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp182036517985"
    )


  
[0m18:20:36.685529 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:20:36.686525 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:20:36.686525 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:20:36.686525 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:20:36.688525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:20:36.689524 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:20:36.690526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759DB5910>]}
[0m18:20:36.691529 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.21s]
[0m18:20:36.692530 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:20:36.692530 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:20:36.692530 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:20:36.693526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:20:36.693526 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:20:36.718586 [debug] [Thread-1 (]: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:20:36.718586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f86b409-ec38-4afd-8f52-5fcc1d22e3aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014759BF8A10>]}
[0m18:20:36.718586 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.03s]
[0m18:20:36.724256 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:20:36.724256 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql).
[0m18:20:36.726263 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:36.726263 [debug] [MainThread]: On master: BEGIN
[0m18:20:36.726263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:36.752723 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:20:36.752723 [debug] [MainThread]: On master: COMMIT
[0m18:20:36.752723 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:36.752723 [debug] [MainThread]: On master: COMMIT
[0m18:20:36.752723 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:20:36.752723 [debug] [MainThread]: On master: Close
[0m18:20:36.752723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:36.752723 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:20:36.752723 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:20:36.752723 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:20:36.752723 [info ] [MainThread]: 
[0m18:20:36.752723 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m18:20:36.752723 [debug] [MainThread]: Command end result
[0m18:20:36.781465 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:20:36.781465 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:20:36.781465 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:20:36.781465 [info ] [MainThread]: 
[0m18:20:36.781465 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:20:36.781465 [info ] [MainThread]: 
[0m18:20:36.794207 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:20:36.794207 [error] [MainThread]:   Compilation Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, sd)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
[0m18:20:36.794207 [info ] [MainThread]: 
[0m18:20:36.795213 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:20:36.796212 [debug] [MainThread]: Command `dbt run` failed at 18:20:36.796212 after 1.85 seconds
[0m18:20:36.797213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014758D17410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014750F3F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147591B0290>]}
[0m18:20:36.797983 [debug] [MainThread]: Flushing usage events
[0m18:20:37.346430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:45.216204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001525729E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152572E3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152582E7590>]}


============================== 18:21:45.216204 | 06ab156e-3890-4798-bcc2-e3c5dcf9aae0 ==============================
[0m18:21:45.216204 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:21:45.216204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:21:45.349761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258503310>]}
[0m18:21:45.394540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015253BAF750>]}
[0m18:21:45.395540 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:21:45.516477 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:21:45.643001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:21:45.658694 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:21:45.947406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152559078D0>]}
[0m18:21:45.997421 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:21:46.014003 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:21:46.030811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258BACF50>]}
[0m18:21:46.030811 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:21:46.030811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258962A50>]}
[0m18:21:46.030811 [info ] [MainThread]: 
[0m18:21:46.030811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:46.030811 [info ] [MainThread]: 
[0m18:21:46.030811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:21:46.030811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:21:46.133759 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:21:46.134892 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:21:46.134892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:46.163991 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.040 seconds
[0m18:21:46.163991 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:21:46.163991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:21:46.179756 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:21:46.179756 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:21:46.179756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:46.195517 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:21:46.211617 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:21:46.211617 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:21:46.211617 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m18:21:46.217061 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:21:46.217061 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:21:46.217061 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:46.217061 [debug] [MainThread]: On master: BEGIN
[0m18:21:46.217061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:46.243093 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m18:21:46.243093 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:46.243093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:21:46.243093 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:21:46.258809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258FBE2D0>]}
[0m18:21:46.258809 [debug] [MainThread]: On master: ROLLBACK
[0m18:21:46.258809 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:46.258809 [debug] [MainThread]: On master: BEGIN
[0m18:21:46.258809 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:21:46.258809 [debug] [MainThread]: On master: COMMIT
[0m18:21:46.258809 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:46.258809 [debug] [MainThread]: On master: COMMIT
[0m18:21:46.258809 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:21:46.258809 [debug] [MainThread]: On master: Close
[0m18:21:46.258809 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:21:46.258809 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:21:46.258809 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:21:46.258809 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:21:46.271973 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:21:46.273979 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:21:46.281211 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:21:46.281211 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:21:46.296735 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:21:46.297169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:21:46.325207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:21:46.326207 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:21:46.326207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:21:46.328207 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:21:46.331207 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:21:46.331207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:21:46.331207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:21:46.331207 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:21:46.331207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:21:46.331207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:21:46.331207 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:21:46.331207 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:21:46.346911 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:21:46.346911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:21:46.346911 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:21:46.346911 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:21:46.346911 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:21:46.346911 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:21:46.346911 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:21:46.346911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258444450>]}
[0m18:21:46.346911 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:21:46.346911 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:21:46.346911 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:21:46.362660 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:21:46.362660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:21:46.362660 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:21:46.362660 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:21:46.362660 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:21:46.362660 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:21:46.362660 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:21:46.362660 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:21:46.362660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:46.400712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:21:46.400712 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:21:46.400712 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:21:46.400712 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:21:46.400712 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:21:46.400712 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:21:46.400712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:46.400712 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:21:46.400712 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:21:46.400712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:21:46.400712 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:21:46.400712 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:21:46.400712 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:21:46.413467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:46.417298 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:21:46.417298 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:21:46.417298 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:21:46.417298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:21:46.417298 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:21:46.417298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258B40990>]}
[0m18:21:46.417298 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:21:46.417298 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:21:46.417298 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:21:46.417298 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:21:46.417298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:21:46.417298 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:21:46.417298 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:21:46.417298 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:21:46.429511 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:21:46.430208 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:21:46.430846 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:21:46.431148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:46.452861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:21:46.452861 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:21:46.452861 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    encode(
      digest(
        coalesce(cast(id_mobilite as text),'') || '|' ||
        coalesce(cast(date_debut as text),'') || '|' ||
        coalesce(cast(date_fin as text),'') || '|' ||
        coalesce(cast(type_mobilite as text),'') || '|' ||
        coalesce(cast(statut_mobilite as text),''),
        'sha256'
      ),
      'hex'
    ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m18:21:46.463606 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:21:46.463606 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:21:46.463606 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:21:46.463606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:46.463606 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:21:46.463606 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:21:46.463606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:46.463606 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:21:46.463606 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:21:46.463606 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:21:46.463606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:46.463606 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:21:46.463606 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:21:46.463606 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:21:46.480469 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:21:46.480469 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:21:46.480469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258F69710>]}
[0m18:21:46.480469 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:21:46.480469 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:21:46.480469 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:21:46.480469 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:21:46.480469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:21:46.480469 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:21:46.497886 [info ] [Thread-1 (]: 18:21:46 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:21:46.502949 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:21:46.502949 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:21:46.521579 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:21:46.522578 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:21:46.522578 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:21:46.522578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:46.548024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:21:46.548024 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:21:46.548024 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:21:46.548024 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:21:46.565003 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:21:46.565003 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:21:46.565003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:21:46.565003 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:21:46.565003 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:21:46.565003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:46.565003 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:21:46.565003 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:21:46.565003 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:21:46.565003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:46.565003 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:21:46.565003 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:21:46.565003 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:21:46.581252 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:21:46.582257 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:21:46.583259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258F7C790>]}
[0m18:21:46.584258 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m18:21:46.585267 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:21:46.585267 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:21:46.585267 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:21:46.586255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:21:46.586255 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:21:46.589239 [info ] [Thread-1 (]: 18:21:46 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:21:46.592240 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:21:46.593240 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:21:46.595740 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:21:46.596744 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:21:46.596744 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:21:46.597598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:46.627076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:21:46.628076 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:21:46.628076 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:21:46.631169 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m18:21:46.631169 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:21:46.631169 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:21:46.631169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:46.631169 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:21:46.631169 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:21:46.631169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:21:46.631169 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:21:46.631169 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:21:46.631169 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:21:46.631169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:46.646788 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:21:46.646788 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:21:46.647796 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:21:46.649794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:21:46.650795 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:21:46.650795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258F9D590>]}
[0m18:21:46.651795 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:21:46.652797 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:21:46.652797 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:21:46.652797 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:21:46.653795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:21:46.653795 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:21:46.660794 [info ] [Thread-1 (]: 18:21:46 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:21:46.667941 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:21:46.667941 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:21:46.686680 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.686680 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp182146686680"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:21:46.686680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:46.723493 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:21:46.730315 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.730315 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:21:46.730315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:21:46.730315 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.730315 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp182146686680'
        
      order by ordinal_position

  
[0m18:21:46.738283 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m18:21:46.745537 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.745537 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:46.745537 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m18:21:46.745537 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.745537 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:46.757534 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:21:46.761565 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:21:46.761565 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.761565 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp182146686680"
    )


  
[0m18:21:46.761565 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m18:21:46.761565 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:21:46.761565 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:21:46.761565 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:21:46.761565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:46.761565 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:21:46.761565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258907410>]}
[0m18:21:46.761565 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m18:21:46.761565 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:21:46.761565 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:21:46.761565 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:21:46.774809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:21:46.774809 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:21:46.777303 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m18:21:46.777303 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m18:21:46.777303 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m18:21:46.777303 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:21:46.777303 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m18:21:46.777303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:46.815990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:21:46.817494 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:21:46.817494 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."sat_mobilite"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                CAST('FFFFFFFF' AS BYTEA)
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite AS HASHDIFF, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:21:46.818498 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
LINE 31:             LAG(
                     ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m18:21:46.818498 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: ROLLBACK
[0m18:21:46.818498 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m18:21:46.822829 [debug] [Thread-1 (]: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:21:46.822829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ab156e-3890-4798-bcc2-e3c5dcf9aae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015258F69550>]}
[0m18:21:46.822829 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.05s]
[0m18:21:46.822829 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:21:46.822829 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql.
[0m18:21:46.822829 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:46.822829 [debug] [MainThread]: On master: BEGIN
[0m18:21:46.822829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:46.856178 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:21:46.857178 [debug] [MainThread]: On master: COMMIT
[0m18:21:46.858178 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:46.858178 [debug] [MainThread]: On master: COMMIT
[0m18:21:46.858178 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:21:46.859178 [debug] [MainThread]: On master: Close
[0m18:21:46.860178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:46.860178 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:21:46.860178 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:21:46.860178 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:21:46.861178 [info ] [MainThread]: 
[0m18:21:46.861178 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m18:21:46.862178 [debug] [MainThread]: Command end result
[0m18:21:46.886206 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:21:46.886206 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:21:46.892883 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:21:46.892883 [info ] [MainThread]: 
[0m18:21:46.892883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:21:46.892883 [info ] [MainThread]: 
[0m18:21:46.892883 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:21:46.892883 [error] [MainThread]:   Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:21:46.892883 [info ] [MainThread]: 
[0m18:21:46.892883 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:21:46.892883 [info ] [MainThread]: 
[0m18:21:46.892883 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:21:46.896822 [debug] [MainThread]: Command `dbt run` failed at 18:21:46.896822 after 1.74 seconds
[0m18:21:46.896822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152582E7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001525326F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152505CFC90>]}
[0m18:21:46.897877 [debug] [MainThread]: Flushing usage events
[0m18:21:47.433954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:08.669469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2ADDE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2AB8FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2ADDE290>]}


============================== 18:28:08.669469 | 0245bca1-de2f-471f-9ee7-24fc3c771620 ==============================
[0m18:28:08.669469 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:28:08.669469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:28:08.783928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2ADD75D0>]}
[0m18:28:08.831112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2769B990>]}
[0m18:28:08.831112 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:28:08.949364 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:28:09.103958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:09.103958 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:28:09.399449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BEF25D0>]}
[0m18:28:09.451978 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:28:09.454596 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:28:09.469147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2C314A50>]}
[0m18:28:09.470654 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:28:09.470654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2C433210>]}
[0m18:28:09.470654 [info ] [MainThread]: 
[0m18:28:09.470654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:09.470654 [info ] [MainThread]: 
[0m18:28:09.470654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:09.475630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:28:09.570286 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:28:09.571291 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:28:09.571291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:09.607198 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.036 seconds
[0m18:28:09.607198 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:28:09.609506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:28:09.609506 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:28:09.609506 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:28:09.609506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:09.642254 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:28:09.643259 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:28:09.644257 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:28:09.648160 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:28:09.649163 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:28:09.649163 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:28:09.652162 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:09.652162 [debug] [MainThread]: On master: BEGIN
[0m18:28:09.652162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:09.675634 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m18:28:09.675634 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:09.683650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:09.683650 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:28:09.683650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BF094D0>]}
[0m18:28:09.683650 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:09.683650 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:09.683650 [debug] [MainThread]: On master: BEGIN
[0m18:28:09.683650 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:28:09.683650 [debug] [MainThread]: On master: COMMIT
[0m18:28:09.683650 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:09.683650 [debug] [MainThread]: On master: COMMIT
[0m18:28:09.683650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:28:09.683650 [debug] [MainThread]: On master: Close
[0m18:28:09.683650 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:28:09.683650 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:28:09.683650 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:28:09.683650 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:28:09.699728 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:28:09.699728 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:28:09.722503 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:28:09.722503 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:28:09.722503 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:28:09.722503 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:09.753261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:28:09.753261 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:28:09.753261 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:28:09.757557 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:28:09.763558 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:28:09.763558 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:28:09.764575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:09.766559 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:28:09.766559 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:28:09.767992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:09.776547 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:28:09.776547 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:28:09.777547 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:28:09.779004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:28:09.783009 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:28:09.785009 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:28:09.785009 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:28:09.785009 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:28:09.785009 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:28:09.789381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2C63D1D0>]}
[0m18:28:09.789381 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:28:09.789381 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:28:09.789381 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:28:09.789381 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:28:09.789381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:28:09.789381 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:28:09.797943 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:28:09.797943 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:28:09.800778 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:28:09.801975 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:28:09.801975 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:28:09.802975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:09.934839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m18:28:09.934839 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:28:09.934839 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:28:09.934839 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:28:09.934839 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:28:09.934839 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:28:09.934839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:09.950667 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:28:09.950667 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:28:09.950667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:09.950667 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:28:09.950667 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:28:09.950667 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:28:09.950667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:28:09.950667 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:28:09.950667 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:28:09.950667 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:28:09.950667 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:28:09.950667 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:28:09.950667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2CAF0B10>]}
[0m18:28:09.950667 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m18:28:09.950667 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:28:09.950667 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:28:09.950667 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:28:09.950667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:28:09.950667 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:28:09.950667 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:28:09.966440 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:28:09.969211 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:28:09.970221 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:28:09.971211 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:28:09.971211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:09.988179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:28:09.988179 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:28:09.988179 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    encode(
      digest(
        coalesce(cast(id_mobilite as text),'') || '|' ||
        coalesce(cast(date_debut as text),'') || '|' ||
        coalesce(cast(date_fin as text),'') || '|' ||
        coalesce(cast(type_mobilite as text),'') || '|' ||
        coalesce(cast(statut_mobilite as text),''),
        'sha256'
      ),
      'hex'
    ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m18:28:10.003652 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:28:10.006647 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:28:10.007647 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:28:10.007647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:28:10.007647 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:28:10.007647 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:28:10.007647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:10.007647 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:28:10.007647 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:28:10.007647 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:28:10.007647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:28:10.007647 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:28:10.007647 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:28:10.017791 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:28:10.018800 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:28:10.018800 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:28:10.018800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2CB8E490>]}
[0m18:28:10.018800 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:28:10.018800 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:28:10.018800 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:28:10.018800 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:28:10.018800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:28:10.018800 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:28:10.035651 [info ] [Thread-1 (]: 18:28:10 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:28:10.041461 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:28:10.041461 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:28:10.058482 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:28:10.058482 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:28:10.058482 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:28:10.058482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:10.086131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m18:28:10.086131 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:28:10.086131 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:28:10.086131 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:28:10.101259 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:28:10.102269 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:28:10.102807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:10.106930 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:28:10.106930 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:28:10.107434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:28:10.107434 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:28:10.107434 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:28:10.107434 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:28:10.110006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:28:10.110006 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:28:10.110006 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:28:10.110006 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:28:10.117845 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:28:10.119144 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:28:10.120145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2CBCB290>]}
[0m18:28:10.121145 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m18:28:10.121145 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:28:10.122146 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:28:10.122146 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:28:10.123144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:28:10.123144 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:28:10.126143 [info ] [Thread-1 (]: 18:28:10 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:28:10.129235 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:28:10.129235 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:28:10.132258 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:28:10.133258 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:28:10.133258 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:28:10.133258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:10.156747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m18:28:10.156747 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:28:10.156747 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:28:10.156747 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:28:10.168872 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:28:10.169267 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:28:10.169267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:10.169267 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:28:10.169267 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:28:10.169267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:10.169267 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:28:10.169267 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:28:10.169267 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:28:10.169267 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:28:10.169267 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:28:10.169267 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:28:10.169267 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:28:10.169267 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:28:10.169267 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:28:10.182803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2C073910>]}
[0m18:28:10.182803 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.06s]
[0m18:28:10.184404 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:28:10.184404 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:28:10.185412 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:28:10.185412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:28:10.186410 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:28:10.192408 [info ] [Thread-1 (]: 18:28:10 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:28:10.205477 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:28:10.206477 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:28:10.219614 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.219614 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp182810219614"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:28:10.219614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:10.257420 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:28:10.266419 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.266419 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:28:10.268239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:28:10.268239 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.268239 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp182810219614'
        
      order by ordinal_position

  
[0m18:28:10.274592 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:28:10.278592 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.279592 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:28:10.281592 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:28:10.286101 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.286101 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:28:10.286101 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:28:10.295324 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:28:10.295324 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.295324 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp182810219614"
    )


  
[0m18:28:10.295324 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m18:28:10.295324 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:28:10.295324 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:28:10.295324 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:28:10.299509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:28:10.299509 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:28:10.302041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2CBC1350>]}
[0m18:28:10.302041 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.12s]
[0m18:28:10.302041 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:28:10.302041 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:28:10.302041 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:28:10.302041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:28:10.302041 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:28:10.314299 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m18:28:10.314299 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m18:28:10.316303 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m18:28:10.318049 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:28:10.318049 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m18:28:10.318049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:10.341868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:28:10.341868 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:28:10.341868 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."sat_mobilite"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                CAST('FFFFFFFF' AS BYTEA)
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:28:10.341868 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
LINE 31:             LAG(
                     ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m18:28:10.341868 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: ROLLBACK
[0m18:28:10.341868 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m18:28:10.352185 [debug] [Thread-1 (]: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:28:10.352185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0245bca1-de2f-471f-9ee7-24fc3c771620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2CC7D650>]}
[0m18:28:10.357376 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.05s]
[0m18:28:10.357376 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:28:10.357376 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql.
[0m18:28:10.357376 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:10.357376 [debug] [MainThread]: On master: BEGIN
[0m18:28:10.357376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:10.385574 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:28:10.385574 [debug] [MainThread]: On master: COMMIT
[0m18:28:10.385574 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:10.385574 [debug] [MainThread]: On master: COMMIT
[0m18:28:10.385574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:28:10.385574 [debug] [MainThread]: On master: Close
[0m18:28:10.385574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:10.385574 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:28:10.385574 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:28:10.385574 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:28:10.385574 [info ] [MainThread]: 
[0m18:28:10.385574 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m18:28:10.385574 [debug] [MainThread]: Command end result
[0m18:28:10.407976 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:28:10.420717 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:28:10.424719 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:28:10.424719 [info ] [MainThread]: 
[0m18:28:10.424719 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:28:10.424719 [info ] [MainThread]: 
[0m18:28:10.424719 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:28:10.424719 [error] [MainThread]:   Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:28:10.424719 [info ] [MainThread]: 
[0m18:28:10.424719 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:28:10.424719 [info ] [MainThread]: 
[0m18:28:10.424719 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:28:10.424719 [debug] [MainThread]: Command `dbt run` failed at 18:28:10.424719 after 1.83 seconds
[0m18:28:10.424719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF29F79290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF29F78F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2407F0D0>]}
[0m18:28:10.424719 [debug] [MainThread]: Flushing usage events
[0m18:28:10.950792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:46.577808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF988E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF990B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF990A910>]}


============================== 18:28:46.577808 | 3f7f9187-8a48-4db0-b8ad-b52673d3116e ==============================
[0m18:28:46.577808 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:28:46.577808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:46.673704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f7f9187-8a48-4db0-b8ad-b52673d3116e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF53E34D0>]}
[0m18:28:46.719835 [debug] [MainThread]: Command `dbt clean` succeeded at 18:28:46.719835 after 0.20 seconds
[0m18:28:46.720862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF990B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF9894850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACF988C290>]}
[0m18:28:46.720862 [debug] [MainThread]: Flushing usage events
[0m18:28:47.163291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:52.754854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0ACF6ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0ACFB08D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0ADFB77D0>]}


============================== 18:28:52.757940 | f3134b2d-746c-487a-9ba1-1128a453d64b ==============================
[0m18:28:52.757940 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:28:52.757940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:28:52.835699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3134b2d-746c-487a-9ba1-1128a453d64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0AE0E2D90>]}
[0m18:28:52.864106 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-8pl4gfew'
[0m18:28:52.864106 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:28:52.982311 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:28:52.982311 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m18:28:53.149956 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m18:28:53.149956 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:28:53.196431 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:28:53.212316 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m18:28:53.562479 [info ] [MainThread]: Installed from version 0.11.2
[0m18:28:53.562479 [info ] [MainThread]: Up to date!
[0m18:28:53.562479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3134b2d-746c-487a-9ba1-1128a453d64b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0ABFA1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0ADFC0990>]}
[0m18:28:53.562479 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:28:53.846238 [info ] [MainThread]: Installed from version 1.3.0
[0m18:28:53.846238 [info ] [MainThread]: Up to date!
[0m18:28:53.861882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3134b2d-746c-487a-9ba1-1128a453d64b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0AE0A8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0ADFC1950>]}
[0m18:28:53.861882 [debug] [MainThread]: Command `dbt deps` succeeded at 18:28:53.861882 after 1.17 seconds
[0m18:28:53.861882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A61BF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A61BFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A61BFC90>]}
[0m18:28:53.861882 [debug] [MainThread]: Flushing usage events
[0m18:28:54.302401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:00.084623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4D3AE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4D3A6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4D3E8E50>]}


============================== 18:29:00.084623 | 1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e ==============================
[0m18:29:00.084623 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:29:00.084623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:29:00.218598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA49C89B50>]}
[0m18:29:00.251930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA49C6FC90>]}
[0m18:29:00.251930 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:29:00.394133 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:29:00.394133 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:29:00.394133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4E634110>]}
[0m18:29:01.999323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4ECC7950>]}
[0m18:29:02.056358 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:29:02.058364 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:29:02.062863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4ECD5010>]}
[0m18:29:02.062863 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:29:02.076492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4EF66750>]}
[0m18:29:02.076492 [info ] [MainThread]: 
[0m18:29:02.076492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:02.076492 [info ] [MainThread]: 
[0m18:29:02.076492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:02.081833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:29:02.182402 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:29:02.182402 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:29:02.182402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:02.218610 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.038 seconds
[0m18:29:02.218610 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:29:02.223156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:29:02.223156 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:29:02.223156 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:29:02.223156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:02.250002 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m18:29:02.250002 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:29:02.250002 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:29:02.250002 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:29:02.250002 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:29:02.250002 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:29:02.265751 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:02.265751 [debug] [MainThread]: On master: BEGIN
[0m18:29:02.265751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:02.397971 [debug] [MainThread]: SQL status: BEGIN in 0.133 seconds
[0m18:29:02.401779 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:02.401779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:02.405783 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:29:02.406784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4ED03250>]}
[0m18:29:02.407784 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:02.407784 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:02.408785 [debug] [MainThread]: On master: BEGIN
[0m18:29:02.408785 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:29:02.409786 [debug] [MainThread]: On master: COMMIT
[0m18:29:02.409786 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:02.410784 [debug] [MainThread]: On master: COMMIT
[0m18:29:02.410784 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:29:02.410784 [debug] [MainThread]: On master: Close
[0m18:29:02.414784 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:29:02.415786 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:29:02.415786 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:29:02.416784 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:29:02.418232 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:29:02.418232 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:29:02.440185 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:29:02.440185 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:29:02.440185 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:29:02.440185 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:02.474485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:29:02.474485 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:29:02.475485 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:29:02.477846 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:29:02.482847 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:29:02.483849 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:29:02.483849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.486339 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:29:02.486339 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:29:02.487341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.496337 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:29:02.497337 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:29:02.497337 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:29:02.499275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:29:02.503280 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:29:02.503280 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:29:02.503280 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:29:02.503280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:29:02.503280 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:29:02.503280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4F212E50>]}
[0m18:29:02.503280 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:29:02.503280 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:29:02.503280 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:29:02.503280 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:29:02.503280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:29:02.503280 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:29:02.516728 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:29:02.516728 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:29:02.522032 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:29:02.522032 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:29:02.523069 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:29:02.523069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:02.552742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:29:02.553160 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:29:02.553160 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:29:02.553160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:29:02.560409 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:29:02.560409 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:29:02.562152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.562152 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:29:02.562152 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:29:02.562152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.562152 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:29:02.562152 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:29:02.562152 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:29:02.568394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:29:02.569733 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:29:02.569733 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:29:02.569733 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:29:02.569733 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:29:02.569733 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:29:02.569733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4E635010>]}
[0m18:29:02.569733 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:29:02.576451 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:29:02.576451 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:29:02.576451 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:29:02.576451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:29:02.576451 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:29:02.576451 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:29:02.576451 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:29:02.576451 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:29:02.576451 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:29:02.585086 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:29:02.585390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:02.721489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m18:29:02.721489 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:29:02.721489 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    encode(
      digest(
        coalesce(cast(id_mobilite as text),'') || '|' ||
        coalesce(cast(date_debut as text),'') || '|' ||
        coalesce(cast(date_fin as text),'') || '|' ||
        coalesce(cast(type_mobilite as text),'') || '|' ||
        coalesce(cast(statut_mobilite as text),''),
        'sha256'
      ),
      'hex'
    ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m18:29:02.721489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:29:02.721489 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:29:02.721489 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:29:02.735744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:29:02.737828 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:29:02.737828 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:29:02.738829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.739828 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:29:02.739828 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:29:02.739828 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:29:02.742031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:29:02.744036 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:29:02.745037 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:29:02.746037 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:29:02.746938 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:29:02.746938 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:29:02.747946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4F3A3CD0>]}
[0m18:29:02.748944 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m18:29:02.749944 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:29:02.749944 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:29:02.750944 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:29:02.750944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:29:02.750944 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:29:02.758941 [info ] [Thread-1 (]: 18:29:02 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:29:02.761948 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:29:02.763016 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:29:02.775254 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:29:02.775254 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:29:02.775254 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:29:02.775254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:02.802779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:29:02.802779 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:29:02.802779 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:29:02.802779 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:29:02.802779 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:29:02.802779 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:29:02.817119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.819452 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:29:02.819452 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:29:02.820451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.821451 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:29:02.821451 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:29:02.821451 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:29:02.823696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:29:02.825699 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:29:02.826700 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:29:02.827699 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:29:02.830700 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:29:02.830700 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:29:02.832699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4EBC7810>]}
[0m18:29:02.832699 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.08s]
[0m18:29:02.834699 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:29:02.834699 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:29:02.835230 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:29:02.835230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:29:02.836274 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:29:02.840272 [info ] [Thread-1 (]: 18:29:02 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:29:02.842758 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:29:02.843759 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:29:02.846757 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:29:02.846757 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:29:02.847773 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:29:02.847773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:02.874917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:29:02.874917 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:29:02.874917 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:29:02.874917 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:29:02.874917 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:29:02.874917 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:29:02.885214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:29:02.886734 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:29:02.886734 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:29:02.886734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:29:02.886734 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:29:02.886734 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:29:02.886734 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:29:02.886734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:29:02.886734 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:29:02.886734 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:29:02.886734 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:29:02.886734 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:29:02.886734 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:29:02.886734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4F3C4B50>]}
[0m18:29:02.886734 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.05s]
[0m18:29:02.901769 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:29:02.902778 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:29:02.902778 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:29:02.902778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:29:02.902778 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:29:02.902778 [info ] [Thread-1 (]: 18:29:02 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:29:02.910939 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:29:02.912940 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:29:02.920102 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:02.920102 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp182902920102"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:29:02.920102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:02.953514 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m18:29:02.969926 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:02.969926 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:29:02.969926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:29:02.969926 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:02.969926 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp182902920102'
        
      order by ordinal_position

  
[0m18:29:02.977874 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:29:02.986161 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:02.986161 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:29:02.988160 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:29:02.994159 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:02.994159 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:29:02.996161 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:29:03.003029 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:29:03.004029 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:03.004029 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp182902920102"
    )


  
[0m18:29:03.006029 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:29:03.007029 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:29:03.007029 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:29:03.008027 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:29:03.009310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:29:03.010320 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:29:03.011314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4F21F090>]}
[0m18:29:03.011314 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m18:29:03.012315 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:29:03.012315 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:29:03.013317 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:29:03.013317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:29:03.014316 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:29:03.019821 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m18:29:03.019821 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m18:29:03.019821 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m18:29:03.019821 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:29:03.019821 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m18:29:03.019821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:03.057765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m18:29:03.058764 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:29:03.058764 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."sat_mobilite"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                CAST('FFFFFFFF' AS BYTEA)
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:29:03.058764 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
LINE 31:             LAG(
                     ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m18:29:03.058764 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: ROLLBACK
[0m18:29:03.058764 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m18:29:03.058764 [debug] [Thread-1 (]: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:29:03.058764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac7d7dc-7f93-408c-bac6-e2f4fbc4060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4F30CCD0>]}
[0m18:29:03.058764 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.05s]
[0m18:29:03.058764 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:29:03.068398 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql.
[0m18:29:03.069789 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:03.069789 [debug] [MainThread]: On master: BEGIN
[0m18:29:03.069789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:03.091525 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:29:03.091525 [debug] [MainThread]: On master: COMMIT
[0m18:29:03.091525 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:03.091525 [debug] [MainThread]: On master: COMMIT
[0m18:29:03.091525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:29:03.091525 [debug] [MainThread]: On master: Close
[0m18:29:03.102769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:03.103280 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:29:03.103280 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:29:03.103280 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:29:03.103280 [info ] [MainThread]: 
[0m18:29:03.103280 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m18:29:03.103280 [debug] [MainThread]: Command end result
[0m18:29:03.126868 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:29:03.126868 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:29:03.137389 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:29:03.137389 [info ] [MainThread]: 
[0m18:29:03.138395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:29:03.138395 [info ] [MainThread]: 
[0m18:29:03.138395 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:29:03.139393 [error] [MainThread]:   Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:29:03.139393 [info ] [MainThread]: 
[0m18:29:03.139393 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:29:03.140394 [info ] [MainThread]: 
[0m18:29:03.140394 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:29:03.141393 [debug] [MainThread]: Command `dbt run` failed at 18:29:03.141393 after 3.11 seconds
[0m18:29:03.141393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4E3F7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4C548E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4C548F10>]}
[0m18:29:03.141393 [debug] [MainThread]: Flushing usage events
[0m18:29:03.619762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:25.276330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86C35E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86C3A2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86C35EFD0>]}


============================== 18:31:25.276330 | a6a8b6d4-8eef-4e88-b070-19dd9b4ac470 ==============================
[0m18:31:25.276330 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:31:25.276330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:31:25.403087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F868E81C50>]}
[0m18:31:25.434952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F868C1F690>]}
[0m18:31:25.434952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:31:25.568055 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:31:25.712449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:25.712449 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\staging\stg_mobilite.sql
[0m18:31:26.044014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86DCD1150>]}
[0m18:31:26.091556 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:31:26.091556 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:31:26.109644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86DA405D0>]}
[0m18:31:26.109644 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:31:26.109644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86DC00910>]}
[0m18:31:26.109644 [info ] [MainThread]: 
[0m18:31:26.109644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:26.109644 [info ] [MainThread]: 
[0m18:31:26.109644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:26.124351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:31:26.214226 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:31:26.215226 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:31:26.215226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:26.249367 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.037 seconds
[0m18:31:26.253743 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:31:26.253743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:31:26.253743 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:31:26.253743 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:31:26.253743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:26.286962 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:31:26.286962 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:31:26.286962 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:31:26.286962 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:31:26.286962 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:31:26.286962 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:31:26.300476 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:26.300476 [debug] [MainThread]: On master: BEGIN
[0m18:31:26.300476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:26.326316 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m18:31:26.326316 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:26.326316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:26.332539 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:31:26.332539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86DED9810>]}
[0m18:31:26.336479 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:26.336479 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:26.336479 [debug] [MainThread]: On master: BEGIN
[0m18:31:26.336479 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:31:26.336479 [debug] [MainThread]: On master: COMMIT
[0m18:31:26.336479 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:26.336479 [debug] [MainThread]: On master: COMMIT
[0m18:31:26.336479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:31:26.336479 [debug] [MainThread]: On master: Close
[0m18:31:26.336479 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:31:26.336479 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:31:26.336479 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:31:26.336479 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:31:26.348622 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:31:26.349506 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:31:26.354993 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:31:26.370128 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:31:26.370128 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:31:26.371350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:26.400647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:31:26.401646 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:31:26.401646 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:31:26.403340 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:31:26.403340 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:31:26.403340 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:31:26.403340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:31:26.403340 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:31:26.403340 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:31:26.403340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:31:26.418671 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:31:26.418671 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:31:26.418671 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:31:26.418671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:31:26.418671 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:31:26.418671 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:31:26.418671 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:31:26.434587 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:31:26.434587 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:31:26.434587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E1F8190>]}
[0m18:31:26.434587 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:31:26.434587 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:31:26.434587 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:31:26.434587 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:31:26.434587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:31:26.434587 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:31:26.434587 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:31:26.434587 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:31:26.434587 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:31:26.434587 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:31:26.434587 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:31:26.434587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.473909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:31:26.473909 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:31:26.473909 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:31:26.473909 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:31:26.473909 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:31:26.473909 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:31:26.486769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:31:26.487870 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:31:26.487870 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:31:26.487870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:31:26.487870 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:31:26.487870 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:31:26.487870 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:31:26.487870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:31:26.487870 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:31:26.487870 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:31:26.487870 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:31:26.487870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:31:26.487870 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:31:26.487870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E33FE50>]}
[0m18:31:26.487870 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:31:26.487870 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:31:26.487870 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:31:26.487870 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:31:26.487870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:31:26.487870 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:31:26.504368 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:31:26.505373 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:31:26.508369 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:31:26.509369 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:31:26.509369 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:31:26.510372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.540766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m18:31:26.541771 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:31:26.541771 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m18:31:26.542768 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:31:26.542768 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:31:26.542768 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:31:26.542768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:31:26.542768 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:31:26.542768 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:31:26.542768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:31:26.542768 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:31:26.542768 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:31:26.553546 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:31:26.555225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:31:26.555225 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:31:26.555225 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:31:26.555225 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:31:26.555225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:31:26.555225 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:31:26.555225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E1BCE10>]}
[0m18:31:26.555225 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:31:26.562752 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:31:26.562752 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:31:26.562752 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:31:26.562752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:31:26.562752 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:31:26.576551 [info ] [Thread-1 (]: 18:31:26 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:31:26.609824 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:31:26.609824 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:31:26.621548 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:31:26.621548 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:31:26.621548 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:31:26.621548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.660564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:31:26.661564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:31:26.661564 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:31:26.665563 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:31:26.670613 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:31:26.671708 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:31:26.671708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:31:26.673703 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:31:26.674703 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:31:26.674703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:31:26.675705 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:31:26.676704 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:31:26.676704 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:31:26.678372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:31:26.680375 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:31:26.682375 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:31:26.682375 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:31:26.685376 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:31:26.686846 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:31:26.686846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86DC58ED0>]}
[0m18:31:26.687880 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.12s]
[0m18:31:26.688881 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:31:26.688881 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:31:26.689881 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:31:26.689881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:31:26.689881 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:31:26.693879 [info ] [Thread-1 (]: 18:31:26 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:31:26.696334 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:31:26.697334 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:31:26.700332 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:31:26.700332 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:31:26.701335 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:31:26.701335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.721715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:31:26.721715 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:31:26.721715 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:31:26.721715 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:31:26.737722 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:31:26.737722 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:31:26.737722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:31:26.737722 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:31:26.737722 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:31:26.737722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:31:26.737722 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:31:26.737722 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:31:26.737722 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:31:26.737722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:31:26.737722 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:31:26.737722 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:31:26.737722 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:31:26.753348 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:31:26.755357 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:31:26.755865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E3CF590>]}
[0m18:31:26.755865 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m18:31:26.756872 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:31:26.756872 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:31:26.757879 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:31:26.757879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:31:26.758877 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:31:26.763875 [info ] [Thread-1 (]: 18:31:26 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:31:26.772380 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:31:26.772380 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:31:26.792747 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.792747 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp183126790747"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:31:26.792747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.827284 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m18:31:26.836283 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.836283 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:31:26.838118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:31:26.839116 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.839116 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp183126790747'
        
      order by ordinal_position

  
[0m18:31:26.845120 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:31:26.920048 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.920048 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:31:26.920048 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:31:26.935217 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.935217 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:31:26.935217 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:31:26.935217 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:31:26.935217 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.935217 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp183126790747"
    )


  
[0m18:31:26.935217 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:31:26.935217 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:31:26.935217 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:31:26.935217 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:31:26.951105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:31:26.951105 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:31:26.951105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E42E990>]}
[0m18:31:26.951105 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.19s]
[0m18:31:26.951105 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:31:26.951105 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:31:26.951105 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:31:26.955800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:31:26.955800 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:31:26.987992 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m18:31:26.989276 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m18:31:26.992275 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m18:31:26.994277 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:31:26.994277 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m18:31:26.994277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:27.022654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:31:27.023659 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:31:27.024658 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."sat_mobilite"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                CAST('FFFFFFFF' AS BYTEA)
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:31:27.025676 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
LINE 31:             LAG(
                     ^
HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
Vous devez ajouter des conversions explicites de type.

[0m18:31:27.025676 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: ROLLBACK
[0m18:31:27.026658 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m18:31:27.032872 [debug] [Thread-1 (]: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:31:27.032872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a8b6d4-8eef-4e88-b070-19dd9b4ac470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E130CD0>]}
[0m18:31:27.033872 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model public.sat_mobilite ................ [[31mERROR[0m in 0.08s]
[0m18:31:27.033872 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:31:27.034872 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.sat_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql.
[0m18:31:27.036824 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:27.036824 [debug] [MainThread]: On master: BEGIN
[0m18:31:27.036824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:27.060008 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m18:31:27.060008 [debug] [MainThread]: On master: COMMIT
[0m18:31:27.060008 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:27.060008 [debug] [MainThread]: On master: COMMIT
[0m18:31:27.060008 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:31:27.060008 [debug] [MainThread]: On master: Close
[0m18:31:27.060008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:27.060008 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:31:27.060008 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:31:27.060008 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:31:27.069998 [info ] [MainThread]: 
[0m18:31:27.069998 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m18:31:27.070993 [debug] [MainThread]: Command end result
[0m18:31:27.092667 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:31:27.092667 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:31:27.106918 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:31:27.106918 [info ] [MainThread]: 
[0m18:31:27.107919 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:27.108917 [info ] [MainThread]: 
[0m18:31:27.108917 [error] [MainThread]: [31mFailure in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)[0m
[0m18:31:27.109917 [error] [MainThread]:   Database Error in model sat_mobilite (dbt/sid-lite/models\vault\sat_mobilite.sql)
  ERREUR:  la fonction lag(text, integer, bytea) n'existe pas
  LINE 31:             LAG(
                       ^
  HINT:  Aucune fonction ne correspond au nom donné et aux types d'arguments.
  Vous devez ajouter des conversions explicites de type.
  compiled code at target\run\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:31:27.109917 [info ] [MainThread]: 
[0m18:31:27.109917 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\vault\sat_mobilite.sql
[0m18:31:27.109917 [info ] [MainThread]: 
[0m18:31:27.109917 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:31:27.109917 [debug] [MainThread]: Command `dbt run` failed at 18:31:27.109917 after 1.90 seconds
[0m18:31:27.109917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86D9A2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86D634850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86D637510>]}
[0m18:31:27.109917 [debug] [MainThread]: Flushing usage events
[0m18:31:27.665911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:05.320244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B652E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B7577F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B7577390>]}


============================== 18:48:05.320244 | b7120495-42b9-4f83-a4d9-2443ef5bcd0e ==============================
[0m18:48:05.320244 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:48:05.320244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:48:05.445082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B76C3CD0>]}
[0m18:48:05.492615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B2DEDE10>]}
[0m18:48:05.492615 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:05.620023 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:48:05.763355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:05.765359 [debug] [MainThread]: Partial parsing: updated file: automate_dv://macros\tables\postgres\sat.sql
[0m18:48:06.073620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B766D050>]}
[0m18:48:06.126928 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:48:06.126928 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:48:06.144827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B778EF90>]}
[0m18:48:06.144827 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m18:48:06.144827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B7B690D0>]}
[0m18:48:06.144827 [info ] [MainThread]: 
[0m18:48:06.144827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:06.144827 [info ] [MainThread]: 
[0m18:48:06.150608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:06.150608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m18:48:06.248138 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m18:48:06.248138 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m18:48:06.248138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:06.281133 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.040 seconds
[0m18:48:06.281133 [debug] [ThreadPool]: On list_sid_lite: Close
[0m18:48:06.281133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m18:48:06.295675 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:48:06.295675 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m18:48:06.295675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:06.317267 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:48:06.317267 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m18:48:06.317267 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:06.330832 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m18:48:06.330832 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m18:48:06.330832 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m18:48:06.336637 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.336637 [debug] [MainThread]: On master: BEGIN
[0m18:48:06.338642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:06.360536 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m18:48:06.360536 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.360536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:06.360536 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m18:48:06.360536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B76DFA10>]}
[0m18:48:06.360536 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:06.360536 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.360536 [debug] [MainThread]: On master: BEGIN
[0m18:48:06.360536 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:48:06.360536 [debug] [MainThread]: On master: COMMIT
[0m18:48:06.360536 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.360536 [debug] [MainThread]: On master: COMMIT
[0m18:48:06.376262 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:06.376262 [debug] [MainThread]: On master: Close
[0m18:48:06.376262 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m18:48:06.376262 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m18:48:06.376262 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m18:48:06.376262 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m18:48:06.376262 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m18:48:06.376262 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m18:48:06.398597 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m18:48:06.398597 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:48:06.398597 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m18:48:06.398597 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:48:06.435303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:48:06.436309 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:48:06.436309 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m18:48:06.439051 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:06.444052 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:48:06.444052 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m18:48:06.445054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:06.448059 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:48:06.448059 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m18:48:06.448059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:06.448059 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:48:06.448059 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:48:06.448059 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m18:48:06.448059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:06.463793 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m18:48:06.463793 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m18:48:06.463793 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m18:48:06.463793 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:06.463793 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m18:48:06.463793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B76D6010>]}
[0m18:48:06.463793 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:48:06.463793 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m18:48:06.463793 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m18:48:06.463793 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m18:48:06.463793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m18:48:06.463793 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m18:48:06.463793 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m18:48:06.463793 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m18:48:06.481076 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m18:48:06.482088 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:48:06.482088 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m18:48:06.482088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.499087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m18:48:06.499087 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:48:06.499087 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m18:48:06.499087 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:06.515477 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:48:06.516621 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m18:48:06.517619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:06.519619 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:48:06.519619 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m18:48:06.519619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:06.520620 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:48:06.520620 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:48:06.520620 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m18:48:06.520620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:06.520620 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m18:48:06.520620 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m18:48:06.520620 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m18:48:06.520620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:06.520620 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m18:48:06.520620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B82E42D0>]}
[0m18:48:06.520620 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:48:06.520620 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m18:48:06.520620 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m18:48:06.520620 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m18:48:06.531090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m18:48:06.531090 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m18:48:06.532353 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m18:48:06.532353 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m18:48:06.532353 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m18:48:06.532353 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:48:06.532353 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m18:48:06.532353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.568847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m18:48:06.569852 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:48:06.569852 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m18:48:06.571850 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:48:06.571850 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:48:06.571850 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m18:48:06.571850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:06.571850 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:48:06.571850 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m18:48:06.571850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:06.581214 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:48:06.581214 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:48:06.582220 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m18:48:06.582986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:06.582986 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m18:48:06.582986 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m18:48:06.582986 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m18:48:06.582986 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:06.582986 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m18:48:06.582986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B81D5B90>]}
[0m18:48:06.582986 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:48:06.582986 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m18:48:06.582986 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m18:48:06.582986 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m18:48:06.582986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m18:48:06.582986 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m18:48:06.604628 [info ] [Thread-1 (]: 18:48:06 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m18:48:06.610645 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m18:48:06.614659 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m18:48:06.616183 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m18:48:06.616183 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:48:06.616183 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m18:48:06.616183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.649542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m18:48:06.649542 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:48:06.649542 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:48:06.649542 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.004 seconds
[0m18:48:06.665637 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:48:06.665637 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m18:48:06.665637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:06.665637 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:48:06.665637 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m18:48:06.665637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:06.665637 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:48:06.665637 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:48:06.665637 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m18:48:06.665637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:06.665637 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m18:48:06.665637 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m18:48:06.665637 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m18:48:06.682258 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:48:06.683261 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m18:48:06.684261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B83C6990>]}
[0m18:48:06.685261 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.10s]
[0m18:48:06.685261 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m18:48:06.686261 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m18:48:06.686261 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m18:48:06.687258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m18:48:06.687258 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m18:48:06.690256 [info ] [Thread-1 (]: 18:48:06 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m18:48:06.693256 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m18:48:06.693806 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m18:48:06.696847 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m18:48:06.697847 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:48:06.697847 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m18:48:06.698849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.720691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:48:06.720691 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:48:06.720691 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m18:48:06.732415 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m18:48:06.732415 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:48:06.732415 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m18:48:06.732415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:06.732415 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:48:06.732415 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m18:48:06.732415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:06.732415 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:48:06.732415 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:48:06.732415 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m18:48:06.732415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:06.748962 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m18:48:06.749959 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m18:48:06.749959 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m18:48:06.751897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:48:06.752905 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m18:48:06.753904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B83B89D0>]}
[0m18:48:06.753904 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.07s]
[0m18:48:06.754905 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m18:48:06.755901 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m18:48:06.755901 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m18:48:06.756901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m18:48:06.756901 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m18:48:06.761900 [info ] [Thread-1 (]: 18:48:06 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m18:48:06.769043 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m18:48:06.769043 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m18:48:06.787460 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.787460 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp184806787460"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:48:06.787460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.815770 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:48:06.835428 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.836431 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m18:48:06.837427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:48:06.838426 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.839428 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp184806787460'
        
      order by ordinal_position

  
[0m18:48:06.845426 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:48:06.851185 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.851185 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:48:06.854188 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:48:06.859185 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.859185 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:48:06.861186 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m18:48:06.865185 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m18:48:06.865185 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.865185 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp184806787460"
    )


  
[0m18:48:06.865185 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m18:48:06.865185 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:48:06.865185 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m18:48:06.865185 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m18:48:06.865185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:06.865185 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m18:48:06.865185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B83FE990>]}
[0m18:48:06.865185 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.11s]
[0m18:48:06.865185 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m18:48:06.865185 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m18:48:06.865185 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m18:48:06.865185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m18:48:06.865185 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m18:48:06.881026 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m18:48:06.881026 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m18:48:06.881026 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m18:48:06.881026 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:48:06.881026 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m18:48:06.881026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.919107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m18:48:06.920112 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:48:06.920112 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      
  
    

  create  table "sid_lite"."public"."sat_mobilite"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                'FFFFFFFF'
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:48:06.927874 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.007 seconds
[0m18:48:06.927874 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m18:48:06.927874 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m18:48:06.927874 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m18:48:06.931258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:06.932622 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m18:48:06.932622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7120495-42b9-4f83-a4d9-2443ef5bcd0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B8410A10>]}
[0m18:48:06.932622 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model public.sat_mobilite .................... [[32mSELECT 500[0m in 0.07s]
[0m18:48:06.932622 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m18:48:06.935626 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.935626 [debug] [MainThread]: On master: BEGIN
[0m18:48:06.935626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:06.954479 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m18:48:06.954479 [debug] [MainThread]: On master: COMMIT
[0m18:48:06.954479 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.954479 [debug] [MainThread]: On master: COMMIT
[0m18:48:06.954479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:06.954479 [debug] [MainThread]: On master: Close
[0m18:48:06.964765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:06.965771 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m18:48:06.965771 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m18:48:06.965771 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m18:48:06.965771 [info ] [MainThread]: 
[0m18:48:06.966615 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m18:48:06.966615 [debug] [MainThread]: Command end result
[0m18:48:07.071097 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m18:48:07.074085 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m18:48:07.078080 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m18:48:07.078080 [info ] [MainThread]: 
[0m18:48:07.079085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:07.079085 [info ] [MainThread]: 
[0m18:48:07.080082 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:48:07.081082 [debug] [MainThread]: Command `dbt run` succeeded at 18:48:07.081082 after 1.82 seconds
[0m18:48:07.081082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B6202050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1AF79F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1AF79F0D0>]}
[0m18:48:07.081082 [debug] [MainThread]: Flushing usage events
[0m18:48:07.597751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:08.520351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E15CEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E1611890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E1612910>]}


============================== 20:02:08.536071 | af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2 ==============================
[0m20:02:08.536071 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:02:08.536071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:08.662553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E270E210>]}
[0m20:02:08.694476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9DDE9B8D0>]}
[0m20:02:08.694476 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:02:08.830432 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m20:02:08.975720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:08.975720 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\vault\schema.yml
[0m20:02:09.007563 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sta_mobilite' in the 'models' section of file 'dbt/sid-lite/models\vault\schema.yml'
[0m20:02:09.145675 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.unique_sta_mobilite_id_mobilite.5b57ec8b68' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'sta_mobilite' in package '' which was not found
[0m20:02:09.145675 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sid_lite.not_null_sta_mobilite_id_mobilite.7550485660' (dbt/sid-lite/models\vault\schema.yml) depends on a node named 'sta_mobilite' in package '' which was not found
[0m20:02:09.205263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E2EBCE50>]}
[0m20:02:09.261300 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m20:02:09.264019 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m20:02:09.281870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E3073F90>]}
[0m20:02:09.281870 [info ] [MainThread]: Found 7 models, 3 seeds, 12 data tests, 821 macros
[0m20:02:09.281870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E27DDB90>]}
[0m20:02:09.287702 [info ] [MainThread]: 
[0m20:02:09.287702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:02:09.287702 [info ] [MainThread]: 
[0m20:02:09.287702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:02:09.290399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m20:02:09.386452 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m20:02:09.387453 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m20:02:09.387453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:09.419476 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m20:02:09.419476 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m20:02:09.419476 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:02:09.419476 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m20:02:09.419476 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m20:02:09.419476 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m20:02:09.433162 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:09.433162 [debug] [MainThread]: On master: BEGIN
[0m20:02:09.433162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:09.461973 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m20:02:09.461973 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:09.461973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:02:09.465992 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m20:02:09.470013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af06e4b4-9423-4a7b-bb65-5eb1b7dbbdd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E27BF290>]}
[0m20:02:09.470013 [debug] [MainThread]: On master: ROLLBACK
[0m20:02:09.470013 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:09.470013 [debug] [MainThread]: On master: BEGIN
[0m20:02:09.470013 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:02:09.470013 [debug] [MainThread]: On master: COMMIT
[0m20:02:09.470013 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:09.470013 [debug] [MainThread]: On master: COMMIT
[0m20:02:09.470013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:09.470013 [debug] [MainThread]: On master: Close
[0m20:02:09.470013 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m20:02:09.470013 [info ] [Thread-1 (]: 1 of 12 START test not_null_hub_etablissement_oid_etablissement ................ [RUN]
[0m20:02:09.477756 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee'
[0m20:02:09.477756 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m20:02:09.477756 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m20:02:09.477756 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m20:02:09.498519 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m20:02:09.499579 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m20:02:09.499579 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: BEGIN
[0m20:02:09.501085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:02:09.528580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m20:02:09.529579 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m20:02:09.529579 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m20:02:09.532059 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:09.534101 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: ROLLBACK
[0m20:02:09.535101 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: Close
[0m20:02:09.536102 [info ] [Thread-1 (]: 1 of 12 PASS not_null_hub_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.06s]
[0m20:02:09.537103 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m20:02:09.537103 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m20:02:09.538102 [info ] [Thread-1 (]: 2 of 12 START test not_null_hub_etudiant_id_etudiant ........................... [RUN]
[0m20:02:09.538102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee, now test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22)
[0m20:02:09.538102 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m20:02:09.541101 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m20:02:09.542101 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m20:02:09.544101 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m20:02:09.545101 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m20:02:09.545101 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: BEGIN
[0m20:02:09.545101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.571344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m20:02:09.571344 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m20:02:09.571344 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."hub_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m20:02:09.571344 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.571344 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: ROLLBACK
[0m20:02:09.571344 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: Close
[0m20:02:09.571344 [info ] [Thread-1 (]: 2 of 12 PASS not_null_hub_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.03s]
[0m20:02:09.571344 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m20:02:09.571344 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m20:02:09.571344 [info ] [Thread-1 (]: 3 of 12 START test not_null_link_mobilite_id_mobilite .......................... [RUN]
[0m20:02:09.571344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22, now test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab)
[0m20:02:09.581215 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m20:02:09.582225 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m20:02:09.582225 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m20:02:09.588440 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m20:02:09.588440 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m20:02:09.588440 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: BEGIN
[0m20:02:09.588440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.618518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m20:02:09.619517 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m20:02:09.619517 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."link_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m20:02:09.620517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.621518 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: ROLLBACK
[0m20:02:09.621518 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: Close
[0m20:02:09.621518 [info ] [Thread-1 (]: 3 of 12 PASS not_null_link_mobilite_id_mobilite ................................ [[32mPASS[0m in 0.05s]
[0m20:02:09.625247 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m20:02:09.625247 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m20:02:09.625247 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m20:02:09.625247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m20:02:09.625247 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m20:02:09.630564 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m20:02:09.632355 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m20:02:09.635039 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m20:02:09.636041 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m20:02:09.636041 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m20:02:09.637039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.664546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m20:02:09.664546 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m20:02:09.666120 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m20:02:09.668214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.669212 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m20:02:09.669212 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m20:02:09.670213 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.04s]
[0m20:02:09.671215 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m20:02:09.671215 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m20:02:09.671215 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m20:02:09.671215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m20:02:09.671215 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m20:02:09.671215 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m20:02:09.671215 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m20:02:09.671215 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m20:02:09.671215 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m20:02:09.671215 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m20:02:09.671215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.706851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m20:02:09.706851 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m20:02:09.706851 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m20:02:09.706851 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:09.706851 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m20:02:09.714571 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m20:02:09.715659 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.04s]
[0m20:02:09.716010 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m20:02:09.716010 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m20:02:09.716010 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m20:02:09.716010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m20:02:09.716010 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m20:02:09.721543 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m20:02:09.721543 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m20:02:09.724105 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m20:02:09.724105 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m20:02:09.724105 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m20:02:09.724105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.752769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m20:02:09.754769 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m20:02:09.754769 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m20:02:09.754769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.754769 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m20:02:09.754769 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m20:02:09.754769 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.04s]
[0m20:02:09.754769 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m20:02:09.760610 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m20:02:09.760610 [info ] [Thread-1 (]: 7 of 12 START test unique_hub_etablissement_oid_etablissement .................. [RUN]
[0m20:02:09.760610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5)
[0m20:02:09.760610 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m20:02:09.766553 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m20:02:09.767589 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m20:02:09.769585 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m20:02:09.770588 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m20:02:09.771586 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: BEGIN
[0m20:02:09.771586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.801527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m20:02:09.801527 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m20:02:09.801527 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:02:09.803527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.804528 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: ROLLBACK
[0m20:02:09.804528 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: Close
[0m20:02:09.804528 [info ] [Thread-1 (]: 7 of 12 PASS unique_hub_etablissement_oid_etablissement ........................ [[32mPASS[0m in 0.04s]
[0m20:02:09.804528 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m20:02:09.804528 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m20:02:09.804528 [info ] [Thread-1 (]: 8 of 12 START test unique_hub_etudiant_id_etudiant ............................. [RUN]
[0m20:02:09.804528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5, now test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466)
[0m20:02:09.804528 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m20:02:09.810270 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m20:02:09.812276 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m20:02:09.814585 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m20:02:09.816396 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m20:02:09.816396 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: BEGIN
[0m20:02:09.816396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.837949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m20:02:09.837949 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m20:02:09.837949 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:02:09.837949 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.847949 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: ROLLBACK
[0m20:02:09.848981 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: Close
[0m20:02:09.849456 [info ] [Thread-1 (]: 8 of 12 PASS unique_hub_etudiant_id_etudiant ................................... [[32mPASS[0m in 0.04s]
[0m20:02:09.849456 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m20:02:09.849456 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m20:02:09.849456 [info ] [Thread-1 (]: 9 of 12 START test unique_link_mobilite_id_mobilite ............................ [RUN]
[0m20:02:09.849456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466, now test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530)
[0m20:02:09.849456 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m20:02:09.849456 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m20:02:09.849456 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m20:02:09.849456 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m20:02:09.849456 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m20:02:09.849456 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: BEGIN
[0m20:02:09.849456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.888054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m20:02:09.888054 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m20:02:09.888054 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:02:09.888054 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.888054 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: ROLLBACK
[0m20:02:09.888054 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: Close
[0m20:02:09.888054 [info ] [Thread-1 (]: 9 of 12 PASS unique_link_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.04s]
[0m20:02:09.888054 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m20:02:09.888054 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m20:02:09.888054 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m20:02:09.888054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m20:02:09.888054 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m20:02:09.898950 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m20:02:09.898950 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m20:02:09.898950 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m20:02:09.898950 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m20:02:09.898950 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m20:02:09.898950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.934433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m20:02:09.935258 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m20:02:09.935258 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:02:09.936522 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:02:09.937851 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m20:02:09.937851 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m20:02:09.937851 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.05s]
[0m20:02:09.937851 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m20:02:09.937851 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m20:02:09.937851 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m20:02:09.937851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m20:02:09.937851 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m20:02:09.937851 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m20:02:09.937851 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m20:02:09.947907 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m20:02:09.948915 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m20:02:09.949915 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m20:02:09.949915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:09.973927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m20:02:09.973927 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m20:02:09.973927 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:02:09.973927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:09.981308 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m20:02:09.981308 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m20:02:09.982417 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.04s]
[0m20:02:09.983417 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m20:02:09.983417 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m20:02:09.983417 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m20:02:09.983417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m20:02:09.983417 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m20:02:09.983417 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m20:02:09.983417 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m20:02:09.983417 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m20:02:09.983417 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m20:02:09.983417 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m20:02:09.983417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:10.021894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m20:02:10.021894 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m20:02:10.021894 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:02:10.021894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:02:10.021894 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m20:02:10.021894 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m20:02:10.021894 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.04s]
[0m20:02:10.021894 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m20:02:10.021894 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:10.021894 [debug] [MainThread]: On master: BEGIN
[0m20:02:10.021894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:10.054783 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m20:02:10.054783 [debug] [MainThread]: On master: COMMIT
[0m20:02:10.054783 [debug] [MainThread]: Using postgres connection "master"
[0m20:02:10.054783 [debug] [MainThread]: On master: COMMIT
[0m20:02:10.054783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:02:10.054783 [debug] [MainThread]: On master: Close
[0m20:02:10.054783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:10.054783 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m20:02:10.054783 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m20:02:10.054783 [info ] [MainThread]: 
[0m20:02:10.054783 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m20:02:10.054783 [debug] [MainThread]: Command end result
[0m20:02:10.086349 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m20:02:10.088348 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m20:02:10.088348 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m20:02:10.088348 [info ] [MainThread]: 
[0m20:02:10.088348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:10.088348 [info ] [MainThread]: 
[0m20:02:10.088348 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m20:02:10.088348 [debug] [MainThread]: Command `dbt test` succeeded at 20:02:10.088348 after 1.64 seconds
[0m20:02:10.097944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E15DC410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E1612710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9E2E9EBD0>]}
[0m20:02:10.097944 [debug] [MainThread]: Flushing usage events
[0m20:02:10.531785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:35.549600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6332E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6336A1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6437B690>]}


============================== 21:24:35.564209 | 34c59557-c6db-4b4f-8960-5ecd0cd43dc9 ==============================
[0m21:24:35.564209 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:24:35.564209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m21:24:35.841823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34c59557-c6db-4b4f-8960-5ecd0cd43dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E644A3790>]}
[0m21:24:35.996056 [debug] [MainThread]: Command `dbt clean` succeeded at 21:24:35.994903 after 0.75 seconds
[0m21:24:35.996056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E63334850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E63002190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E5C929210>]}
[0m21:24:35.996056 [debug] [MainThread]: Flushing usage events
[0m21:24:36.510951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:46.329812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D593FDF550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5940221D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5940204D0>]}


============================== 21:24:46.335632 | d0c254ed-f7d3-4758-bde7-550470de0114 ==============================
[0m21:24:46.335632 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:24:46.335632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:24:46.449416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c254ed-f7d3-4758-bde7-550470de0114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D593D8FB90>]}
[0m21:24:46.515073 [debug] [MainThread]: Set downloads directory='C:\Users\jpvt\AppData\Local\Temp\dbt-downloads-8l_iui9f'
[0m21:24:46.515073 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:24:46.689082 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:24:46.689082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m21:24:46.868902 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m21:24:46.875292 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:24:46.966340 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:24:46.974261 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m21:24:47.575139 [info ] [MainThread]: Installed from version 0.11.2
[0m21:24:47.575139 [info ] [MainThread]: Up to date!
[0m21:24:47.578117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0c254ed-f7d3-4758-bde7-550470de0114', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D59523CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5950304D0>]}
[0m21:24:47.580153 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:24:48.162144 [info ] [MainThread]: Installed from version 1.3.0
[0m21:24:48.165352 [info ] [MainThread]: Up to date!
[0m21:24:48.167657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0c254ed-f7d3-4758-bde7-550470de0114', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D59523D590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D59523E890>]}
[0m21:24:48.173674 [debug] [MainThread]: Command `dbt deps` succeeded at 21:24:48.173674 after 1.93 seconds
[0m21:24:48.173674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D593180890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D58D28F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D58D28FCD0>]}
[0m21:24:48.175687 [debug] [MainThread]: Flushing usage events
[0m21:24:48.602341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:58.189290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206475CE190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064737F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020647611B90>]}


============================== 21:24:58.195522 | 14b9e484-fee3-40b2-8847-976a80ffaaf5 ==============================
[0m21:24:58.195522 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:24:58.195522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:24:58.468425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020648763E50>]}
[0m21:24:58.526321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020643E7F610>]}
[0m21:24:58.526321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:24:58.763897 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m21:24:58.781538 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:24:58.827607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206475C7B90>]}
[0m21:25:02.300756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020648F0C690>]}
[0m21:25:02.370089 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m21:25:02.412056 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m21:25:02.462694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020648EF6790>]}
[0m21:25:02.462694 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 822 macros
[0m21:25:02.464442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064654FD10>]}
[0m21:25:02.466351 [info ] [MainThread]: 
[0m21:25:02.466351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:25:02.466351 [info ] [MainThread]: 
[0m21:25:02.468726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:02.474748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m21:25:02.802153 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m21:25:02.802153 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m21:25:02.802153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:03.067854 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.266 seconds
[0m21:25:03.067854 [debug] [ThreadPool]: On list_sid_lite: Close
[0m21:25:03.075702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m21:25:03.082143 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m21:25:03.083187 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m21:25:03.083187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:03.123207 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m21:25:03.123207 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m21:25:03.123207 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:25:03.132848 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m21:25:03.135986 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m21:25:03.135986 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m21:25:03.143010 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:03.145121 [debug] [MainThread]: On master: BEGIN
[0m21:25:03.145121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:03.184935 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m21:25:03.184935 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:03.184935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:03.248498 [debug] [MainThread]: SQL status: SELECT 3 in 0.063 seconds
[0m21:25:03.251505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206491EB450>]}
[0m21:25:03.253511 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:03.253511 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:03.253511 [debug] [MainThread]: On master: BEGIN
[0m21:25:03.255021 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:25:03.255021 [debug] [MainThread]: On master: COMMIT
[0m21:25:03.255021 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:03.255021 [debug] [MainThread]: On master: COMMIT
[0m21:25:03.256941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:25:03.256941 [debug] [MainThread]: On master: Close
[0m21:25:03.265372 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m21:25:03.265372 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_etablissement ........................... [RUN]
[0m21:25:03.267973 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m21:25:03.269191 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m21:25:03.270846 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m21:25:03.279382 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m21:25:03.324040 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m21:25:03.328444 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m21:25:03.328444 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m21:25:03.329568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:25:03.370112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m21:25:03.370112 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m21:25:03.370112 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m21:25:03.385953 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m21:25:03.388158 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m21:25:03.388158 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m21:25:03.398262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:25:03.398262 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m21:25:03.398262 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m21:25:03.398262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:03.412161 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m21:25:03.412161 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m21:25:03.412161 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m21:25:03.412161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:25:03.422946 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m21:25:03.424952 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m21:25:03.426958 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m21:25:03.432722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m21:25:03.436016 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m21:25:03.439837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064953A710>]}
[0m21:25:03.439837 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m21:25:03.441204 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m21:25:03.441204 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m21:25:03.443208 [info ] [Thread-1 (]: 2 of 7 START sql view model public.stg_etudiant ................................ [RUN]
[0m21:25:03.444259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m21:25:03.444259 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m21:25:03.448585 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m21:25:03.449185 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m21:25:03.454465 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m21:25:03.454465 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m21:25:03.454465 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m21:25:03.457201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:03.512738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m21:25:03.512738 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m21:25:03.514488 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m21:25:03.519081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:25:03.521548 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m21:25:03.521548 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m21:25:03.521548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:25:03.521548 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m21:25:03.527384 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m21:25:03.527384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:25:03.528689 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m21:25:03.528689 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m21:25:03.528689 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m21:25:03.568218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m21:25:03.575312 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m21:25:03.575312 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m21:25:03.575312 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m21:25:03.578876 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:25:03.578876 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m21:25:03.582064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064946D510>]}
[0m21:25:03.583083 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m21:25:03.585119 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m21:25:03.585119 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m21:25:03.586222 [info ] [Thread-1 (]: 3 of 7 START sql view model public.stg_mobilite ................................ [RUN]
[0m21:25:03.587434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m21:25:03.587434 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m21:25:03.590347 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m21:25:03.590347 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m21:25:03.594547 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m21:25:03.595796 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m21:25:03.596852 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m21:25:03.596852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:03.767597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.178 seconds
[0m21:25:03.767597 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m21:25:03.777632 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m21:25:03.826098 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m21:25:03.842183 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m21:25:03.842183 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m21:25:03.842183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:03.860039 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m21:25:03.861096 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m21:25:03.861096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:03.866490 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m21:25:03.867910 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m21:25:03.867910 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m21:25:03.899825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m21:25:03.917740 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m21:25:03.917740 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m21:25:03.917740 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m21:25:03.917740 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:25:03.935805 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m21:25:03.935805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064958C6D0>]}
[0m21:25:03.935805 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.35s]
[0m21:25:03.935805 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m21:25:03.935805 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m21:25:03.945833 [info ] [Thread-1 (]: 4 of 7 START sql table model public.hub_etablissement .......................... [RUN]
[0m21:25:03.949768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.hub_etablissement)
[0m21:25:03.952021 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m21:25:03.978760 [info ] [Thread-1 (]: 21:25:03 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m21:25:03.978760 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m21:25:03.987856 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m21:25:04.034015 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m21:25:04.034015 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m21:25:04.047544 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m21:25:04.048847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:04.134262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m21:25:04.143857 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m21:25:04.144762 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m21:25:04.218122 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.075 seconds
[0m21:25:04.232310 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m21:25:04.238639 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m21:25:04.238639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:04.246570 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m21:25:04.248767 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m21:25:04.248767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:04.248767 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m21:25:04.254848 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m21:25:04.254848 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m21:25:04.259849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:25:04.266726 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m21:25:04.271267 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m21:25:04.271267 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m21:25:04.295954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m21:25:04.299964 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m21:25:04.299964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206495BF410>]}
[0m21:25:04.304353 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.35s]
[0m21:25:04.304353 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m21:25:04.307302 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m21:25:04.307302 [info ] [Thread-1 (]: 5 of 7 START sql table model public.hub_etudiant ............................... [RUN]
[0m21:25:04.311396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m21:25:04.312928 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m21:25:04.325055 [info ] [Thread-1 (]: 21:25:04 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m21:25:04.327804 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m21:25:04.334694 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m21:25:04.340528 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m21:25:04.340528 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m21:25:04.340528 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m21:25:04.340528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:04.435898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m21:25:04.435898 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m21:25:04.438095 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m21:25:04.496321 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.057 seconds
[0m21:25:04.505952 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m21:25:04.507555 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m21:25:04.508934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:04.512693 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m21:25:04.512693 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m21:25:04.518713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:25:04.520736 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m21:25:04.522750 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m21:25:04.522750 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m21:25:04.568193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m21:25:04.571350 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m21:25:04.571350 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m21:25:04.571350 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m21:25:04.587748 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m21:25:04.594521 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m21:25:04.596534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020649112CD0>]}
[0m21:25:04.598547 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.29s]
[0m21:25:04.600559 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m21:25:04.600559 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m21:25:04.603968 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.link_mobilite ........................ [RUN]
[0m21:25:04.603968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m21:25:04.609092 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m21:25:04.627633 [info ] [Thread-1 (]: 21:25:04 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m21:25:04.643284 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m21:25:04.643284 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m21:25:04.682671 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.684979 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp212504670606"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m21:25:04.684979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:04.754532 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.069 seconds
[0m21:25:04.766511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.766511 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m21:25:04.766511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m21:25:04.766511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.766511 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp212504670606'
        
      order by ordinal_position

  
[0m21:25:04.791172 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.022 seconds
[0m21:25:04.801057 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.801057 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:25:04.807144 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m21:25:04.813727 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.816246 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:25:04.816246 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m21:25:04.821446 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m21:25:04.830356 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.831402 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp212504670606"
    )


  
[0m21:25:04.877794 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.048 seconds
[0m21:25:04.877794 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m21:25:04.877794 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m21:25:04.877794 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m21:25:04.877794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:25:04.893709 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m21:25:04.893709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020648ED8690>]}
[0m21:25:04.893709 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.29s]
[0m21:25:04.901270 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m21:25:04.901270 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m21:25:04.901270 [info ] [Thread-1 (]: 7 of 7 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m21:25:04.901270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m21:25:04.909811 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m21:25:04.945463 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m21:25:04.950947 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m21:25:04.957980 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:04.957980 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp212504950947"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m21:25:04.957980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:05.119772 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.165 seconds
[0m21:25:05.135656 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:05.135656 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m21:25:05.140107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m21:25:05.140107 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:05.140107 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp212504950947'
        
      order by ordinal_position

  
[0m21:25:05.164073 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.022 seconds
[0m21:25:05.168461 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:05.168461 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:25:05.168461 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m21:25:05.183351 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:05.183351 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m21:25:05.183351 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m21:25:05.183351 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m21:25:05.183351 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:05.199307 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp212504950947"
    )


  
[0m21:25:05.201644 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m21:25:05.204699 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m21:25:05.204699 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m21:25:05.204699 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m21:25:05.246416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m21:25:05.246416 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m21:25:05.246416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14b9e484-fee3-40b2-8847-976a80ffaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020649553250>]}
[0m21:25:05.246416 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.35s]
[0m21:25:05.262536 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m21:25:05.264550 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:05.266562 [debug] [MainThread]: On master: BEGIN
[0m21:25:05.266562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:25:05.350044 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m21:25:05.350044 [debug] [MainThread]: On master: COMMIT
[0m21:25:05.350044 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:05.353864 [debug] [MainThread]: On master: COMMIT
[0m21:25:05.353864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:25:05.353864 [debug] [MainThread]: On master: Close
[0m21:25:05.353864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:05.353864 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m21:25:05.361027 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m21:25:05.361027 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m21:25:05.363277 [info ] [MainThread]: 
[0m21:25:05.364291 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 3 view models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m21:25:05.368944 [debug] [MainThread]: Command end result
[0m21:25:05.450717 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m21:25:05.466886 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m21:25:05.478724 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m21:25:05.480282 [info ] [MainThread]: 
[0m21:25:05.481837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:25:05.483410 [info ] [MainThread]: 
[0m21:25:05.484989 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m21:25:05.487609 [debug] [MainThread]: Command `dbt run` succeeded at 21:25:05.487609 after 7.41 seconds
[0m21:25:05.489182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206475CE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064737FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020646758C10>]}
[0m21:25:05.489182 [debug] [MainThread]: Flushing usage events
[0m21:25:06.036899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:25:15.714775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E470E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E4751DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E470EB90>]}


============================== 21:25:15.720427 | bf99fcc4-bb36-4b13-ae64-9ca02f9e033a ==============================
[0m21:25:15.720427 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:25:15.720427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:25:15.896355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf99fcc4-bb36-4b13-ae64-9ca02f9e033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E575F550>]}
[0m21:25:15.966427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf99fcc4-bb36-4b13-ae64-9ca02f9e033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E0FBAFD0>]}
[0m21:25:15.966427 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:25:16.150461 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m21:25:16.398146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:16.398146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:16.430988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf99fcc4-bb36-4b13-ae64-9ca02f9e033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E5D52290>]}
[0m21:25:16.580522 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m21:25:16.585323 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m21:25:16.701696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf99fcc4-bb36-4b13-ae64-9ca02f9e033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E0F427D0>]}
[0m21:25:16.701696 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 822 macros
[0m21:25:16.701696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf99fcc4-bb36-4b13-ae64-9ca02f9e033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E5C5D110>]}
[0m21:25:16.710102 [info ] [MainThread]: 
[0m21:25:16.710102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:25:16.713196 [info ] [MainThread]: 
[0m21:25:16.718973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:16.738728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m21:25:17.085972 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m21:25:17.089101 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m21:25:17.090671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:17.211152 [debug] [ThreadPool]: SQL status: BEGIN in 0.124 seconds
[0m21:25:17.211152 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m21:25:17.211152 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:25:17.228234 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m21:25:17.231103 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m21:25:17.231103 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m21:25:17.247135 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:17.247135 [debug] [MainThread]: On master: BEGIN
[0m21:25:17.247135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:17.334542 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:25:17.334542 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:17.334542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:17.355576 [debug] [MainThread]: SQL status: SELECT 3 in 0.014 seconds
[0m21:25:17.360039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf99fcc4-bb36-4b13-ae64-9ca02f9e033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E594BE50>]}
[0m21:25:17.362054 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:17.362054 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:17.364846 [debug] [MainThread]: On master: BEGIN
[0m21:25:17.364846 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:25:17.367326 [debug] [MainThread]: On master: COMMIT
[0m21:25:17.367326 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:17.367326 [debug] [MainThread]: On master: COMMIT
[0m21:25:17.369367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:25:17.370724 [debug] [MainThread]: On master: Close
[0m21:25:17.380565 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m21:25:17.380565 [info ] [Thread-1 (]: 1 of 14 START test not_null_hub_etablissement_oid_etablissement ................ [RUN]
[0m21:25:17.383870 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee'
[0m21:25:17.385414 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m21:25:17.420071 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m21:25:17.423757 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m21:25:17.456272 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m21:25:17.456272 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m21:25:17.461493 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: BEGIN
[0m21:25:17.461493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:25:17.545233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m21:25:17.546840 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m21:25:17.546840 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m21:25:17.552965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:25:17.559771 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: ROLLBACK
[0m21:25:17.561783 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: Close
[0m21:25:17.565537 [info ] [Thread-1 (]: 1 of 14 PASS not_null_hub_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.18s]
[0m21:25:17.566909 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m21:25:17.569179 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m21:25:17.571065 [info ] [Thread-1 (]: 2 of 14 START test not_null_hub_etudiant_id_etudiant ........................... [RUN]
[0m21:25:17.572079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee, now test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22)
[0m21:25:17.574517 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m21:25:17.584230 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m21:25:17.586187 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m21:25:17.593106 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m21:25:17.599423 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m21:25:17.601439 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: BEGIN
[0m21:25:17.604940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:17.701220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m21:25:17.701220 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m21:25:17.703882 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."hub_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m21:25:17.708803 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:25:17.711642 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: ROLLBACK
[0m21:25:17.712653 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: Close
[0m21:25:17.716726 [info ] [Thread-1 (]: 2 of 14 PASS not_null_hub_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.14s]
[0m21:25:17.718895 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m21:25:17.721315 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m21:25:17.722339 [info ] [Thread-1 (]: 3 of 14 START test not_null_link_mobilite_id_mobilite .......................... [RUN]
[0m21:25:17.723883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22, now test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab)
[0m21:25:17.725433 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m21:25:17.740656 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m21:25:17.746708 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m21:25:17.757767 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m21:25:17.759777 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m21:25:17.762545 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: BEGIN
[0m21:25:17.764031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:17.844506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m21:25:17.844506 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m21:25:17.851421 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."link_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m21:25:17.851421 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:25:17.858832 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: ROLLBACK
[0m21:25:17.858832 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: Close
[0m21:25:17.860838 [info ] [Thread-1 (]: 3 of 14 PASS not_null_link_mobilite_id_mobilite ................................ [[32mPASS[0m in 0.14s]
[0m21:25:17.865668 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m21:25:17.867434 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m21:25:17.893515 [info ] [Thread-1 (]: 4 of 14 START test not_null_sat_mobilite_id_mobilite ........................... [RUN]
[0m21:25:17.895218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab, now test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343)
[0m21:25:17.898064 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m21:25:17.909464 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m21:25:17.909464 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m21:25:17.918597 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m21:25:17.920608 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m21:25:17.920608 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: BEGIN
[0m21:25:17.924267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:18.111068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.185 seconds
[0m21:25:18.112242 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m21:25:18.113694 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."sat_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m21:25:18.113694 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:18.121825 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: ROLLBACK
[0m21:25:18.121825 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: Close
[0m21:25:18.126744 [info ] [Thread-1 (]: 4 of 14 PASS not_null_sat_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.23s]
[0m21:25:18.127908 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m21:25:18.129924 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m21:25:18.132700 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m21:25:18.134265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m21:25:18.136776 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m21:25:18.148635 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m21:25:18.153301 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m21:25:18.166835 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m21:25:18.170860 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m21:25:18.174544 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m21:25:18.175057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:18.253267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m21:25:18.253267 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m21:25:18.253267 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m21:25:18.263196 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:25:18.263196 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m21:25:18.263196 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m21:25:18.263196 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.13s]
[0m21:25:18.275210 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m21:25:18.275210 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m21:25:18.277205 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m21:25:18.278214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m21:25:18.279794 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m21:25:18.289299 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m21:25:18.290872 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m21:25:18.298076 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m21:25:18.300589 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m21:25:18.302329 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m21:25:18.303839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:18.393575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m21:25:18.397564 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m21:25:18.399326 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m21:25:18.400834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:25:18.400834 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m21:25:18.407693 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m21:25:18.408995 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.13s]
[0m21:25:18.412264 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m21:25:18.412264 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m21:25:18.412264 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m21:25:18.418465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m21:25:18.419262 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m21:25:18.428852 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m21:25:18.431059 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m21:25:18.435398 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m21:25:18.441271 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m21:25:18.444022 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m21:25:18.444022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:18.527087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m21:25:18.527087 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m21:25:18.527087 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m21:25:18.534223 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:18.537950 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m21:25:18.539041 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m21:25:18.542348 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.12s]
[0m21:25:18.544833 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m21:25:18.544833 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m21:25:18.544833 [info ] [Thread-1 (]: 8 of 14 START test unique_hub_etablissement_oid_etablissement .................. [RUN]
[0m21:25:18.548195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5)
[0m21:25:18.550153 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m21:25:18.562463 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m21:25:18.590266 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m21:25:18.598803 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m21:25:18.602855 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m21:25:18.607549 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: BEGIN
[0m21:25:18.607549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:18.688657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m21:25:18.688657 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m21:25:18.688657 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:18.688657 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:18.704151 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: ROLLBACK
[0m21:25:18.704151 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: Close
[0m21:25:18.704151 [info ] [Thread-1 (]: 8 of 14 PASS unique_hub_etablissement_oid_etablissement ........................ [[32mPASS[0m in 0.16s]
[0m21:25:18.704151 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m21:25:18.704151 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m21:25:18.704151 [info ] [Thread-1 (]: 9 of 14 START test unique_hub_etudiant_id_etudiant ............................. [RUN]
[0m21:25:18.704151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5, now test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466)
[0m21:25:18.717952 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m21:25:18.737819 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m21:25:18.737819 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m21:25:18.742912 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m21:25:18.773923 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m21:25:18.773923 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: BEGIN
[0m21:25:18.773923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:18.854208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m21:25:18.854208 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m21:25:18.854208 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:18.870063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:18.870063 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: ROLLBACK
[0m21:25:18.870063 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: Close
[0m21:25:18.870063 [info ] [Thread-1 (]: 9 of 14 PASS unique_hub_etudiant_id_etudiant ................................... [[32mPASS[0m in 0.17s]
[0m21:25:18.870063 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m21:25:18.870063 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m21:25:18.870063 [info ] [Thread-1 (]: 10 of 14 START test unique_link_mobilite_id_mobilite ........................... [RUN]
[0m21:25:18.870063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466, now test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530)
[0m21:25:18.887134 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m21:25:18.900110 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m21:25:18.902453 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m21:25:18.911722 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m21:25:18.911722 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m21:25:18.911722 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: BEGIN
[0m21:25:18.918131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:19.002493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m21:25:19.004828 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m21:25:19.006147 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:19.006147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:19.006147 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: ROLLBACK
[0m21:25:19.006147 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: Close
[0m21:25:19.019066 [info ] [Thread-1 (]: 10 of 14 PASS unique_link_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.15s]
[0m21:25:19.020176 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m21:25:19.022798 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m21:25:19.022798 [info ] [Thread-1 (]: 11 of 14 START test unique_sat_mobilite_id_mobilite ............................ [RUN]
[0m21:25:19.024809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530, now test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1)
[0m21:25:19.027442 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m21:25:19.035484 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m21:25:19.040968 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m21:25:19.046001 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m21:25:19.074150 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m21:25:19.075905 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: BEGIN
[0m21:25:19.075905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:19.159506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m21:25:19.159506 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m21:25:19.159506 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."sat_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:19.165496 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:19.170542 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: ROLLBACK
[0m21:25:19.170542 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: Close
[0m21:25:19.174021 [info ] [Thread-1 (]: 11 of 14 PASS unique_sat_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.15s]
[0m21:25:19.174021 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m21:25:19.178924 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m21:25:19.180436 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m21:25:19.180436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m21:25:19.183309 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m21:25:19.189214 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m21:25:19.218485 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m21:25:19.223854 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m21:25:19.235401 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m21:25:19.237411 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m21:25:19.238953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:19.334315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.107 seconds
[0m21:25:19.334315 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m21:25:19.334315 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:19.350134 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:19.357290 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m21:25:19.359304 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m21:25:19.363198 [info ] [Thread-1 (]: 12 of 14 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.18s]
[0m21:25:19.365212 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m21:25:19.366222 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m21:25:19.368235 [info ] [Thread-1 (]: 13 of 14 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m21:25:19.368235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m21:25:19.372502 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m21:25:19.392275 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m21:25:19.392275 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m21:25:19.402498 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m21:25:19.443000 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m21:25:19.445200 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m21:25:19.445200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:19.518112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m21:25:19.530856 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m21:25:19.530856 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:19.537755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:19.540279 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m21:25:19.540279 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m21:25:19.540279 [info ] [Thread-1 (]: 13 of 14 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.17s]
[0m21:25:19.547246 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m21:25:19.548838 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m21:25:19.549854 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m21:25:19.551423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m21:25:19.554118 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m21:25:19.567069 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m21:25:19.573566 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m21:25:19.573566 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m21:25:19.585490 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m21:25:19.590416 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m21:25:19.593041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:19.672445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m21:25:19.674221 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m21:25:19.674221 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:25:19.674221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:25:19.683407 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m21:25:19.683407 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m21:25:19.683407 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.13s]
[0m21:25:19.690328 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m21:25:19.694139 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:19.694139 [debug] [MainThread]: On master: BEGIN
[0m21:25:19.694139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:25:19.781490 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:25:19.781490 [debug] [MainThread]: On master: COMMIT
[0m21:25:19.781490 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:19.781490 [debug] [MainThread]: On master: COMMIT
[0m21:25:19.781490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:25:19.788174 [debug] [MainThread]: On master: Close
[0m21:25:19.790623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:19.792669 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m21:25:19.792669 [debug] [MainThread]: Connection 'test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f' was properly closed.
[0m21:25:19.794686 [info ] [MainThread]: 
[0m21:25:19.799773 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m21:25:19.808851 [debug] [MainThread]: Command end result
[0m21:25:19.925170 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m21:25:19.929196 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m21:25:19.931206 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m21:25:19.931206 [info ] [MainThread]: 
[0m21:25:19.941166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:25:19.941679 [info ] [MainThread]: 
[0m21:25:19.943312 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m21:25:19.943312 [debug] [MainThread]: Command `dbt test` succeeded at 21:25:19.943312 after 4.32 seconds
[0m21:25:19.945083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E6274610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD94F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD94FCD0>]}
[0m21:25:19.945083 [debug] [MainThread]: Flushing usage events
[0m21:25:20.386113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:32.562722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF27AF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF27EA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF27A7890>]}


============================== 23:12:32.574517 | ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa ==============================
[0m23:12:32.574517 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:12:32.574517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:12:32.741872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF2638710>]}
[0m23:12:32.789105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEF05BC90>]}
[0m23:12:32.789105 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:12:33.008612 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:12:35.207813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m23:12:35.207813 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:12:35.207813 [debug] [MainThread]: Partial parsing: added file: sid_lite://dbt/sid-lite/models\marts\schema.yml
[0m23:12:36.118470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF41EC250>]}
[0m23:12:36.197578 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:12:36.211112 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:12:36.243224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF4088850>]}
[0m23:12:36.243224 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:12:36.259373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF418F490>]}
[0m23:12:36.264903 [info ] [MainThread]: 
[0m23:12:36.266418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:12:36.267931 [info ] [MainThread]: 
[0m23:12:36.269451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:36.277194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m23:12:36.434292 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m23:12:36.438788 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m23:12:36.438788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:36.495134 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.056 seconds
[0m23:12:36.495134 [debug] [ThreadPool]: On list_sid_lite: Close
[0m23:12:36.500463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:12:36.507487 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:12:36.507487 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:12:36.509494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:36.557173 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m23:12:36.557699 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:12:36.558740 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:12:36.559246 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:12:36.568591 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:12:36.568591 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:12:36.578189 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:36.578731 [debug] [MainThread]: On master: BEGIN
[0m23:12:36.579249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:36.619158 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:12:36.619158 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:36.619158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:36.637062 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m23:12:36.640721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF41935D0>]}
[0m23:12:36.640721 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:36.640721 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:36.640721 [debug] [MainThread]: On master: BEGIN
[0m23:12:36.643312 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:12:36.643312 [debug] [MainThread]: On master: COMMIT
[0m23:12:36.644715 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:36.644715 [debug] [MainThread]: On master: COMMIT
[0m23:12:36.645940 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:36.645940 [debug] [MainThread]: On master: Close
[0m23:12:36.652604 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m23:12:36.652604 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_etablissement ........................... [RUN]
[0m23:12:36.654632 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m23:12:36.654632 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m23:12:36.657895 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m23:12:36.666742 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m23:12:36.697501 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m23:12:36.697501 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:12:36.697501 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m23:12:36.705686 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:36.754688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:12:36.779344 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:12:36.779344 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m23:12:36.788703 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:12:36.794578 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:12:36.794578 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m23:12:36.794578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:36.802048 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:12:36.802048 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m23:12:36.802048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:12:36.817708 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:12:36.817708 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:12:36.817708 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:12:36.820950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:12:36.820950 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m23:12:36.835376 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:12:36.835376 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m23:12:36.839572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:12:36.839572 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m23:12:36.846078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF47BBA10>]}
[0m23:12:36.847159 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m23:12:36.848294 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m23:12:36.849803 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m23:12:36.849803 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_etudiant ................................ [RUN]
[0m23:12:36.849803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m23:12:36.852293 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m23:12:36.854095 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m23:12:36.854095 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m23:12:36.858622 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m23:12:36.858622 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:12:36.858622 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m23:12:36.858622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:36.911261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m23:12:36.911261 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:12:36.911261 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m23:12:36.920470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:12:36.924511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:12:36.924511 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m23:12:36.926519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:36.929758 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:12:36.931764 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m23:12:36.931764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:36.931764 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:12:36.934429 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:12:36.934429 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:12:36.965352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:12:36.980658 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m23:12:36.980658 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:12:36.982665 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m23:12:36.986027 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:12:36.989923 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m23:12:36.989923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF48202D0>]}
[0m23:12:36.992254 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m23:12:36.993767 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m23:12:36.993767 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m23:12:36.995271 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_mobilite ................................ [RUN]
[0m23:12:36.995271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m23:12:36.996785 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m23:12:36.999952 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m23:12:36.999952 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m23:12:37.003964 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m23:12:37.005970 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:12:37.005970 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m23:12:37.005970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:37.163344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m23:12:37.163344 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:12:37.169921 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m23:12:37.176438 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:12:37.180129 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:12:37.180129 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m23:12:37.180129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:37.192362 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:12:37.192362 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m23:12:37.194656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:37.196505 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:12:37.196505 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:12:37.196505 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:12:37.223328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:12:37.243248 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m23:12:37.243248 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:12:37.245254 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m23:12:37.248972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:12:37.252473 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m23:12:37.252473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF4864B10>]}
[0m23:12:37.254988 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.26s]
[0m23:12:37.258053 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m23:12:37.258053 [debug] [Thread-1 (]: Began running node model.sid_lite.vw_fait_mobilite
[0m23:12:37.258053 [info ] [Thread-1 (]: 4 of 8 START sql view model public.vw_fait_mobilite ............................ [RUN]
[0m23:12:37.261129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.vw_fait_mobilite)
[0m23:12:37.261129 [debug] [Thread-1 (]: Began compiling node model.sid_lite.vw_fait_mobilite
[0m23:12:37.264848 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.vw_fait_mobilite"
[0m23:12:37.264848 [debug] [Thread-1 (]: Began executing node model.sid_lite.vw_fait_mobilite
[0m23:12:37.268290 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.vw_fait_mobilite"
[0m23:12:37.273471 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:12:37.274363 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: BEGIN
[0m23:12:37.275682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:37.324950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m23:12:37.324950 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:12:37.324950 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */

  create view "sid_lite"."public"."vw_fait_mobilite__dbt_tmp"
    
    
  as (
    create or replace view vw_fait_mobilite as
select
    m.id_mobilite,
    m.date_debut,
    m.date_fin,
    m.type_mobilite,
    m.statut_mobilite,
    -- Etudiant
    etu.id_etudiant,
    etu.nom as nom_etudiant,
    etu.prenom as prenom_etudiant,
    etu.date_naissance,
    etu.sexe,
    etu.nationalite,
    -- Etablissement d'origine
    e_orig.oid_etablissement as oid_etablissement_origine,
    e_orig.nom_etablissement as nom_etab_origine,
    e_orig.pays as pays_etab_origine,
    e_orig.ville as ville_etab_origine,
    e_orig.type_etablissement as type_etab_origine,
    -- Etablissement d'accueil
    e_acc.oid_etablissement as oid_etablissement_accueil,
    e_acc.nom_etablissement as nom_etab_accueil,
    e_acc.pays as pays_etab_accueil,
    e_acc.ville as ville_etab_accueil,
    e_acc.type_etablissement as type_etab_accueil,
    -- Techniques
    m.load_dts,
    m.source
from stg_mobilite m
left join stg_etudiant etu on m.id_etudiant = etu.id_etudiant
left join stg_etablissement e_orig on m.oid_etablissement_origine = e_orig.oid_etablissement
left join stg_etablissement e_acc on m.oid_etablissement_accueil = e_acc.oid_etablissement
;
  );
[0m23:12:37.369507 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « create »
LINE 7:     create or replace view vw_fait_mobilite as
            ^

[0m23:12:37.371518 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: ROLLBACK
[0m23:12:37.373525 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: Close
[0m23:12:37.389645 [debug] [Thread-1 (]: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « create »
  LINE 7:     create or replace view vw_fait_mobilite as
              ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:12:37.389645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF43F7110>]}
[0m23:12:37.389645 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model public.vw_fait_mobilite ................... [[31mERROR[0m in 0.13s]
[0m23:12:37.389645 [debug] [Thread-1 (]: Finished running node model.sid_lite.vw_fait_mobilite
[0m23:12:37.395084 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m23:12:37.395084 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.vw_fait_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « create »
  LINE 7:     create or replace view vw_fait_mobilite as
              ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql.
[0m23:12:37.395084 [info ] [Thread-1 (]: 5 of 8 START sql table model public.hub_etablissement .......................... [RUN]
[0m23:12:37.397105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.vw_fait_mobilite, now model.sid_lite.hub_etablissement)
[0m23:12:37.397105 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m23:12:37.422329 [info ] [Thread-1 (]: 23:12:37 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m23:12:37.459978 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m23:12:37.469993 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m23:12:37.485783 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m23:12:37.485783 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:12:37.491179 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m23:12:37.492266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:37.527034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:12:37.527034 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:12:37.527034 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:12:37.570199 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.036 seconds
[0m23:12:37.580066 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:12:37.580066 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m23:12:37.580066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:37.584414 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:12:37.584414 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m23:12:37.584414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:37.584414 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:12:37.587984 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:12:37.587984 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:12:37.589735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:12:37.589735 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m23:12:37.589735 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:12:37.589735 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m23:12:37.589735 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:12:37.604921 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m23:12:37.607433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF42F5590>]}
[0m23:12:37.607433 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.21s]
[0m23:12:37.607433 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m23:12:37.607433 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m23:12:37.607433 [info ] [Thread-1 (]: 6 of 8 START sql table model public.hub_etudiant ............................... [RUN]
[0m23:12:37.607433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m23:12:37.612104 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m23:12:37.612104 [info ] [Thread-1 (]: 23:12:37 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m23:12:37.620711 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m23:12:37.621759 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m23:12:37.627769 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m23:12:37.627769 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:12:37.627769 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m23:12:37.627769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:37.676583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m23:12:37.676583 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:12:37.676583 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:12:37.691138 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.008 seconds
[0m23:12:37.698801 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:12:37.698801 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m23:12:37.778987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:37.778987 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:12:37.778987 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m23:12:37.778987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:12:37.778987 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:12:37.778987 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:12:37.778987 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:12:37.828052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:12:37.829742 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m23:12:37.829742 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:12:37.829742 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m23:12:37.841973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m23:12:37.850322 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m23:12:37.850322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF46A4250>]}
[0m23:12:37.850322 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.24s]
[0m23:12:37.858405 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m23:12:37.858405 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m23:12:37.858405 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.link_mobilite ........................ [RUN]
[0m23:12:37.858405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m23:12:37.865714 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m23:12:37.877115 [info ] [Thread-1 (]: 23:12:37 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m23:12:37.927370 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m23:12:37.927370 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m23:12:37.978340 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:37.978340 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp231237970272"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:12:37.978340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:38.107774 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.127 seconds
[0m23:12:38.144077 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:38.144077 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m23:12:38.144077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m23:12:38.152252 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:38.152252 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp231237970272'
        
      order by ordinal_position

  
[0m23:12:38.168076 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.023 seconds
[0m23:12:38.183838 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:38.183838 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:12:38.201557 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m23:12:38.215678 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:38.215678 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:12:38.215678 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m23:12:38.231376 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m23:12:38.231376 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:38.231376 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp231237970272"
    )


  
[0m23:12:38.247187 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:12:38.250636 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:12:38.250636 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:12:38.252208 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:12:38.297594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m23:12:38.301766 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m23:12:38.303778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEEFBAB90>]}
[0m23:12:38.305795 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.45s]
[0m23:12:38.305795 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m23:12:38.305795 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m23:12:38.312466 [info ] [Thread-1 (]: 8 of 8 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m23:12:38.315067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m23:12:38.317078 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m23:12:38.414631 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m23:12:38.414631 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m23:12:38.430611 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.430611 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp231238424352"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:12:38.434680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:38.542468 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.109 seconds
[0m23:12:38.555654 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.555654 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m23:12:38.558987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:12:38.558987 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.562894 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp231238424352'
        
      order by ordinal_position

  
[0m23:12:38.578669 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.021 seconds
[0m23:12:38.590199 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.590199 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:12:38.590199 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:12:38.608250 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.608250 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:12:38.608250 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:12:38.608250 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m23:12:38.608250 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.622290 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp231238424352"
    )


  
[0m23:12:38.623640 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:12:38.625566 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:12:38.625566 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:12:38.625566 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:12:38.673855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m23:12:38.677253 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m23:12:38.679689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccf7341e-a151-4fe2-bd4f-bc2f9ea3d6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF3FE3590>]}
[0m23:12:38.679689 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.37s]
[0m23:12:38.684592 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m23:12:38.688358 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:38.688358 [debug] [MainThread]: On master: BEGIN
[0m23:12:38.690518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:38.796458 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m23:12:38.800130 [debug] [MainThread]: On master: COMMIT
[0m23:12:38.800130 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:38.802638 [debug] [MainThread]: On master: COMMIT
[0m23:12:38.802638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:38.804652 [debug] [MainThread]: On master: Close
[0m23:12:38.806959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:38.806959 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m23:12:38.809943 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:12:38.809943 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m23:12:38.812423 [info ] [MainThread]: 
[0m23:12:38.812423 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 4 view models in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m23:12:38.818635 [debug] [MainThread]: Command end result
[0m23:12:38.914207 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:12:38.922041 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:12:38.934079 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:12:38.936092 [info ] [MainThread]: 
[0m23:12:38.937853 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:12:38.939210 [info ] [MainThread]: 
[0m23:12:38.939210 [error] [MainThread]: [31mFailure in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)[0m
[0m23:12:38.942968 [error] [MainThread]:   Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « create »
  LINE 7:     create or replace view vw_fait_mobilite as
              ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:12:38.944028 [info ] [MainThread]: 
[0m23:12:38.945058 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:12:38.946699 [info ] [MainThread]: 
[0m23:12:38.946699 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m23:12:38.951486 [debug] [MainThread]: Command `dbt run` failed at 23:12:38.951486 after 6.56 seconds
[0m23:12:38.951486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF163E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEF2E3FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBF18F20D0>]}
[0m23:12:38.954829 [debug] [MainThread]: Flushing usage events
[0m23:12:39.490040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:14.210816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAC07C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAD0C7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCABE2FD10>]}


============================== 23:14:14.215341 | 02fd09b2-72fd-4020-96fd-79b616b02a33 ==============================
[0m23:14:14.215341 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:14:14.215341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:14.379203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAD0EF610>]}
[0m23:14:14.447008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCA892E190>]}
[0m23:14:14.448563 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:14:14.616486 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:14:14.850977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:14.850977 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:15.294017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAD7C4910>]}
[0m23:14:15.367950 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:14:15.372907 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:14:15.394628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAD5FD910>]}
[0m23:14:15.395962 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:14:15.397082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADA8DAD0>]}
[0m23:14:15.398221 [info ] [MainThread]: 
[0m23:14:15.398221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:14:15.400912 [info ] [MainThread]: 
[0m23:14:15.400912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:15.413685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m23:14:15.543117 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m23:14:15.547577 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m23:14:15.547577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:15.596409 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.051 seconds
[0m23:14:15.596409 [debug] [ThreadPool]: On list_sid_lite: Close
[0m23:14:15.602218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:14:15.608757 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:14:15.608757 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:14:15.608757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:15.649935 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m23:14:15.650440 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:14:15.650440 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:14:15.652500 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m23:14:15.652500 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:14:15.652500 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:14:15.665907 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:15.667473 [debug] [MainThread]: On master: BEGIN
[0m23:14:15.667473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:15.702282 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m23:14:15.702282 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:15.702282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:15.706945 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m23:14:15.706945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADB11BD0>]}
[0m23:14:15.713455 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:15.713455 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:15.713455 [debug] [MainThread]: On master: BEGIN
[0m23:14:15.713455 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:14:15.713455 [debug] [MainThread]: On master: COMMIT
[0m23:14:15.713455 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:15.713455 [debug] [MainThread]: On master: COMMIT
[0m23:14:15.713455 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:15.717689 [debug] [MainThread]: On master: Close
[0m23:14:15.721071 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m23:14:15.722500 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_etablissement ........................... [RUN]
[0m23:14:15.722500 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m23:14:15.722500 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m23:14:15.731063 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m23:14:15.732274 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m23:14:15.768067 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m23:14:15.769633 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:15.769633 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m23:14:15.769633 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:14:15.809255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:14:15.812020 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:15.812020 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m23:14:15.812020 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:14:15.821426 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:15.821426 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m23:14:15.821426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:15.825723 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:15.825723 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m23:14:15.825723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:15.838137 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:14:15.838137 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:15.838137 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:14:15.839642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:14:15.846990 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m23:14:15.848996 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:15.851003 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m23:14:15.851003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:14:15.857762 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m23:14:15.857762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAD88EC90>]}
[0m23:14:15.861907 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m23:14:15.861907 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m23:14:15.863907 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m23:14:15.863907 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_etudiant ................................ [RUN]
[0m23:14:15.863907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m23:14:15.863907 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m23:14:15.867474 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m23:14:15.867474 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m23:14:15.873768 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m23:14:15.875672 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:15.876529 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m23:14:15.876529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:15.920132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:14:15.920132 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:15.920132 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m23:14:15.926722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:14:15.932480 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:15.932480 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m23:14:15.932480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:15.936926 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:15.936926 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m23:14:15.936926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:15.940172 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:14:15.940172 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:15.940172 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:14:15.979295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:14:15.985040 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m23:14:15.987046 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:15.987046 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m23:14:15.989269 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:14:15.992980 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m23:14:15.994987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADF12B50>]}
[0m23:14:15.996995 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:14:15.996995 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m23:14:15.998912 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m23:14:16.000057 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_mobilite ................................ [RUN]
[0m23:14:16.000057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m23:14:16.000057 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m23:14:16.004568 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m23:14:16.004568 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m23:14:16.006574 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m23:14:16.008579 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:16.008579 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m23:14:16.008579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:16.046974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:14:16.046974 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:16.046974 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m23:14:16.046974 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:14:16.060427 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:16.062434 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m23:14:16.062434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:16.065202 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:16.065202 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m23:14:16.065202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:16.068309 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:14:16.068309 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:16.068309 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:14:16.111191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:14:16.113408 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m23:14:16.113408 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:16.113408 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m23:14:16.118517 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:14:16.121767 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m23:14:16.121767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE066C10>]}
[0m23:14:16.121767 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:14:16.126963 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m23:14:16.126963 [debug] [Thread-1 (]: Began running node model.sid_lite.vw_fait_mobilite
[0m23:14:16.128332 [info ] [Thread-1 (]: 4 of 8 START sql view model public.vw_fait_mobilite ............................ [RUN]
[0m23:14:16.128332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.vw_fait_mobilite)
[0m23:14:16.128332 [debug] [Thread-1 (]: Began compiling node model.sid_lite.vw_fait_mobilite
[0m23:14:16.133183 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.vw_fait_mobilite"
[0m23:14:16.133183 [debug] [Thread-1 (]: Began executing node model.sid_lite.vw_fait_mobilite
[0m23:14:16.133183 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.vw_fait_mobilite"
[0m23:14:16.133183 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:14:16.133183 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: BEGIN
[0m23:14:16.133183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:16.181116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:14:16.182609 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:14:16.182609 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */

  create view "sid_lite"."public"."vw_fait_mobilite__dbt_tmp"
    
    
  as (
    

select
    m.id_mobilite,
    m.date_debut,
    m.date_fin,
    m.type_mobilite,
    m.statut_mobilite,
    -- Etudiant
    etu.id_etudiant,
    etu.nom as nom_etudiant,
    etu.prenom as prenom_etudiant,
    etu.date_naissance,
    etu.sexe,
    etu.nationalite,
    -- Etablissement d'origine
    e_orig.oid_etablissement as oid_etablissement_origine,
    e_orig.nom_etablissement as nom_etab_origine,
    e_orig.pays as pays_etab_origine,
    e_orig.ville as ville_etab_origine,
    e_orig.type_etablissement as type_etab_origine,
    -- Etablissement d'accueil
    e_acc.oid_etablissement as oid_etablissement_accueil,
    e_acc.nom_etablissement as nom_etab_accueil,
    e_acc.pays as pays_etab_accueil,
    e_acc.ville as ville_etab_accueil,
    e_acc.type_etablissement as type_etab_accueil,
    -- Techniques
    m.load_dts,
    m.source
from stg_mobilite m
left join stg_etudiant etu on m.id_etudiant = etu.id_etudiant
left join stg_etablissement e_orig on m.oid_etablissement_origine = e_orig.oid_etablissement
left join stg_etablissement e_acc on m.oid_etablissement_accueil = e_acc.oid_etablissement
;
  );
[0m23:14:16.184160 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 41: ;
         ^

[0m23:14:16.184160 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: ROLLBACK
[0m23:14:16.184160 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: Close
[0m23:14:16.193387 [debug] [Thread-1 (]: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 41: ;
           ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:16.193387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE05CB90>]}
[0m23:14:16.195217 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model public.vw_fait_mobilite ................... [[31mERROR[0m in 0.07s]
[0m23:14:16.196663 [debug] [Thread-1 (]: Finished running node model.sid_lite.vw_fait_mobilite
[0m23:14:16.196663 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m23:14:16.197703 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.vw_fait_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 41: ;
           ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql.
[0m23:14:16.197703 [info ] [Thread-1 (]: 5 of 8 START sql table model public.hub_etablissement .......................... [RUN]
[0m23:14:16.199735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.vw_fait_mobilite, now model.sid_lite.hub_etablissement)
[0m23:14:16.199735 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m23:14:16.220045 [info ] [Thread-1 (]: 23:14:16 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m23:14:16.265435 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m23:14:16.265435 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m23:14:16.279931 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m23:14:16.279931 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:16.279931 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m23:14:16.286300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:16.325135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:14:16.325135 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:16.325135 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:14:16.334663 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.008 seconds
[0m23:14:16.340363 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:16.340363 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m23:14:16.346620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:16.348564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:16.348564 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m23:14:16.348564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:16.348564 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:14:16.348564 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:16.348564 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:14:16.387222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m23:14:16.402938 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m23:14:16.404458 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:16.404458 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m23:14:16.418655 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m23:14:16.418655 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m23:14:16.418655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADEE8650>]}
[0m23:14:16.418655 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.22s]
[0m23:14:16.418655 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m23:14:16.418655 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m23:14:16.434383 [info ] [Thread-1 (]: 6 of 8 START sql table model public.hub_etudiant ............................... [RUN]
[0m23:14:16.434383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m23:14:16.438303 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m23:14:16.444660 [info ] [Thread-1 (]: 23:14:16 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m23:14:16.454480 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m23:14:16.461418 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m23:14:16.470948 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m23:14:16.470948 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:16.470948 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m23:14:16.476363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:16.586552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m23:14:16.591146 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:16.591531 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:14:16.600607 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.008 seconds
[0m23:14:16.604542 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:16.604542 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m23:14:16.606564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:16.608934 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:16.610142 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m23:14:16.610142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:16.612515 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:14:16.612515 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:16.612515 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:14:16.654469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:14:16.734156 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m23:14:16.734156 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:16.734156 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m23:14:16.750498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:14:16.754132 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m23:14:16.754132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADF246D0>]}
[0m23:14:16.754132 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.32s]
[0m23:14:16.756520 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m23:14:16.756520 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m23:14:16.756520 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.link_mobilite ........................ [RUN]
[0m23:14:16.758524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m23:14:16.758524 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m23:14:16.766877 [info ] [Thread-1 (]: 23:14:16 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m23:14:16.778850 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m23:14:16.778850 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m23:14:16.812345 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.812345 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp231416804895"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:14:16.812345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:16.863193 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.049 seconds
[0m23:14:16.875495 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.875495 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m23:14:16.875495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:14:16.875495 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.875495 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp231416804895'
        
      order by ordinal_position

  
[0m23:14:16.889030 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m23:14:16.891217 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.891217 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:16.891217 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:14:16.904840 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.904840 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:16.907294 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m23:14:16.915835 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m23:14:16.917842 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.917842 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp231416804895"
    )


  
[0m23:14:16.917842 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:14:16.917842 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:14:16.917842 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:16.917842 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:14:16.959572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:14:16.959572 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m23:14:16.965988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCADA73E90>]}
[0m23:14:16.965988 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.21s]
[0m23:14:16.967991 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m23:14:16.967991 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m23:14:16.967991 [info ] [Thread-1 (]: 8 of 8 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m23:14:16.970736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m23:14:16.970736 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m23:14:17.015376 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m23:14:17.017382 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m23:14:17.021391 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.021391 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp231417019387"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:14:17.021391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:17.075790 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.053 seconds
[0m23:14:17.078085 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.078085 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m23:14:17.078085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:14:17.082595 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.082595 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp231417019387'
        
      order by ordinal_position

  
[0m23:14:17.091081 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m23:14:17.095843 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.095843 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:17.099584 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:14:17.105111 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.105111 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:17.106859 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:14:17.110325 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m23:14:17.110325 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.110325 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp231417019387"
    )


  
[0m23:14:17.110325 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:14:17.110325 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:14:17.110325 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:17.110325 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:14:17.156772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m23:14:17.159111 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m23:14:17.161580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fd09b2-72fd-4020-96fd-79b616b02a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAD287990>]}
[0m23:14:17.161580 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.19s]
[0m23:14:17.163208 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m23:14:17.163208 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:17.166160 [debug] [MainThread]: On master: BEGIN
[0m23:14:17.166160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:17.207125 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m23:14:17.207125 [debug] [MainThread]: On master: COMMIT
[0m23:14:17.207125 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:17.207125 [debug] [MainThread]: On master: COMMIT
[0m23:14:17.208956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:17.208956 [debug] [MainThread]: On master: Close
[0m23:14:17.210902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:17.210902 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m23:14:17.210902 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:14:17.210902 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m23:14:17.212407 [info ] [MainThread]: 
[0m23:14:17.212407 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 4 view models in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m23:14:17.214791 [debug] [MainThread]: Command end result
[0m23:14:17.244729 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:14:17.255731 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:14:17.259465 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:14:17.259465 [info ] [MainThread]: 
[0m23:14:17.265003 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:14:17.265003 [info ] [MainThread]: 
[0m23:14:17.265003 [error] [MainThread]: [31mFailure in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)[0m
[0m23:14:17.266674 [error] [MainThread]:   Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 41: ;
           ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:17.266674 [info ] [MainThread]: 
[0m23:14:17.266674 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:17.268426 [info ] [MainThread]: 
[0m23:14:17.268426 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m23:14:17.270474 [debug] [MainThread]: Command `dbt run` failed at 23:14:17.270474 after 3.16 seconds
[0m23:14:17.270474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAC07E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAC07F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAB1C20D0>]}
[0m23:14:17.270474 [debug] [MainThread]: Flushing usage events
[0m23:14:17.787483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:38.813376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE70C6F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE70CA9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE70CABBD0>]}


============================== 23:14:38.814618 | 0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f ==============================
[0m23:14:38.814618 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:14:38.814618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:38.989291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE70C67690>]}
[0m23:14:39.052886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6D51A7D0>]}
[0m23:14:39.054477 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:14:39.212553 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:14:39.411085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:39.411085 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:39.840905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE721ED050>]}
[0m23:14:39.951620 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:14:39.951620 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:14:39.981637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE721ED050>]}
[0m23:14:39.983197 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:14:39.983197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6FD01590>]}
[0m23:14:39.986323 [info ] [MainThread]: 
[0m23:14:39.986323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:14:39.987888 [info ] [MainThread]: 
[0m23:14:39.987888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:39.993610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m23:14:40.136563 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m23:14:40.136563 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m23:14:40.138177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:40.207184 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.068 seconds
[0m23:14:40.209490 [debug] [ThreadPool]: On list_sid_lite: Close
[0m23:14:40.211543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:14:40.217554 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:14:40.217554 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:14:40.218677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:40.253809 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:14:40.253809 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:14:40.256490 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:14:40.261561 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m23:14:40.263523 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:14:40.263523 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:14:40.270659 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:40.270659 [debug] [MainThread]: On master: BEGIN
[0m23:14:40.272173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:40.307368 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:14:40.309698 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:40.309698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:40.315630 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m23:14:40.319631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE727084D0>]}
[0m23:14:40.319631 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:40.319631 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:40.322147 [debug] [MainThread]: On master: BEGIN
[0m23:14:40.325052 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:14:40.325841 [debug] [MainThread]: On master: COMMIT
[0m23:14:40.325841 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:40.325841 [debug] [MainThread]: On master: COMMIT
[0m23:14:40.325841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:40.325841 [debug] [MainThread]: On master: Close
[0m23:14:40.331600 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m23:14:40.331600 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_etablissement ........................... [RUN]
[0m23:14:40.331600 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m23:14:40.331600 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m23:14:40.338599 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m23:14:40.338599 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m23:14:40.363740 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m23:14:40.363740 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:40.363740 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m23:14:40.370813 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:14:40.410400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:14:40.410400 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:40.410400 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m23:14:40.412600 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:14:40.415881 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:40.415881 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m23:14:40.415881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:40.423951 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:40.423951 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m23:14:40.423951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:40.427712 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:14:40.427712 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:40.427712 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:14:40.461863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m23:14:40.473168 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m23:14:40.477461 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:14:40.477461 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m23:14:40.479632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:14:40.484331 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m23:14:40.487053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7282AFD0>]}
[0m23:14:40.487053 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m23:14:40.487053 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m23:14:40.487053 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m23:14:40.490307 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_etudiant ................................ [RUN]
[0m23:14:40.490307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m23:14:40.490307 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m23:14:40.495240 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m23:14:40.495240 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m23:14:40.498272 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m23:14:40.500440 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:40.500440 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m23:14:40.502177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:40.541711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:14:40.542496 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:40.542496 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m23:14:40.543615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:14:40.543615 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:40.543615 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m23:14:40.552771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:40.553777 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:40.555782 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m23:14:40.555782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:40.558635 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:14:40.559118 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:40.559118 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:14:40.592855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:14:40.604018 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m23:14:40.606024 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:14:40.606024 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m23:14:40.609988 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:14:40.609988 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m23:14:40.612556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE72B19010>]}
[0m23:14:40.612556 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:14:40.614952 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m23:14:40.614952 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m23:14:40.614952 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_mobilite ................................ [RUN]
[0m23:14:40.614952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m23:14:40.614952 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m23:14:40.619660 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m23:14:40.621666 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m23:14:40.624677 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m23:14:40.626972 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:40.627798 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m23:14:40.627798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:40.667738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:14:40.667738 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:40.667738 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m23:14:40.671333 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:14:40.677089 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:40.677089 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m23:14:40.677089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:40.677089 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:40.677089 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m23:14:40.677089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:40.683195 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:14:40.683195 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:40.683195 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:14:40.720567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:14:40.720567 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m23:14:40.720567 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:14:40.720567 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m23:14:40.736276 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:14:40.739218 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m23:14:40.739218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE72B19050>]}
[0m23:14:40.742144 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:14:40.742144 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m23:14:40.743586 [debug] [Thread-1 (]: Began running node model.sid_lite.vw_fait_mobilite
[0m23:14:40.743586 [info ] [Thread-1 (]: 4 of 8 START sql view model public.vw_fait_mobilite ............................ [RUN]
[0m23:14:40.745141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.vw_fait_mobilite)
[0m23:14:40.745141 [debug] [Thread-1 (]: Began compiling node model.sid_lite.vw_fait_mobilite
[0m23:14:40.750744 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.vw_fait_mobilite"
[0m23:14:40.751435 [debug] [Thread-1 (]: Began executing node model.sid_lite.vw_fait_mobilite
[0m23:14:40.756778 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.vw_fait_mobilite"
[0m23:14:40.756778 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:14:40.758176 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: BEGIN
[0m23:14:40.758176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:40.900455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m23:14:40.903405 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:14:40.903405 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */

  create view "sid_lite"."public"."vw_fait_mobilite__dbt_tmp"
    
    
  as (
    

select
    m.id_mobilite,
    m.date_debut,
    m.date_fin,
    m.type_mobilite,
    m.statut_mobilite,
    -- Etudiant
    etu.id_etudiant,
    etu.nom as nom_etudiant,
    etu.prenom as prenom_etudiant,
    etu.date_naissance,
    etu.sexe,
    etu.nationalite,
    -- Etablissement d'origine
    e_orig.oid_etablissement as oid_etablissement_origine,
    e_orig.nom_etablissement as nom_etab_origine,
    e_orig.pays as pays_etab_origine,
    e_orig.ville as ville_etab_origine,
    e_orig.type_etablissement as type_etab_origine,
    -- Etablissement d'accueil
    e_acc.oid_etablissement as oid_etablissement_accueil,
    e_acc.nom_etablissement as nom_etab_accueil,
    e_acc.pays as pays_etab_accueil,
    e_acc.ville as ville_etab_accueil,
    e_acc.type_etablissement as type_etab_accueil,
    -- Techniques
    m.load_dts,
    m.source
from stg_mobilite m
left join stg_etudiant etu on m.id_etudiant = etu.id_etudiant
left join stg_etablissement e_orig on m.oid_etablissement_origine = e_orig.oid_etablissement
left join stg_etablissement e_acc on m.oid_etablissement_accueil = e_acc.oid_etablissement
  );
[0m23:14:40.948876 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne e_orig.ville n'existe pas
LINE 26:     e_orig.ville as ville_etab_origine,
             ^

[0m23:14:40.948876 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: ROLLBACK
[0m23:14:40.948876 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: Close
[0m23:14:40.959520 [debug] [Thread-1 (]: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.ville n'existe pas
  LINE 26:     e_orig.ville as ville_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:40.959520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE72AEC310>]}
[0m23:14:40.961526 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model public.vw_fait_mobilite ................... [[31mERROR[0m in 0.21s]
[0m23:14:40.961526 [debug] [Thread-1 (]: Finished running node model.sid_lite.vw_fait_mobilite
[0m23:14:40.961526 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m23:14:40.961526 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.vw_fait_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.ville n'existe pas
  LINE 26:     e_orig.ville as ville_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql.
[0m23:14:40.961526 [info ] [Thread-1 (]: 5 of 8 START sql table model public.hub_etablissement .......................... [RUN]
[0m23:14:40.964933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.vw_fait_mobilite, now model.sid_lite.hub_etablissement)
[0m23:14:40.964933 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m23:14:40.986468 [info ] [Thread-1 (]: 23:14:40 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m23:14:41.028976 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m23:14:41.028976 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m23:14:41.046909 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m23:14:41.046909 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:41.046909 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m23:14:41.046909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:41.083262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:14:41.093160 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:41.093160 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:14:41.102288 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.008 seconds
[0m23:14:41.111086 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:41.111086 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m23:14:41.111086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:41.111086 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:41.111086 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m23:14:41.111086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:41.117715 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:14:41.117715 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:41.117715 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:14:41.161162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:14:41.164451 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m23:14:41.164451 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:14:41.164451 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m23:14:41.173866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:14:41.173866 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m23:14:41.179108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE72B97FD0>]}
[0m23:14:41.179108 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.21s]
[0m23:14:41.180893 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m23:14:41.180893 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m23:14:41.180893 [info ] [Thread-1 (]: 6 of 8 START sql table model public.hub_etudiant ............................... [RUN]
[0m23:14:41.180893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m23:14:41.180893 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m23:14:41.187251 [info ] [Thread-1 (]: 23:14:41 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m23:14:41.191284 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m23:14:41.193384 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m23:14:41.197112 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m23:14:41.198138 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:41.198138 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m23:14:41.198138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:41.239017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:14:41.239017 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:41.241620 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:14:41.247938 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m23:14:41.249687 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:41.249687 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m23:14:41.249687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:41.254627 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:41.254627 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m23:14:41.254627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:41.258142 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:14:41.258142 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:41.259599 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:14:41.300934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:14:41.380923 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m23:14:41.380923 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:14:41.380923 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m23:14:41.417560 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m23:14:41.417560 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m23:14:41.417560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE72AC54D0>]}
[0m23:14:41.423859 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.24s]
[0m23:14:41.425866 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m23:14:41.427914 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m23:14:41.427914 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.link_mobilite ........................ [RUN]
[0m23:14:41.427914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m23:14:41.427914 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m23:14:41.432568 [info ] [Thread-1 (]: 23:14:41 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m23:14:41.454693 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m23:14:41.455744 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m23:14:41.479821 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.479821 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp231441476059"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:14:41.479821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:41.534077 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.050 seconds
[0m23:14:41.543473 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.543473 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m23:14:41.543473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:14:41.543473 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.543473 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp231441476059'
        
      order by ordinal_position

  
[0m23:14:41.557149 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m23:14:41.559157 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.559157 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:41.559157 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:14:41.559157 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.574794 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:41.577181 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:14:41.577181 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m23:14:41.577181 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.577181 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp231441476059"
    )


  
[0m23:14:41.588056 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:14:41.590233 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:14:41.590233 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:14:41.590233 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:14:41.623891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:14:41.623891 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m23:14:41.623891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6F4E0950>]}
[0m23:14:41.638071 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.20s]
[0m23:14:41.639834 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m23:14:41.639834 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m23:14:41.639834 [info ] [Thread-1 (]: 8 of 8 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m23:14:41.639834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m23:14:41.649030 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m23:14:41.754582 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m23:14:41.754582 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m23:14:41.763112 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.763112 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp231441763112"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:14:41.763112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:41.873978 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.105 seconds
[0m23:14:41.873978 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.873978 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m23:14:41.873978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:14:41.873978 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.873978 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp231441763112'
        
      order by ordinal_position

  
[0m23:14:41.910473 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.022 seconds
[0m23:14:41.913997 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.913997 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:41.926036 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:14:41.926036 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.938167 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:14:41.938167 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:14:41.938167 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m23:14:41.938167 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.938167 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp231441763112"
    )


  
[0m23:14:41.938167 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:14:41.954930 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:14:41.954930 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:14:41.954930 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:14:41.989231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:14:42.003740 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m23:14:42.005757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0a4f57-7f95-4a0f-9f0c-1d8cded84a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE71E75BD0>]}
[0m23:14:42.007772 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.37s]
[0m23:14:42.013820 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m23:14:42.020090 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:42.020090 [debug] [MainThread]: On master: BEGIN
[0m23:14:42.024611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:42.237427 [debug] [MainThread]: SQL status: BEGIN in 0.214 seconds
[0m23:14:42.239999 [debug] [MainThread]: On master: COMMIT
[0m23:14:42.239999 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:42.239999 [debug] [MainThread]: On master: COMMIT
[0m23:14:42.242535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:42.244318 [debug] [MainThread]: On master: Close
[0m23:14:42.246331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:42.246331 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m23:14:42.246331 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:14:42.246331 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m23:14:42.249773 [info ] [MainThread]: 
[0m23:14:42.252308 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 4 view models in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m23:14:42.256071 [debug] [MainThread]: Command end result
[0m23:14:42.332054 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:14:42.352394 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:14:42.365421 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:14:42.365421 [info ] [MainThread]: 
[0m23:14:42.367408 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:14:42.368558 [info ] [MainThread]: 
[0m23:14:42.370897 [error] [MainThread]: [31mFailure in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)[0m
[0m23:14:42.370897 [error] [MainThread]:   Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.ville n'existe pas
  LINE 26:     e_orig.ville as ville_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:42.370897 [info ] [MainThread]: 
[0m23:14:42.374547 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:14:42.375947 [info ] [MainThread]: 
[0m23:14:42.378474 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m23:14:42.380548 [debug] [MainThread]: Command `dbt run` failed at 23:14:42.380548 after 3.68 seconds
[0m23:14:42.380548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7057B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7279AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE6FC73010>]}
[0m23:14:42.383301 [debug] [MainThread]: Flushing usage events
[0m23:14:42.899475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:36.894883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E3EF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E4335D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E431A50>]}


============================== 23:15:36.900318 | 154c9dc7-ef27-497b-8b73-4fee3c5e548a ==============================
[0m23:15:36.900318 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:15:36.900318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:15:37.071566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3AF62DD0>]}
[0m23:15:37.128273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3AD0E590>]}
[0m23:15:37.129504 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:15:37.279267 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:15:37.500180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:15:37.500180 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:15:37.928064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3F9DC250>]}
[0m23:15:37.991647 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:15:38.004498 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:15:38.023315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3F976D90>]}
[0m23:15:38.023315 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:15:38.033105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3F88F590>]}
[0m23:15:38.034403 [info ] [MainThread]: 
[0m23:15:38.034403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:15:38.034403 [info ] [MainThread]: 
[0m23:15:38.034403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:15:38.045115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m23:15:38.228786 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m23:15:38.228786 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m23:15:38.228786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:38.280788 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.061 seconds
[0m23:15:38.280788 [debug] [ThreadPool]: On list_sid_lite: Close
[0m23:15:38.280788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:15:38.296890 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:15:38.296890 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:15:38.296890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:38.344695 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m23:15:38.344695 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:15:38.346155 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:15:38.348545 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:15:38.348545 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:15:38.348545 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:15:38.365845 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:38.367412 [debug] [MainThread]: On master: BEGIN
[0m23:15:38.367412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:15:38.414864 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:15:38.414864 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:38.414864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:15:38.414864 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m23:15:38.426810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3F975E90>]}
[0m23:15:38.427865 [debug] [MainThread]: On master: ROLLBACK
[0m23:15:38.427865 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:38.427865 [debug] [MainThread]: On master: BEGIN
[0m23:15:38.427865 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:15:38.427865 [debug] [MainThread]: On master: COMMIT
[0m23:15:38.427865 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:38.427865 [debug] [MainThread]: On master: COMMIT
[0m23:15:38.427865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:15:38.427865 [debug] [MainThread]: On master: Close
[0m23:15:38.427865 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m23:15:38.427865 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_etablissement ........................... [RUN]
[0m23:15:38.427865 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m23:15:38.427865 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m23:15:38.440405 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m23:15:38.440405 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m23:15:38.465862 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m23:15:38.465862 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:15:38.465862 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m23:15:38.476496 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:15:38.516961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:15:38.516961 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:15:38.516961 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m23:15:38.525002 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:15:38.533068 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:15:38.533068 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m23:15:38.533068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:15:38.533068 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:15:38.533068 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m23:15:38.533068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:15:38.548863 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:15:38.548863 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:15:38.548863 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:15:38.578734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m23:15:38.580501 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m23:15:38.580501 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:15:38.580501 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m23:15:38.580501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:15:38.596183 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m23:15:38.596183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4027D150>]}
[0m23:15:38.596183 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m23:15:38.596183 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m23:15:38.596183 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m23:15:38.596183 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_etudiant ................................ [RUN]
[0m23:15:38.596183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m23:15:38.596183 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m23:15:38.596183 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m23:15:38.596183 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m23:15:38.611882 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m23:15:38.613244 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:15:38.613244 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m23:15:38.614697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:38.646331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:15:38.646331 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:15:38.646331 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m23:15:38.661816 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:15:38.661816 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:15:38.661816 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m23:15:38.661816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:15:38.661816 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:15:38.661816 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m23:15:38.661816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:15:38.661816 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:15:38.661816 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:15:38.673848 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:15:38.712929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m23:15:38.715952 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m23:15:38.715952 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:15:38.715952 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m23:15:38.722605 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:15:38.724614 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m23:15:38.726948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4027D510>]}
[0m23:15:38.726948 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:15:38.729293 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m23:15:38.729293 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m23:15:38.731045 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_mobilite ................................ [RUN]
[0m23:15:38.732148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m23:15:38.732148 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m23:15:38.735314 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m23:15:38.735314 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m23:15:38.739067 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m23:15:38.741073 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:15:38.741073 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m23:15:38.741073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:38.777373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:15:38.777373 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:15:38.777373 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m23:15:38.783489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:15:38.786998 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:15:38.786998 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m23:15:38.786998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:15:38.794317 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:15:38.794317 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m23:15:38.795337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:15:38.796451 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:15:38.796451 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:15:38.796451 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:15:38.837532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m23:15:38.841541 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m23:15:38.841541 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:15:38.841541 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m23:15:38.844220 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:15:38.844220 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m23:15:38.851995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C402777D0>]}
[0m23:15:38.852504 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:15:38.852504 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m23:15:38.852504 [debug] [Thread-1 (]: Began running node model.sid_lite.vw_fait_mobilite
[0m23:15:38.856090 [info ] [Thread-1 (]: 4 of 8 START sql view model public.vw_fait_mobilite ............................ [RUN]
[0m23:15:38.857247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.vw_fait_mobilite)
[0m23:15:38.857247 [debug] [Thread-1 (]: Began compiling node model.sid_lite.vw_fait_mobilite
[0m23:15:38.859253 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.vw_fait_mobilite"
[0m23:15:38.859253 [debug] [Thread-1 (]: Began executing node model.sid_lite.vw_fait_mobilite
[0m23:15:38.865429 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.vw_fait_mobilite"
[0m23:15:38.865429 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:15:38.867942 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: BEGIN
[0m23:15:38.867942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:38.908536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:15:38.909959 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:15:38.911107 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */

  create view "sid_lite"."public"."vw_fait_mobilite__dbt_tmp"
    
    
  as (
    

select
    m.id_mobilite,
    m.date_debut,
    m.date_fin,
    m.type_mobilite,
    m.statut_mobilite,
    -- Etudiant
    etu.id_etudiant,
    etu.nom as nom_etudiant,
    etu.prenom as prenom_etudiant,
    etu.date_naissance,
    etu.sexe,
    etu.nationalite,
    -- Etablissement d'origine
    e_orig.oid_etablissement as oid_etablissement_origine,
    e_orig.nom_etablissement as nom_etab_origine,
    e_orig.pays as pays_etab_origine,
    e_orig.ville as ville_etab_origine,
    e_orig.type_etablissement as type_etab_origine,
    -- Etablissement d'accueil
    e_acc.oid_etablissement as oid_etablissement_accueil,
    e_acc.nom_etablissement as nom_etab_accueil,
    e_acc.pays as pays_etab_accueil,
    e_acc.type_etablissement as type_etab_accueil,
    -- Techniques
    m.load_dts,
    m.source
from stg_mobilite m
left join stg_etudiant etu on m.id_etudiant = etu.id_etudiant
left join stg_etablissement e_orig on m.oid_etablissement_origine = e_orig.oid_etablissement
left join stg_etablissement e_acc on m.oid_etablissement_accueil = e_acc.oid_etablissement
  );
[0m23:15:38.912244 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne e_orig.ville n'existe pas
LINE 26:     e_orig.ville as ville_etab_origine,
             ^

[0m23:15:38.912244 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: ROLLBACK
[0m23:15:38.912244 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: Close
[0m23:15:38.919035 [debug] [Thread-1 (]: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.ville n'existe pas
  LINE 26:     e_orig.ville as ville_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:15:38.919035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3FE93710>]}
[0m23:15:38.919035 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model public.vw_fait_mobilite ................... [[31mERROR[0m in 0.06s]
[0m23:15:38.919035 [debug] [Thread-1 (]: Finished running node model.sid_lite.vw_fait_mobilite
[0m23:15:38.923552 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m23:15:38.923552 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.vw_fait_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.ville n'existe pas
  LINE 26:     e_orig.ville as ville_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql.
[0m23:15:38.924559 [info ] [Thread-1 (]: 5 of 8 START sql table model public.hub_etablissement .......................... [RUN]
[0m23:15:38.924559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.vw_fait_mobilite, now model.sid_lite.hub_etablissement)
[0m23:15:38.924559 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m23:15:38.947991 [info ] [Thread-1 (]: 23:15:38 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m23:15:38.995694 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m23:15:38.995694 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m23:15:39.010875 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m23:15:39.010875 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:15:39.010875 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m23:15:39.016384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:39.051394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:15:39.051394 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:15:39.056779 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:15:39.098669 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.043 seconds
[0m23:15:39.098669 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:15:39.098669 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m23:15:39.098669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:15:39.098669 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:15:39.114665 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m23:15:39.114665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:15:39.116475 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:15:39.116475 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:15:39.116475 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:15:39.119111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:15:39.121342 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m23:15:39.121342 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:15:39.121342 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m23:15:39.121342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m23:15:39.130705 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m23:15:39.132712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C4036B8D0>]}
[0m23:15:39.132712 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.21s]
[0m23:15:39.132712 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m23:15:39.135648 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m23:15:39.136897 [info ] [Thread-1 (]: 6 of 8 START sql table model public.hub_etudiant ............................... [RUN]
[0m23:15:39.136897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m23:15:39.138309 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m23:15:39.140447 [info ] [Thread-1 (]: 23:15:39 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m23:15:39.144919 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m23:15:39.145847 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m23:15:39.147439 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m23:15:39.147439 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:15:39.147439 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m23:15:39.147439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:39.193085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:15:39.193085 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:15:39.194070 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:15:39.198544 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.006 seconds
[0m23:15:39.203273 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:15:39.203273 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m23:15:39.203273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:15:39.208072 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:15:39.208072 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m23:15:39.209821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:15:39.211062 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:15:39.211062 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:15:39.211062 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:15:39.252848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:15:39.340366 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m23:15:39.340366 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:15:39.340366 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m23:15:39.370458 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.027 seconds
[0m23:15:39.370458 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m23:15:39.372465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C404FBE90>]}
[0m23:15:39.374472 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.24s]
[0m23:15:39.376478 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m23:15:39.377900 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m23:15:39.377900 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.link_mobilite ........................ [RUN]
[0m23:15:39.379647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m23:15:39.379647 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m23:15:39.390552 [info ] [Thread-1 (]: 23:15:39 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m23:15:39.408495 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m23:15:39.412017 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m23:15:39.429923 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.429923 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp231539429923"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:15:39.429923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:39.483556 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m23:15:39.492030 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.492030 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m23:15:39.492030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:15:39.497613 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.497613 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp231539429923'
        
      order by ordinal_position

  
[0m23:15:39.508362 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m23:15:39.513011 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.514556 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:15:39.517610 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:15:39.525318 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.525318 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:15:39.528394 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:15:39.535929 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m23:15:39.535929 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.537936 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp231539429923"
    )


  
[0m23:15:39.537936 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:15:39.537936 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:15:39.540847 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:15:39.540847 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:15:39.542393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:15:39.549998 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m23:15:39.552006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3FDD39D0>]}
[0m23:15:39.553753 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.17s]
[0m23:15:39.555759 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m23:15:39.555759 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m23:15:39.555759 [info ] [Thread-1 (]: 8 of 8 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m23:15:39.555759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m23:15:39.555759 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m23:15:39.597316 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m23:15:39.597316 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m23:15:39.608372 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.608372 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp231539607334"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:15:39.609384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:39.657555 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.048 seconds
[0m23:15:39.657555 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.657555 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m23:15:39.657555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:15:39.657555 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.657555 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp231539607334'
        
      order by ordinal_position

  
[0m23:15:39.671809 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m23:15:39.673802 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.673802 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:15:39.673802 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:15:39.681100 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.681100 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:15:39.681100 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:15:39.681100 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m23:15:39.681100 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.681100 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp231539607334"
    )


  
[0m23:15:39.690957 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:15:39.690957 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:15:39.690957 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:15:39.690957 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:15:39.731380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:15:39.735378 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m23:15:39.737387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154c9dc7-ef27-497b-8b73-4fee3c5e548a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3F5F6590>]}
[0m23:15:39.737387 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.18s]
[0m23:15:39.739393 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m23:15:39.742813 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:39.742813 [debug] [MainThread]: On master: BEGIN
[0m23:15:39.742813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:39.797227 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m23:15:39.797227 [debug] [MainThread]: On master: COMMIT
[0m23:15:39.797227 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:39.797227 [debug] [MainThread]: On master: COMMIT
[0m23:15:39.799233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:15:39.799233 [debug] [MainThread]: On master: Close
[0m23:15:39.800241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:39.801248 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m23:15:39.801248 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:15:39.801248 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m23:15:39.803254 [info ] [MainThread]: 
[0m23:15:39.804494 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 4 view models in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m23:15:39.806499 [debug] [MainThread]: Command end result
[0m23:15:39.846317 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:15:39.852042 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:15:39.853902 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:15:39.853902 [info ] [MainThread]: 
[0m23:15:39.859844 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:15:39.859844 [info ] [MainThread]: 
[0m23:15:39.861420 [error] [MainThread]: [31mFailure in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)[0m
[0m23:15:39.861986 [error] [MainThread]:   Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.ville n'existe pas
  LINE 26:     e_orig.ville as ville_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:15:39.863831 [info ] [MainThread]: 
[0m23:15:39.865422 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:15:39.865422 [info ] [MainThread]: 
[0m23:15:39.867637 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m23:15:39.868653 [debug] [MainThread]: Command `dbt run` failed at 23:15:39.868653 after 3.07 seconds
[0m23:15:39.868653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3D4CE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3FEEFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3F9B0550>]}
[0m23:15:39.868653 [debug] [MainThread]: Flushing usage events
[0m23:15:40.360288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:07.084371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DED17E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DFD67D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DFD40950>]}


============================== 23:16:07.089458 | a111b0d6-c9d7-4444-8b8d-68e407bc6d33 ==============================
[0m23:16:07.089458 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:16:07.089458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:07.263840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DFEB3950>]}
[0m23:16:07.314841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DB65ECD0>]}
[0m23:16:07.314841 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:16:07.482625 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:16:07.736425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:07.736425 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:16:08.164637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0464B90>]}
[0m23:16:08.226833 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:16:08.226833 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:16:08.258651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E01BAA50>]}
[0m23:16:08.264569 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:16:08.264569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E07F1690>]}
[0m23:16:08.264569 [info ] [MainThread]: 
[0m23:16:08.264569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:08.264569 [info ] [MainThread]: 
[0m23:16:08.264569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:08.264569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m23:16:08.443261 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m23:16:08.446343 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m23:16:08.446343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:08.494664 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.048 seconds
[0m23:16:08.494664 [debug] [ThreadPool]: On list_sid_lite: Close
[0m23:16:08.498361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:16:08.502703 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:16:08.502703 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:16:08.502703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:08.540796 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m23:16:08.543711 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:16:08.543711 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:16:08.549741 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:16:08.554427 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:16:08.554934 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:16:08.562420 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:08.563952 [debug] [MainThread]: On master: BEGIN
[0m23:16:08.564465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:16:08.598556 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m23:16:08.598556 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:08.601447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:16:08.606987 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m23:16:08.610030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E07035D0>]}
[0m23:16:08.610030 [debug] [MainThread]: On master: ROLLBACK
[0m23:16:08.610030 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:08.610030 [debug] [MainThread]: On master: BEGIN
[0m23:16:08.612159 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:16:08.612159 [debug] [MainThread]: On master: COMMIT
[0m23:16:08.613352 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:08.613352 [debug] [MainThread]: On master: COMMIT
[0m23:16:08.613352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:16:08.614813 [debug] [MainThread]: On master: Close
[0m23:16:08.620514 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m23:16:08.620514 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_etablissement ........................... [RUN]
[0m23:16:08.622520 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m23:16:08.622520 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m23:16:08.625416 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m23:16:08.625416 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m23:16:08.666624 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m23:16:08.666624 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:08.666624 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m23:16:08.666624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:16:08.718089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m23:16:08.718089 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:08.718089 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m23:16:08.719894 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:16:08.723199 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:08.723199 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m23:16:08.723199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:08.732460 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:08.732460 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m23:16:08.732460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:08.746737 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:16:08.746737 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:08.746737 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:16:08.772130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m23:16:08.786446 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m23:16:08.786446 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:08.786446 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m23:16:08.836539 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.039 seconds
[0m23:16:08.842917 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m23:16:08.850960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E07BFE50>]}
[0m23:16:08.853420 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:16:08.857260 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m23:16:08.857260 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m23:16:08.859580 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_etudiant ................................ [RUN]
[0m23:16:08.862412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m23:16:08.864262 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m23:16:08.877029 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m23:16:08.883583 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m23:16:08.892611 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m23:16:08.895754 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:08.898832 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m23:16:08.900376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:08.986468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m23:16:08.988409 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:08.988409 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m23:16:08.993559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:16:09.007533 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:09.007533 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m23:16:09.007533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.007533 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:09.007533 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m23:16:09.021471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.024266 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:16:09.024266 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:09.024266 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:16:09.064784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:16:09.076084 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m23:16:09.078095 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:09.078095 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m23:16:09.083426 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:16:09.087602 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m23:16:09.089634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0CF6E90>]}
[0m23:16:09.092364 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:16:09.095399 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m23:16:09.097236 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m23:16:09.097236 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_mobilite ................................ [RUN]
[0m23:16:09.100831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m23:16:09.102407 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m23:16:09.110262 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m23:16:09.112456 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m23:16:09.118189 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m23:16:09.127365 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:09.129444 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m23:16:09.129444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:09.217483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m23:16:09.217483 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:09.217483 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m23:16:09.234274 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:16:09.234274 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:09.234274 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m23:16:09.234274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.251058 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:09.253067 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m23:16:09.255077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.255077 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:16:09.255077 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:09.255077 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:16:09.301726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m23:16:09.314879 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m23:16:09.314879 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:09.314879 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m23:16:09.324078 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:16:09.324078 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m23:16:09.329045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0B36B90>]}
[0m23:16:09.331086 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:16:09.333650 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m23:16:09.335100 [debug] [Thread-1 (]: Began running node model.sid_lite.vw_fait_mobilite
[0m23:16:09.335100 [info ] [Thread-1 (]: 4 of 8 START sql view model public.vw_fait_mobilite ............................ [RUN]
[0m23:16:09.338231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.vw_fait_mobilite)
[0m23:16:09.340846 [debug] [Thread-1 (]: Began compiling node model.sid_lite.vw_fait_mobilite
[0m23:16:09.351521 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.vw_fait_mobilite"
[0m23:16:09.351521 [debug] [Thread-1 (]: Began executing node model.sid_lite.vw_fait_mobilite
[0m23:16:09.362048 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.vw_fait_mobilite"
[0m23:16:09.367606 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:09.368622 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: BEGIN
[0m23:16:09.368622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:09.466288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.096 seconds
[0m23:16:09.466288 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:09.466288 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */

  create view "sid_lite"."public"."vw_fait_mobilite__dbt_tmp"
    
    
  as (
    

select
    m.id_mobilite,
    m.date_debut,
    m.date_fin,
    m.type_mobilite,
    m.statut_mobilite,
    -- Etudiant
    etu.id_etudiant,
    etu.nom as nom_etudiant,
    etu.prenom as prenom_etudiant,
    etu.date_naissance,
    etu.sexe,
    etu.nationalite,
    -- Etablissement d'origine
    e_orig.oid_etablissement as oid_etablissement_origine,
    e_orig.nom_etablissement as nom_etab_origine,
    e_orig.pays as pays_etab_origine,
    e_orig.type_etablissement as type_etab_origine,
    -- Etablissement d'accueil
    e_acc.oid_etablissement as oid_etablissement_accueil,
    e_acc.nom_etablissement as nom_etab_accueil,
    e_acc.pays as pays_etab_accueil,
    e_acc.type_etablissement as type_etab_accueil,
    -- Techniques
    m.load_dts,
    m.source
from stg_mobilite m
left join stg_etudiant etu on m.id_etudiant = etu.id_etudiant
left join stg_etablissement e_orig on m.oid_etablissement_origine = e_orig.oid_etablissement
left join stg_etablissement e_acc on m.oid_etablissement_accueil = e_acc.oid_etablissement
  );
[0m23:16:09.472618 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne e_orig.type_etablissement n'existe pas
LINE 26:     e_orig.type_etablissement as type_etab_origine,
             ^

[0m23:16:09.472618 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: ROLLBACK
[0m23:16:09.472618 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: Close
[0m23:16:09.491587 [debug] [Thread-1 (]: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.type_etablissement n'existe pas
  LINE 26:     e_orig.type_etablissement as type_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:16:09.493710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0CF9CD0>]}
[0m23:16:09.494748 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model public.vw_fait_mobilite ................... [[31mERROR[0m in 0.15s]
[0m23:16:09.496501 [debug] [Thread-1 (]: Finished running node model.sid_lite.vw_fait_mobilite
[0m23:16:09.498823 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m23:16:09.498823 [debug] [Thread-4 (]: Marking all children of 'model.sid_lite.vw_fait_mobilite' to be skipped because of status 'error'.  Reason: Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.type_etablissement n'existe pas
  LINE 26:     e_orig.type_etablissement as type_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql.
[0m23:16:09.500872 [info ] [Thread-1 (]: 5 of 8 START sql table model public.hub_etablissement .......................... [RUN]
[0m23:16:09.504550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.vw_fait_mobilite, now model.sid_lite.hub_etablissement)
[0m23:16:09.509502 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m23:16:09.568365 [info ] [Thread-1 (]: 23:16:09 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m23:16:09.633041 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m23:16:09.641105 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m23:16:09.657332 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m23:16:09.657332 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:09.657332 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m23:16:09.657332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:09.712729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m23:16:09.712729 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:09.712729 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:16:09.728529 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.010 seconds
[0m23:16:09.728529 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:09.728529 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m23:16:09.744252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:09.744252 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:09.744252 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m23:16:09.744252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.744252 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:16:09.744252 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:09.744252 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:16:09.792999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m23:16:09.792999 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m23:16:09.802203 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:09.802203 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m23:16:09.808752 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:16:09.808752 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m23:16:09.808752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0B37450>]}
[0m23:16:09.808752 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.30s]
[0m23:16:09.808752 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m23:16:09.808752 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m23:16:09.808752 [info ] [Thread-1 (]: 6 of 8 START sql table model public.hub_etudiant ............................... [RUN]
[0m23:16:09.808752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m23:16:09.808752 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m23:16:09.808752 [info ] [Thread-1 (]: 23:16:09 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m23:16:09.824978 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m23:16:09.824978 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m23:16:09.830860 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m23:16:09.830860 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:09.830860 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m23:16:09.830860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:09.893511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m23:16:09.893511 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:09.893511 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:16:09.900254 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.008 seconds
[0m23:16:09.910700 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:09.910700 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m23:16:09.910700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.910700 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:09.916878 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m23:16:09.918609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:09.920191 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:16:09.920191 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:09.921761 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:16:09.958074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m23:16:10.091627 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m23:16:10.091627 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:10.091627 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m23:16:10.124229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m23:16:10.124229 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m23:16:10.124229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0D82B90>]}
[0m23:16:10.139154 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.32s]
[0m23:16:10.139154 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m23:16:10.139154 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m23:16:10.139154 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.link_mobilite ........................ [RUN]
[0m23:16:10.139154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m23:16:10.149128 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m23:16:10.167163 [info ] [Thread-1 (]: 23:16:10 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m23:16:10.210248 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m23:16:10.215160 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m23:16:10.252835 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.253842 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp231610246815"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:16:10.253842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:10.322123 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.068 seconds
[0m23:16:10.333366 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.333366 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m23:16:10.342081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:16:10.342081 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.342081 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp231610246815'
        
      order by ordinal_position

  
[0m23:16:10.360088 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.016 seconds
[0m23:16:10.361151 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.367212 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:10.367212 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m23:16:10.382146 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.382146 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:10.385294 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:16:10.396260 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m23:16:10.397829 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.397829 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp231610246815"
    )


  
[0m23:16:10.400044 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:16:10.401324 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:16:10.401324 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:10.401324 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:16:10.411073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m23:16:10.411073 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m23:16:10.411073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DE528510>]}
[0m23:16:10.420994 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.27s]
[0m23:16:10.422582 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m23:16:10.424084 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m23:16:10.424084 [info ] [Thread-1 (]: 8 of 8 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m23:16:10.426091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m23:16:10.426091 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m23:16:10.482850 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m23:16:10.484856 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m23:16:10.486803 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.486803 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp231610486803"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:16:10.486803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:10.551337 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.062 seconds
[0m23:16:10.557714 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.557714 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m23:16:10.560057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:16:10.561433 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.561433 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp231610486803'
        
      order by ordinal_position

  
[0m23:16:10.573786 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.012 seconds
[0m23:16:10.573786 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.573786 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:10.573786 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:16:10.573786 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.589556 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:10.589556 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:16:10.589556 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m23:16:10.589556 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.589556 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp231610486803"
    )


  
[0m23:16:10.599193 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:16:10.599193 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:16:10.601254 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:10.601254 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:16:10.643647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:16:10.645655 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m23:16:10.647663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a111b0d6-c9d7-4444-8b8d-68e407bc6d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DFF210D0>]}
[0m23:16:10.649673 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.22s]
[0m23:16:10.651680 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m23:16:10.654907 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:10.654907 [debug] [MainThread]: On master: BEGIN
[0m23:16:10.654907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:16:10.713608 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m23:16:10.715549 [debug] [MainThread]: On master: COMMIT
[0m23:16:10.715549 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:10.716865 [debug] [MainThread]: On master: COMMIT
[0m23:16:10.716865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:16:10.716865 [debug] [MainThread]: On master: Close
[0m23:16:10.719034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:10.719034 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m23:16:10.719034 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:16:10.720372 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m23:16:10.720372 [info ] [MainThread]: 
[0m23:16:10.720372 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 4 view models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m23:16:10.724010 [debug] [MainThread]: Command end result
[0m23:16:10.786208 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:16:10.798126 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:16:10.803145 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:16:10.803145 [info ] [MainThread]: 
[0m23:16:10.805153 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:16:10.805153 [info ] [MainThread]: 
[0m23:16:10.807657 [error] [MainThread]: [31mFailure in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)[0m
[0m23:16:10.807657 [error] [MainThread]:   Database Error in model vw_fait_mobilite (dbt/sid-lite/models\marts\vw_fait_mobilite.sql)
  ERREUR:  la colonne e_orig.type_etablissement n'existe pas
  LINE 26:     e_orig.type_etablissement as type_etab_origine,
               ^
  compiled code at target\run\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:16:10.808666 [info ] [MainThread]: 
[0m23:16:10.810573 [info ] [MainThread]:   compiled code at target\compiled\sid_lite\dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:16:10.812580 [info ] [MainThread]: 
[0m23:16:10.814055 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m23:16:10.817484 [debug] [MainThread]: Command `dbt run` failed at 23:16:10.817484 after 3.82 seconds
[0m23:16:10.817991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DB8E84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DEACD610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DDE72090>]}
[0m23:16:10.818781 [debug] [MainThread]: Flushing usage events
[0m23:16:11.339895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:50.861208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A74E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A792AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6B797E90>]}


============================== 23:16:50.868803 | 0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be ==============================
[0m23:16:50.868803 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:16:50.868803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:16:51.045853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69EEA1D0>]}
[0m23:16:51.093313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6700ED90>]}
[0m23:16:51.093313 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:16:51.267327 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:16:51.486480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:51.486480 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\marts\vw_fait_mobilite.sql
[0m23:16:51.901477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6BD63510>]}
[0m23:16:51.991952 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:16:51.991952 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:16:52.023623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6BCD6210>]}
[0m23:16:52.023623 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:16:52.023623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE69777610>]}
[0m23:16:52.023623 [info ] [MainThread]: 
[0m23:16:52.023623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:52.023623 [info ] [MainThread]: 
[0m23:16:52.023623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:52.023623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite'
[0m23:16:52.169057 [debug] [ThreadPool]: Using postgres connection "list_sid_lite"
[0m23:16:52.169057 [debug] [ThreadPool]: On list_sid_lite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite"} */

    select distinct nspname from pg_namespace
  
[0m23:16:52.169057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:52.222046 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.052 seconds
[0m23:16:52.223940 [debug] [ThreadPool]: On list_sid_lite: Close
[0m23:16:52.227199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:16:52.233469 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:16:52.233469 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:16:52.233469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:52.273705 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m23:16:52.277228 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:16:52.277228 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:16:52.284037 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m23:16:52.285559 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:16:52.286577 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:16:52.294411 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:52.295962 [debug] [MainThread]: On master: BEGIN
[0m23:16:52.295962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:16:52.332275 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:16:52.332275 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:52.335303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:16:52.340565 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m23:16:52.340565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C1EFFD0>]}
[0m23:16:52.343758 [debug] [MainThread]: On master: ROLLBACK
[0m23:16:52.343758 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:52.343758 [debug] [MainThread]: On master: BEGIN
[0m23:16:52.345987 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:16:52.345987 [debug] [MainThread]: On master: COMMIT
[0m23:16:52.345987 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:52.345987 [debug] [MainThread]: On master: COMMIT
[0m23:16:52.347995 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:16:52.347995 [debug] [MainThread]: On master: Close
[0m23:16:52.351418 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etablissement
[0m23:16:52.354374 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_etablissement ........................... [RUN]
[0m23:16:52.355950 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sid_lite.stg_etablissement'
[0m23:16:52.355950 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etablissement
[0m23:16:52.362961 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etablissement"
[0m23:16:52.364639 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etablissement
[0m23:16:52.395264 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etablissement"
[0m23:16:52.395264 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:52.398778 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: BEGIN
[0m23:16:52.398778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:16:52.439873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:16:52.439873 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:52.439873 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */

  create view "sid_lite"."public"."stg_etablissement__dbt_tmp"
    
    
  as (
    

select
    oid_etablissement,
    nom_etablissement,
    pays,
    type_organisation,
    current_timestamp as load_dts,      -- champ obligatoire pour Data Vault (horodatage du chargement)
    'ERASMUS' as source                -- champ obligatoire pour Data Vault (identifiant de la source)
from "sid_lite"."public"."etablissement"
  );
[0m23:16:52.446156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:16:52.452170 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:52.452170 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement" rename to "stg_etablissement__dbt_backup"
[0m23:16:52.454175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:52.458434 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:52.458434 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
alter table "sid_lite"."public"."stg_etablissement__dbt_tmp" rename to "stg_etablissement"
[0m23:16:52.458434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:52.467957 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:16:52.467957 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:52.467957 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: COMMIT
[0m23:16:52.496408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m23:16:52.505931 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etablissement__dbt_backup"
[0m23:16:52.505931 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etablissement"
[0m23:16:52.505931 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etablissement"} */
drop view if exists "sid_lite"."public"."stg_etablissement__dbt_backup" cascade
[0m23:16:52.521962 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.011 seconds
[0m23:16:52.521962 [debug] [Thread-1 (]: On model.sid_lite.stg_etablissement: Close
[0m23:16:52.521962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C541850>]}
[0m23:16:52.530732 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_etablissement ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m23:16:52.534745 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etablissement
[0m23:16:52.534745 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_etudiant
[0m23:16:52.534745 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_etudiant ................................ [RUN]
[0m23:16:52.537223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etablissement, now model.sid_lite.stg_etudiant)
[0m23:16:52.537223 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_etudiant
[0m23:16:52.543565 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_etudiant"
[0m23:16:52.547304 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_etudiant
[0m23:16:52.550321 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_etudiant"
[0m23:16:52.550321 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:52.554335 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: BEGIN
[0m23:16:52.554335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:52.618999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m23:16:52.618999 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:52.621007 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */

  create view "sid_lite"."public"."stg_etudiant__dbt_tmp"
    
    
  as (
    

select
  id_etudiant,
  prenom,
  nom,
  sexe,
  date_naissance,
  nationalite,
  discipline,
  current_timestamp as load_dts,
  'ERASMUS' as source
from "sid_lite"."public"."etudiant"
  );
[0m23:16:52.625033 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:16:52.628261 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:52.628261 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant" rename to "stg_etudiant__dbt_backup"
[0m23:16:52.628261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:52.634356 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:52.634356 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
alter table "sid_lite"."public"."stg_etudiant__dbt_tmp" rename to "stg_etudiant"
[0m23:16:52.634356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:52.634356 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:16:52.637933 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:52.637933 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: COMMIT
[0m23:16:52.680333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m23:16:52.681725 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_etudiant__dbt_backup"
[0m23:16:52.681725 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_etudiant"
[0m23:16:52.681725 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_etudiant"} */
drop view if exists "sid_lite"."public"."stg_etudiant__dbt_backup" cascade
[0m23:16:52.691318 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:16:52.693370 [debug] [Thread-1 (]: On model.sid_lite.stg_etudiant: Close
[0m23:16:52.693370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C5FA950>]}
[0m23:16:52.695195 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_etudiant ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m23:16:52.696262 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_etudiant
[0m23:16:52.696262 [debug] [Thread-1 (]: Began running node model.sid_lite.stg_mobilite
[0m23:16:52.699084 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_mobilite ................................ [RUN]
[0m23:16:52.699084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_etudiant, now model.sid_lite.stg_mobilite)
[0m23:16:52.699084 [debug] [Thread-1 (]: Began compiling node model.sid_lite.stg_mobilite
[0m23:16:52.702932 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.stg_mobilite"
[0m23:16:52.702932 [debug] [Thread-1 (]: Began executing node model.sid_lite.stg_mobilite
[0m23:16:52.705600 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.stg_mobilite"
[0m23:16:52.705600 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:52.705600 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: BEGIN
[0m23:16:52.705600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:52.750287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:16:52.752292 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:52.752292 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */

  create view "sid_lite"."public"."stg_mobilite__dbt_tmp"
    
    
  as (
    SELECT
    id_mobilite,
    id_etudiant,
    oid_etablissement_origine,
    oid_etablissement_accueil,
    date_debut,
    date_fin,
    type_mobilite,
    statut_mobilite,
    current_timestamp as load_dts,
    'ERASMUS' as source,
    cast(
        encode(
            digest(
            coalesce(cast(id_mobilite as text),'') || '|' ||
            coalesce(cast(date_debut as text),'') || '|' ||
            coalesce(cast(date_fin as text),'') || '|' ||
            coalesce(cast(type_mobilite as text),'') || '|' ||
            coalesce(cast(statut_mobilite as text),''),
            'sha256'
            ),
            'hex'
            ) as text
        ) as hashdiff_mobilite
FROM "sid_lite"."public"."mobilite"
  );
[0m23:16:52.756300 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:16:52.758305 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:52.761399 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite" rename to "stg_mobilite__dbt_backup"
[0m23:16:52.762010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:52.763663 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:52.763663 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
alter table "sid_lite"."public"."stg_mobilite__dbt_tmp" rename to "stg_mobilite"
[0m23:16:52.763663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:52.768825 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:16:52.768825 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:52.768825 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: COMMIT
[0m23:16:52.807992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m23:16:52.810458 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."stg_mobilite__dbt_backup"
[0m23:16:52.810458 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.stg_mobilite"
[0m23:16:52.810458 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.stg_mobilite"} */
drop view if exists "sid_lite"."public"."stg_mobilite__dbt_backup" cascade
[0m23:16:52.817224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:16:52.817224 [debug] [Thread-1 (]: On model.sid_lite.stg_mobilite: Close
[0m23:16:52.820644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6BC03450>]}
[0m23:16:52.820644 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_mobilite ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:16:52.823627 [debug] [Thread-1 (]: Finished running node model.sid_lite.stg_mobilite
[0m23:16:52.823627 [debug] [Thread-1 (]: Began running node model.sid_lite.vw_fait_mobilite
[0m23:16:52.825316 [info ] [Thread-1 (]: 4 of 8 START sql view model public.vw_fait_mobilite ............................ [RUN]
[0m23:16:52.826326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.stg_mobilite, now model.sid_lite.vw_fait_mobilite)
[0m23:16:52.826326 [debug] [Thread-1 (]: Began compiling node model.sid_lite.vw_fait_mobilite
[0m23:16:52.828310 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.828310 [debug] [Thread-1 (]: Began executing node model.sid_lite.vw_fait_mobilite
[0m23:16:52.828310 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.828310 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.828310 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: BEGIN
[0m23:16:52.828310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:52.878972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:16:52.878972 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.878972 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */

  create view "sid_lite"."public"."vw_fait_mobilite__dbt_tmp"
    
    
  as (
    

select
    m.id_mobilite,
    m.date_debut,
    m.date_fin,
    m.type_mobilite,
    m.statut_mobilite,
    -- Etudiant
    etu.id_etudiant,
    etu.nom as nom_etudiant,
    etu.prenom as prenom_etudiant,
    etu.date_naissance,
    etu.sexe,
    etu.nationalite,
    -- Etablissement d'origine
    e_orig.oid_etablissement as oid_etablissement_origine,
    e_orig.nom_etablissement as nom_etab_origine,
    e_orig.pays as pays_etab_origine,
    e_orig.type_organisation as type_etab_origine,
    -- Etablissement d'accueil
    e_acc.oid_etablissement as oid_etablissement_accueil,
    e_acc.nom_etablissement as nom_etab_accueil,
    e_acc.pays as pays_etab_accueil,
    e_acc.type_organisation as type_etab_accueil,
    -- Techniques
    m.load_dts,
    m.source
from stg_mobilite m
left join stg_etudiant etu on m.id_etudiant = etu.id_etudiant
left join stg_etablissement e_orig on m.oid_etablissement_origine = e_orig.oid_etablissement
left join stg_etablissement e_acc on m.oid_etablissement_accueil = e_acc.oid_etablissement
  );
[0m23:16:52.919376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m23:16:52.927523 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.927523 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */
alter table "sid_lite"."public"."vw_fait_mobilite__dbt_tmp" rename to "vw_fait_mobilite"
[0m23:16:52.927523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:52.927523 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: COMMIT
[0m23:16:52.927523 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.927523 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: COMMIT
[0m23:16:52.935886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:16:52.937913 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."vw_fait_mobilite__dbt_backup"
[0m23:16:52.937913 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.vw_fait_mobilite"
[0m23:16:52.937913 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.vw_fait_mobilite"} */
drop view if exists "sid_lite"."public"."vw_fait_mobilite__dbt_backup" cascade
[0m23:16:52.940853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:16:52.942284 [debug] [Thread-1 (]: On model.sid_lite.vw_fait_mobilite: Close
[0m23:16:52.942284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C1DA310>]}
[0m23:16:52.944291 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.vw_fait_mobilite ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:16:52.946297 [debug] [Thread-1 (]: Finished running node model.sid_lite.vw_fait_mobilite
[0m23:16:52.946297 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etablissement
[0m23:16:52.947775 [info ] [Thread-1 (]: 5 of 8 START sql table model public.hub_etablissement .......................... [RUN]
[0m23:16:52.947775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.vw_fait_mobilite, now model.sid_lite.hub_etablissement)
[0m23:16:52.949810 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etablissement
[0m23:16:52.977943 [info ] [Thread-1 (]: 23:16:52 + Loading sid_lite.public.hub_etablissement from 1 source(s)
[0m23:16:53.025365 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etablissement"
[0m23:16:53.027596 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etablissement
[0m23:16:53.045448 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etablissement"
[0m23:16:53.045448 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:53.048761 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: BEGIN
[0m23:16:53.048761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:53.092825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m23:16:53.092825 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:53.092825 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */

  
    

  create  table "sid_lite"."public"."hub_etablissement__dbt_tmp"
  
  
    as
  
  (
    
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.oid_etablissement) rr.oid_etablissement, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etablissement" AS rr
    WHERE rr.oid_etablissement IS NOT NULL
    ORDER BY rr.oid_etablissement, rr.load_dts
),

records_to_insert AS (
    SELECT a.oid_etablissement, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:16:53.092825 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m23:16:53.107968 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:53.107968 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement" rename to "hub_etablissement__dbt_backup"
[0m23:16:53.107968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:53.113990 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:53.113990 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
alter table "sid_lite"."public"."hub_etablissement__dbt_tmp" rename to "hub_etablissement"
[0m23:16:53.113990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:53.113990 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:16:53.113990 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:53.118354 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: COMMIT
[0m23:16:53.157384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:16:53.157384 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etablissement__dbt_backup"
[0m23:16:53.157384 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etablissement"
[0m23:16:53.157384 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etablissement"} */
drop table if exists "sid_lite"."public"."hub_etablissement__dbt_backup" cascade
[0m23:16:53.171702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:16:53.173451 [debug] [Thread-1 (]: On model.sid_lite.hub_etablissement: Close
[0m23:16:53.173451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C590C90>]}
[0m23:16:53.175458 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.hub_etablissement ..................... [[32mSELECT 500[0m in 0.23s]
[0m23:16:53.175458 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etablissement
[0m23:16:53.175458 [debug] [Thread-1 (]: Began running node model.sid_lite.hub_etudiant
[0m23:16:53.178515 [info ] [Thread-1 (]: 6 of 8 START sql table model public.hub_etudiant ............................... [RUN]
[0m23:16:53.178515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etablissement, now model.sid_lite.hub_etudiant)
[0m23:16:53.178515 [debug] [Thread-1 (]: Began compiling node model.sid_lite.hub_etudiant
[0m23:16:53.183579 [info ] [Thread-1 (]: 23:16:53 + Loading sid_lite.public.hub_etudiant from 1 source(s)
[0m23:16:53.186831 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.hub_etudiant"
[0m23:16:53.187667 [debug] [Thread-1 (]: Began executing node model.sid_lite.hub_etudiant
[0m23:16:53.189128 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.hub_etudiant"
[0m23:16:53.189128 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:53.193034 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: BEGIN
[0m23:16:53.193878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:53.232501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:16:53.232501 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:53.232501 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */

  
    

  create  table "sid_lite"."public"."hub_etudiant__dbt_tmp"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.id_etudiant) rr.id_etudiant, rr.load_dts, rr.source
    FROM "sid_lite"."public"."stg_etudiant" AS rr
    WHERE rr.id_etudiant IS NOT NULL
    ORDER BY rr.id_etudiant, rr.load_dts
),

records_to_insert AS (
    SELECT a.id_etudiant, a.load_dts, a.source
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m23:16:53.239636 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.005 seconds
[0m23:16:53.245044 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:53.245044 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant" rename to "hub_etudiant__dbt_backup"
[0m23:16:53.246889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:16:53.248894 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:53.248894 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
alter table "sid_lite"."public"."hub_etudiant__dbt_tmp" rename to "hub_etudiant"
[0m23:16:53.251354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:16:53.251354 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:16:53.251354 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:53.253155 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: COMMIT
[0m23:16:53.296873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m23:16:53.301836 [debug] [Thread-1 (]: Applying DROP to: "sid_lite"."public"."hub_etudiant__dbt_backup"
[0m23:16:53.301836 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.hub_etudiant"
[0m23:16:53.303032 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.hub_etudiant"} */
drop table if exists "sid_lite"."public"."hub_etudiant__dbt_backup" cascade
[0m23:16:53.308914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:16:53.312839 [debug] [Thread-1 (]: On model.sid_lite.hub_etudiant: Close
[0m23:16:53.312839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C274490>]}
[0m23:16:53.314844 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.hub_etudiant .......................... [[32mSELECT 500[0m in 0.13s]
[0m23:16:53.314844 [debug] [Thread-1 (]: Finished running node model.sid_lite.hub_etudiant
[0m23:16:53.316814 [debug] [Thread-1 (]: Began running node model.sid_lite.link_mobilite
[0m23:16:53.317822 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.link_mobilite ........................ [RUN]
[0m23:16:53.317822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.hub_etudiant, now model.sid_lite.link_mobilite)
[0m23:16:53.317822 [debug] [Thread-1 (]: Began compiling node model.sid_lite.link_mobilite
[0m23:16:53.317822 [info ] [Thread-1 (]: 23:16:53 + Loading sid_lite.public.link_mobilite from 1 source(s)
[0m23:16:53.339598 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.link_mobilite"
[0m23:16:53.344937 [debug] [Thread-1 (]: Began executing node model.sid_lite.link_mobilite
[0m23:16:53.364495 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.370017 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

    
  
    

  create temporary table "link_mobilite__dbt_tmp231653364495"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.id_mobilite, rr.id_etudiant, rr.oid_etablissement_origine, rr.oid_etablissement_accueil, rr.load_dts, rr.source,
           ROW_NUMBER() OVER(
               PARTITION BY rr.id_mobilite
               ORDER BY rr.load_dts
           ) AS row_number
    FROM "sid_lite"."public"."stg_mobilite" AS rr
    WHERE rr.id_mobilite IS NOT NULL
    AND rr.id_etudiant IS NOT NULL
    AND rr.oid_etablissement_origine IS NOT NULL
    AND rr.oid_etablissement_accueil IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.id_mobilite, a.id_etudiant, a.oid_etablissement_origine, a.oid_etablissement_accueil, a.load_dts, a.source
    FROM row_rank_1 AS a
    LEFT JOIN "sid_lite"."public"."link_mobilite" AS d
    ON a.id_mobilite = d.id_mobilite
    WHERE d.id_mobilite IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:16:53.370017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:53.423701 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.053 seconds
[0m23:16:53.433470 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.433470 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: BEGIN
[0m23:16:53.433470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:16:53.433470 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.433470 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite__dbt_tmp231653364495'
        
      order by ordinal_position

  
[0m23:16:53.452012 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.012 seconds
[0m23:16:53.537210 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.539216 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:53.541614 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:16:53.547135 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.549139 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'link_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:53.549139 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.002 seconds
[0m23:16:53.559168 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.link_mobilite"
[0m23:16:53.559168 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.559168 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.link_mobilite"} */

      insert into "sid_lite"."public"."link_mobilite" ("id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source")
    (
        select "id_mobilite", "id_etudiant", "oid_etablissement_origine", "oid_etablissement_accueil", "load_dts", "source"
        from "link_mobilite__dbt_tmp231653364495"
    )


  
[0m23:16:53.561943 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:16:53.563153 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:16:53.563153 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.link_mobilite"
[0m23:16:53.563153 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: COMMIT
[0m23:16:53.590559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m23:16:53.606861 [debug] [Thread-1 (]: On model.sid_lite.link_mobilite: Close
[0m23:16:53.608284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C79A150>]}
[0m23:16:53.608284 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.link_mobilite ................... [[32mINSERT 0 0[0m in 0.29s]
[0m23:16:53.608284 [debug] [Thread-1 (]: Finished running node model.sid_lite.link_mobilite
[0m23:16:53.608284 [debug] [Thread-1 (]: Began running node model.sid_lite.sat_mobilite
[0m23:16:53.608284 [info ] [Thread-1 (]: 8 of 8 START sql incremental model public.sat_mobilite ......................... [RUN]
[0m23:16:53.622218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sid_lite.link_mobilite, now model.sid_lite.sat_mobilite)
[0m23:16:53.622218 [debug] [Thread-1 (]: Began compiling node model.sid_lite.sat_mobilite
[0m23:16:53.679035 [debug] [Thread-1 (]: Writing injected SQL for node "model.sid_lite.sat_mobilite"
[0m23:16:53.679035 [debug] [Thread-1 (]: Began executing node model.sid_lite.sat_mobilite
[0m23:16:53.684695 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.684695 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

    
  
    

  create temporary table "sat_mobilite__dbt_tmp231653684695"
  
  
    as
  
  (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.id_mobilite, a.hashdiff_mobilite, a.date_debut, a.date_fin, a.type_mobilite, a.statut_mobilite, a.load_dts, a.source
    FROM "sid_lite"."public"."stg_mobilite" AS a
    WHERE a.id_mobilite IS NOT NULL
),

latest_records AS (
    SELECT b.id_mobilite, b.hashdiff_mobilite, b.load_dts
    FROM (
        SELECT current_records.id_mobilite, current_records.hashdiff_mobilite, current_records.load_dts,
            ROW_NUMBER() OVER (
               PARTITION BY current_records.id_mobilite
               ORDER BY current_records.load_dts DESC
            ) AS rank
        FROM "sid_lite"."public"."sat_mobilite" AS current_records
            JOIN (
                SELECT DISTINCT source_data.id_mobilite
                FROM source_data
            ) AS source_records
                ON source_records.id_mobilite = current_records.id_mobilite
    ) AS b
    WHERE b.rank = 1
),

unique_source_records AS (
    SELECT
        b.id_mobilite, b.hashdiff_mobilite, b.date_debut, b.date_fin, b.type_mobilite, b.statut_mobilite, b.load_dts, b.source
    FROM (
        SELECT
            sd.id_mobilite, sd.hashdiff_mobilite, sd.date_debut, sd.date_fin, sd.type_mobilite, sd.statut_mobilite, sd.load_dts, sd.source,
            LAG(
                sd.hashdiff_mobilite,
                1,
                COALESCE(lr.hashdiff_mobilite,
                         'FFFFFFFF')
            ) OVER (
                PARTITION BY sd.id_mobilite
                ORDER BY sd.load_dts ASC
            ) AS prev_hashdiff
        FROM source_data AS sd
        LEFT OUTER JOIN latest_records AS lr
            ON sd.id_mobilite = lr.id_mobilite
        ) AS b
    WHERE b.hashdiff_mobilite != b.prev_hashdiff
),

records_to_insert AS (
    SELECT usr.id_mobilite, usr.hashdiff_mobilite, usr.date_debut, usr.date_fin, usr.type_mobilite, usr.statut_mobilite, usr.load_dts, usr.source
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:16:53.684695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:53.748166 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.061 seconds
[0m23:16:53.750538 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.750538 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: BEGIN
[0m23:16:53.754972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:16:53.756418 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.756418 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite__dbt_tmp231653684695'
        
      order by ordinal_position

  
[0m23:16:53.771721 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.015 seconds
[0m23:16:53.774815 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.774815 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:53.778223 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:16:53.784431 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.784431 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "sid_lite".INFORMATION_SCHEMA.columns
      where table_name = 'sat_mobilite'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:16:53.788748 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:16:53.789765 [debug] [Thread-1 (]: Writing runtime sql for node "model.sid_lite.sat_mobilite"
[0m23:16:53.789765 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.793177 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "model.sid_lite.sat_mobilite"} */

      insert into "sid_lite"."public"."sat_mobilite" ("id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source")
    (
        select "id_mobilite", "hashdiff_mobilite", "date_debut", "date_fin", "type_mobilite", "statut_mobilite", "load_dts", "source"
        from "sat_mobilite__dbt_tmp231653684695"
    )


  
[0m23:16:53.793177 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m23:16:53.794680 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:16:53.794680 [debug] [Thread-1 (]: Using postgres connection "model.sid_lite.sat_mobilite"
[0m23:16:53.794680 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: COMMIT
[0m23:16:53.838358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m23:16:53.839878 [debug] [Thread-1 (]: On model.sid_lite.sat_mobilite: Close
[0m23:16:53.839878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9df4a6-b1aa-4d22-82cf-5817b9d7b2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6C600350>]}
[0m23:16:53.839878 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model public.sat_mobilite .................... [[32mINSERT 0 0[0m in 0.22s]
[0m23:16:53.839878 [debug] [Thread-1 (]: Finished running node model.sid_lite.sat_mobilite
[0m23:16:53.839878 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:53.839878 [debug] [MainThread]: On master: BEGIN
[0m23:16:53.854416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:16:53.934713 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m23:16:53.934713 [debug] [MainThread]: On master: COMMIT
[0m23:16:53.934713 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:53.934713 [debug] [MainThread]: On master: COMMIT
[0m23:16:53.934713 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:16:53.934713 [debug] [MainThread]: On master: Close
[0m23:16:53.950567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:53.950567 [debug] [MainThread]: Connection 'list_sid_lite' was properly closed.
[0m23:16:53.950567 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:16:53.950567 [debug] [MainThread]: Connection 'model.sid_lite.sat_mobilite' was properly closed.
[0m23:16:53.950567 [info ] [MainThread]: 
[0m23:16:53.950567 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 4 view models in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m23:16:53.950567 [debug] [MainThread]: Command end result
[0m23:16:54.045822 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:16:54.076881 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:16:54.085393 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:16:54.085393 [info ] [MainThread]: 
[0m23:16:54.085393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:54.085393 [info ] [MainThread]: 
[0m23:16:54.085393 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:16:54.085393 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:54.085393 after 3.35 seconds
[0m23:16:54.085393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE63A2FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE63A2F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE695F2050>]}
[0m23:16:54.101076 [debug] [MainThread]: Flushing usage events
[0m23:16:54.663155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:03.648463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA7F7E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA7FBCA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA7FBF4D0>]}


============================== 23:17:03.648463 | 8a0604cb-4996-4bdb-87e6-59798229c9d9 ==============================
[0m23:17:03.648463 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:17:03.648463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:17:03.845029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a0604cb-4996-4bdb-87e6-59798229c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA673BA10>]}
[0m23:17:03.904560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a0604cb-4996-4bdb-87e6-59798229c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA385F350>]}
[0m23:17:03.904560 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:17:04.094032 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:17:04.318905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:04.318905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:04.349965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a0604cb-4996-4bdb-87e6-59798229c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA87B9F10>]}
[0m23:17:04.495383 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:17:04.507913 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:17:04.539453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a0604cb-4996-4bdb-87e6-59798229c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA81A5B90>]}
[0m23:17:04.544022 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:17:04.545710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a0604cb-4996-4bdb-87e6-59798229c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA8961250>]}
[0m23:17:04.545710 [info ] [MainThread]: 
[0m23:17:04.545710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:04.545710 [info ] [MainThread]: 
[0m23:17:04.545710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:17:04.545710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:17:04.741555 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:17:04.741555 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:17:04.741555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:04.789523 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m23:17:04.789523 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:17:04.789523 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:17:04.793565 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m23:17:04.793565 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:17:04.793565 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:17:04.805309 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:04.805309 [debug] [MainThread]: On master: BEGIN
[0m23:17:04.805309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:04.844095 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:17:04.844095 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:04.844095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:17:04.850202 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m23:17:04.852590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a0604cb-4996-4bdb-87e6-59798229c9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA8451550>]}
[0m23:17:04.852590 [debug] [MainThread]: On master: ROLLBACK
[0m23:17:04.852590 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:04.852590 [debug] [MainThread]: On master: BEGIN
[0m23:17:04.855543 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:17:04.856738 [debug] [MainThread]: On master: COMMIT
[0m23:17:04.856738 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:04.856738 [debug] [MainThread]: On master: COMMIT
[0m23:17:04.856738 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:04.856738 [debug] [MainThread]: On master: Close
[0m23:17:04.862969 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:04.862969 [info ] [Thread-1 (]: 1 of 16 START test not_null_hub_etablissement_oid_etablissement ................ [RUN]
[0m23:17:04.866483 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee'
[0m23:17:04.866483 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:04.884262 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:04.884262 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:04.905057 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:04.907063 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:04.907063 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: BEGIN
[0m23:17:04.907063 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:17:04.954248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:17:04.954248 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:04.954248 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m23:17:04.960909 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:17:04.962914 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: ROLLBACK
[0m23:17:04.962914 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: Close
[0m23:17:04.967472 [info ] [Thread-1 (]: 1 of 16 PASS not_null_hub_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.10s]
[0m23:17:04.968858 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:04.969923 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:04.971000 [info ] [Thread-1 (]: 2 of 16 START test not_null_hub_etudiant_id_etudiant ........................... [RUN]
[0m23:17:04.972203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee, now test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22)
[0m23:17:04.972203 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:04.976215 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:04.976215 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:04.980823 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:04.981610 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:04.982600 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: BEGIN
[0m23:17:04.983046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.021615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:17:05.021615 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:05.023911 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."hub_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.025415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:17:05.027368 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: ROLLBACK
[0m23:17:05.028398 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: Close
[0m23:17:05.029628 [info ] [Thread-1 (]: 2 of 16 PASS not_null_hub_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.06s]
[0m23:17:05.030649 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:05.031667 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:05.031667 [info ] [Thread-1 (]: 3 of 16 START test not_null_link_mobilite_id_mobilite .......................... [RUN]
[0m23:17:05.032678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22, now test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab)
[0m23:17:05.033683 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:05.036805 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:05.038341 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:05.039858 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:05.041388 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:05.041388 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: BEGIN
[0m23:17:05.041388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.079539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:17:05.079539 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:05.079539 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."link_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.082057 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.084261 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: ROLLBACK
[0m23:17:05.084261 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: Close
[0m23:17:05.087223 [info ] [Thread-1 (]: 3 of 16 PASS not_null_link_mobilite_id_mobilite ................................ [[32mPASS[0m in 0.05s]
[0m23:17:05.087223 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:05.090179 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:05.090179 [info ] [Thread-1 (]: 4 of 16 START test not_null_sat_mobilite_id_mobilite ........................... [RUN]
[0m23:17:05.090179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab, now test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343)
[0m23:17:05.091779 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:05.095113 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:05.097169 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:05.100180 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:05.100180 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:05.100180 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: BEGIN
[0m23:17:05.102186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.141624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:05.141624 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:05.141624 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."sat_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.145038 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.145038 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: ROLLBACK
[0m23:17:05.147519 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: Close
[0m23:17:05.147519 [info ] [Thread-1 (]: 4 of 16 PASS not_null_sat_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.06s]
[0m23:17:05.150385 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:05.150385 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:05.150385 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m23:17:05.151791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m23:17:05.151791 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:05.154375 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:05.154375 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:05.159884 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:05.160814 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:05.160814 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m23:17:05.162094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.203115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:05.203115 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:05.203115 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.205913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:17:05.205913 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m23:17:05.205913 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m23:17:05.205913 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.05s]
[0m23:17:05.209689 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:05.210771 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:05.210771 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m23:17:05.212030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m23:17:05.212030 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:05.215368 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:05.217373 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:05.219379 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:05.221384 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:05.222101 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m23:17:05.222559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.260722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:17:05.261743 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:05.261743 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.263598 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.263598 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m23:17:05.263598 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m23:17:05.263598 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.05s]
[0m23:17:05.263598 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:05.269911 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:05.271216 [info ] [Thread-1 (]: 7 of 16 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m23:17:05.271216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m23:17:05.271216 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:05.276469 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:05.276469 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:05.281827 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:05.283832 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:05.283832 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m23:17:05.283832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.345347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m23:17:05.347352 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:05.347352 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.350700 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.350700 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m23:17:05.350700 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m23:17:05.353635 [info ] [Thread-1 (]: 7 of 16 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.08s]
[0m23:17:05.353635 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:05.355382 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:05.355382 [info ] [Thread-1 (]: 8 of 16 START test not_null_vw_fait_mobilite_id_mobilite ....................... [RUN]
[0m23:17:05.355382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c)
[0m23:17:05.355382 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:05.362159 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:05.363667 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:05.365673 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:05.388748 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:05.388748 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: BEGIN
[0m23:17:05.388748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.431894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:17:05.431894 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:05.431894 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."vw_fait_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:05.437014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:17:05.437014 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: ROLLBACK
[0m23:17:05.437014 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: Close
[0m23:17:05.437014 [info ] [Thread-1 (]: 8 of 16 PASS not_null_vw_fait_mobilite_id_mobilite ............................. [[32mPASS[0m in 0.08s]
[0m23:17:05.442987 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:05.442987 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:05.444482 [info ] [Thread-1 (]: 9 of 16 START test unique_hub_etablissement_oid_etablissement .................. [RUN]
[0m23:17:05.444482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c, now test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5)
[0m23:17:05.444482 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:05.451341 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:05.451341 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:05.455375 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:05.455375 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:05.455375 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: BEGIN
[0m23:17:05.455375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.497123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:05.497123 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:05.497123 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.497123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.497123 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: ROLLBACK
[0m23:17:05.497123 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: Close
[0m23:17:05.497123 [info ] [Thread-1 (]: 9 of 16 PASS unique_hub_etablissement_oid_etablissement ........................ [[32mPASS[0m in 0.05s]
[0m23:17:05.505638 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:05.505638 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:05.505638 [info ] [Thread-1 (]: 10 of 16 START test unique_hub_etudiant_id_etudiant ............................ [RUN]
[0m23:17:05.507643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5, now test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466)
[0m23:17:05.507643 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:05.512511 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:05.512511 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:05.515915 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:05.515915 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:05.515915 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: BEGIN
[0m23:17:05.517670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.549001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:17:05.549001 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:05.549001 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.560732 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.562258 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: ROLLBACK
[0m23:17:05.564133 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: Close
[0m23:17:05.565692 [info ] [Thread-1 (]: 10 of 16 PASS unique_hub_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.06s]
[0m23:17:05.566914 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:05.566914 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:05.566914 [info ] [Thread-1 (]: 11 of 16 START test unique_link_mobilite_id_mobilite ........................... [RUN]
[0m23:17:05.568628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466, now test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530)
[0m23:17:05.568628 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:05.571456 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:05.571456 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:05.579284 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:05.580786 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:05.580786 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: BEGIN
[0m23:17:05.580786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.614157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:17:05.614157 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:05.614157 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.614157 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.614157 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: ROLLBACK
[0m23:17:05.625449 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: Close
[0m23:17:05.626459 [info ] [Thread-1 (]: 11 of 16 PASS unique_link_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.06s]
[0m23:17:05.627470 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:05.627470 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:05.627470 [info ] [Thread-1 (]: 12 of 16 START test unique_sat_mobilite_id_mobilite ............................ [RUN]
[0m23:17:05.627470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530, now test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1)
[0m23:17:05.629953 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:05.634553 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:05.634553 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:05.638565 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:05.639205 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:05.640266 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: BEGIN
[0m23:17:05.640266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.690467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m23:17:05.690467 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:05.690467 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."sat_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.694089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.695342 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: ROLLBACK
[0m23:17:05.695342 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: Close
[0m23:17:05.695342 [info ] [Thread-1 (]: 12 of 16 PASS unique_sat_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.07s]
[0m23:17:05.698866 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:05.698866 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:05.698866 [info ] [Thread-1 (]: 13 of 16 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m23:17:05.698866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m23:17:05.698866 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:05.706907 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:05.706907 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:05.710894 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:05.710894 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:05.710894 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m23:17:05.710894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.755029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m23:17:05.761072 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:05.762139 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.763168 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.765460 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m23:17:05.765460 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m23:17:05.765460 [info ] [Thread-1 (]: 13 of 16 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.07s]
[0m23:17:05.768727 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:05.768727 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:05.770734 [info ] [Thread-1 (]: 14 of 16 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m23:17:05.770734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m23:17:05.770734 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:05.777030 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:05.778811 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:05.780997 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:05.780997 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:05.780997 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m23:17:05.780997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.820059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:17:05.820059 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:05.820059 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.825797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.827412 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m23:17:05.828489 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m23:17:05.828489 [info ] [Thread-1 (]: 14 of 16 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.06s]
[0m23:17:05.829902 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:05.831133 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:05.831133 [info ] [Thread-1 (]: 15 of 16 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m23:17:05.833138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m23:17:05.833138 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:05.836939 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:05.836939 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:05.839584 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:05.839584 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:05.842437 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m23:17:05.842948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.882217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:05.882217 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:05.882217 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.884976 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:05.884976 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m23:17:05.884976 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m23:17:05.889923 [info ] [Thread-1 (]: 15 of 16 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.06s]
[0m23:17:05.891127 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:05.891127 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:05.892167 [info ] [Thread-1 (]: 16 of 16 START test unique_vw_fait_mobilite_id_mobilite ........................ [RUN]
[0m23:17:05.892167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f, now test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce)
[0m23:17:05.893386 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:05.899227 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:05.899227 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:05.901232 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:05.903238 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:05.903238 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: BEGIN
[0m23:17:05.903238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.944073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:05.945067 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:05.945067 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."vw_fait_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:05.947907 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:17:05.947907 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: ROLLBACK
[0m23:17:05.947907 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: Close
[0m23:17:05.953412 [info ] [Thread-1 (]: 16 of 16 PASS unique_vw_fait_mobilite_id_mobilite .............................. [[32mPASS[0m in 0.06s]
[0m23:17:05.953412 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:05.955418 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:05.955418 [debug] [MainThread]: On master: BEGIN
[0m23:17:05.955418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:17:05.994097 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m23:17:05.995115 [debug] [MainThread]: On master: COMMIT
[0m23:17:05.995115 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:05.995115 [debug] [MainThread]: On master: COMMIT
[0m23:17:05.995115 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:05.995115 [debug] [MainThread]: On master: Close
[0m23:17:05.995115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:05.998355 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:17:05.998355 [debug] [MainThread]: Connection 'test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce' was properly closed.
[0m23:17:05.998355 [info ] [MainThread]: 
[0m23:17:05.999840 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m23:17:06.001897 [debug] [MainThread]: Command end result
[0m23:17:06.034921 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:17:06.046428 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:17:06.047753 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:17:06.047753 [info ] [MainThread]: 
[0m23:17:06.047753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:06.047753 [info ] [MainThread]: 
[0m23:17:06.047753 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m23:17:06.047753 [debug] [MainThread]: Command `dbt test` succeeded at 23:17:06.047753 after 2.51 seconds
[0m23:17:06.047753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA024FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA024F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CA6D5F4D0>]}
[0m23:17:06.047753 [debug] [MainThread]: Flushing usage events
[0m23:17:06.469617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:50.597650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FE0DEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FC8FA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FF127450>]}


============================== 23:17:50.602165 | db98e02b-e783-4b9d-96ea-10730c63b4f4 ==============================
[0m23:17:50.602165 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:17:50.602165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\GitHub\\erasmus-sid-lite\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:50.775600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db98e02b-e783-4b9d-96ea-10730c63b4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FF131B50>]}
[0m23:17:50.847803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db98e02b-e783-4b9d-96ea-10730c63b4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FA99EF50>]}
[0m23:17:50.847803 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:17:51.057615 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:17:51.314601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:17:51.314601 [debug] [MainThread]: Partial parsing: updated file: sid_lite://dbt/sid-lite/models\marts\schema.yml
[0m23:17:51.775947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db98e02b-e783-4b9d-96ea-10730c63b4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FFA5C190>]}
[0m23:17:51.843388 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:17:51.853943 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:17:51.883353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db98e02b-e783-4b9d-96ea-10730c63b4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FFD52550>]}
[0m23:17:51.884712 [info ] [MainThread]: Found 8 models, 3 seeds, 16 data tests, 822 macros
[0m23:17:51.886150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db98e02b-e783-4b9d-96ea-10730c63b4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FFD3FAD0>]}
[0m23:17:51.888612 [info ] [MainThread]: 
[0m23:17:51.888612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:51.888612 [info ] [MainThread]: 
[0m23:17:51.891582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:17:51.899583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sid_lite_public'
[0m23:17:52.060834 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:17:52.060834 [debug] [ThreadPool]: On list_sid_lite_public: BEGIN
[0m23:17:52.060834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:52.109233 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m23:17:52.109233 [debug] [ThreadPool]: Using postgres connection "list_sid_lite_public"
[0m23:17:52.109233 [debug] [ThreadPool]: On list_sid_lite_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "list_sid_lite_public"} */
select
      'sid_lite' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sid_lite' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:17:52.116300 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m23:17:52.116300 [debug] [ThreadPool]: On list_sid_lite_public: ROLLBACK
[0m23:17:52.116300 [debug] [ThreadPool]: On list_sid_lite_public: Close
[0m23:17:52.125625 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:52.125625 [debug] [MainThread]: On master: BEGIN
[0m23:17:52.125625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:52.161435 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m23:17:52.161435 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:52.161435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:17:52.170537 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m23:17:52.173676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db98e02b-e783-4b9d-96ea-10730c63b4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261FF6BA110>]}
[0m23:17:52.173676 [debug] [MainThread]: On master: ROLLBACK
[0m23:17:52.173676 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:52.173676 [debug] [MainThread]: On master: BEGIN
[0m23:17:52.173676 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:17:52.173676 [debug] [MainThread]: On master: COMMIT
[0m23:17:52.173676 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:52.173676 [debug] [MainThread]: On master: COMMIT
[0m23:17:52.178960 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:52.178960 [debug] [MainThread]: On master: Close
[0m23:17:52.184098 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:52.184098 [info ] [Thread-1 (]: 1 of 16 START test not_null_hub_etablissement_oid_etablissement ................ [RUN]
[0m23:17:52.185622 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee'
[0m23:17:52.185622 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:52.197440 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:52.197440 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:52.216921 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:52.218928 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:52.222481 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: BEGIN
[0m23:17:52.222481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:17:52.270539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:17:52.271760 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"
[0m23:17:52.271760 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.273571 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:17:52.275332 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: ROLLBACK
[0m23:17:52.275332 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee: Close
[0m23:17:52.279345 [info ] [Thread-1 (]: 1 of 16 PASS not_null_hub_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.09s]
[0m23:17:52.281350 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee
[0m23:17:52.283076 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:52.283076 [info ] [Thread-1 (]: 2 of 16 START test not_null_hub_etudiant_id_etudiant ........................... [RUN]
[0m23:17:52.284596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etablissement_oid_etablissement.fe3097b7ee, now test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22)
[0m23:17:52.284596 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:52.289166 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:52.290689 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:52.292233 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:52.293755 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:52.293755 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: BEGIN
[0m23:17:52.295275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.341706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:17:52.341706 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"
[0m23:17:52.343453 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."hub_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.345660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.345660 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: ROLLBACK
[0m23:17:52.347765 [debug] [Thread-1 (]: On test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22: Close
[0m23:17:52.349179 [info ] [Thread-1 (]: 2 of 16 PASS not_null_hub_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.06s]
[0m23:17:52.351553 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22
[0m23:17:52.351553 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:52.353274 [info ] [Thread-1 (]: 3 of 16 START test not_null_link_mobilite_id_mobilite .......................... [RUN]
[0m23:17:52.353779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_hub_etudiant_id_etudiant.e5647bef22, now test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab)
[0m23:17:52.353779 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:52.356835 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:52.359842 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:52.363410 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:52.363410 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:52.363410 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: BEGIN
[0m23:17:52.365079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.403668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:52.405815 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"
[0m23:17:52.405815 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."link_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.405815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:17:52.410366 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: ROLLBACK
[0m23:17:52.411302 [debug] [Thread-1 (]: On test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab: Close
[0m23:17:52.412201 [info ] [Thread-1 (]: 3 of 16 PASS not_null_link_mobilite_id_mobilite ................................ [[32mPASS[0m in 0.06s]
[0m23:17:52.414094 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab
[0m23:17:52.414094 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:52.416124 [info ] [Thread-1 (]: 4 of 16 START test not_null_sat_mobilite_id_mobilite ........................... [RUN]
[0m23:17:52.416124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_link_mobilite_id_mobilite.8579def1ab, now test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343)
[0m23:17:52.416124 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:52.418896 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:52.418896 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:52.418896 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:52.418896 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:52.418896 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: BEGIN
[0m23:17:52.418896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.464143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m23:17:52.465336 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"
[0m23:17:52.465336 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."sat_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.465336 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:17:52.468661 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: ROLLBACK
[0m23:17:52.468661 [debug] [Thread-1 (]: On test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343: Close
[0m23:17:52.468661 [info ] [Thread-1 (]: 4 of 16 PASS not_null_sat_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.05s]
[0m23:17:52.468661 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343
[0m23:17:52.468661 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:52.468661 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_etablissement_oid_etablissement ................ [RUN]
[0m23:17:52.468661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_sat_mobilite_id_mobilite.395c773343, now test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69)
[0m23:17:52.468661 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:52.479890 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:52.481039 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:52.483354 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:52.483354 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:52.483354 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: BEGIN
[0m23:17:52.485365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.527182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m23:17:52.527927 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"
[0m23:17:52.527927 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select oid_etablissement
from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.530823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.530823 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: ROLLBACK
[0m23:17:52.530823 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69: Close
[0m23:17:52.534219 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_etablissement_oid_etablissement ...................... [[32mPASS[0m in 0.07s]
[0m23:17:52.534219 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69
[0m23:17:52.535651 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:52.535651 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_etudiant_id_etudiant ........................... [RUN]
[0m23:17:52.535651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etablissement_oid_etablissement.293e95fa69, now test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69)
[0m23:17:52.535651 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:52.540038 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:52.540038 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:52.544617 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:52.546847 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:52.546847 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: BEGIN
[0m23:17:52.550298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.627636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m23:17:52.627636 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"
[0m23:17:52.629800 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_etudiant
from "sid_lite"."public"."stg_etudiant"
where id_etudiant is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.631835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.633817 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: ROLLBACK
[0m23:17:52.633817 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69: Close
[0m23:17:52.635822 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_etudiant_id_etudiant ................................. [[32mPASS[0m in 0.10s]
[0m23:17:52.637906 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69
[0m23:17:52.637906 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:52.639912 [info ] [Thread-1 (]: 7 of 16 START test not_null_stg_mobilite_id_mobilite ........................... [RUN]
[0m23:17:52.639912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_etudiant_id_etudiant.c316f49a69, now test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884)
[0m23:17:52.641919 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:52.645931 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:52.645931 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:52.647937 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:52.649942 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:52.649942 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: BEGIN
[0m23:17:52.651688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.703123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m23:17:52.703123 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"
[0m23:17:52.703123 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."stg_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.703123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.706688 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: ROLLBACK
[0m23:17:52.708435 [debug] [Thread-1 (]: On test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884: Close
[0m23:17:52.708435 [info ] [Thread-1 (]: 7 of 16 PASS not_null_stg_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.07s]
[0m23:17:52.710441 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884
[0m23:17:52.712449 [debug] [Thread-1 (]: Began running node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:52.712449 [info ] [Thread-1 (]: 8 of 16 START test not_null_vw_fait_mobilite_id_mobilite ....................... [RUN]
[0m23:17:52.712449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_stg_mobilite_id_mobilite.252b014884, now test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c)
[0m23:17:52.712449 [debug] [Thread-1 (]: Began compiling node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:52.716794 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:52.716794 [debug] [Thread-1 (]: Began executing node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:52.720997 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:52.720997 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:52.720997 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: BEGIN
[0m23:17:52.723741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.764281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m23:17:52.764281 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"
[0m23:17:52.764281 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_mobilite
from "sid_lite"."public"."vw_fait_mobilite"
where id_mobilite is null



  
  
      
    ) dbt_internal_test
[0m23:17:52.768240 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:17:52.768240 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: ROLLBACK
[0m23:17:52.768240 [debug] [Thread-1 (]: On test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c: Close
[0m23:17:52.768240 [info ] [Thread-1 (]: 8 of 16 PASS not_null_vw_fait_mobilite_id_mobilite ............................. [[32mPASS[0m in 0.06s]
[0m23:17:52.768240 [debug] [Thread-1 (]: Finished running node test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c
[0m23:17:52.768240 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:52.768240 [info ] [Thread-1 (]: 9 of 16 START test unique_hub_etablissement_oid_etablissement .................. [RUN]
[0m23:17:52.777029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.not_null_vw_fait_mobilite_id_mobilite.cbb3e92e4c, now test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5)
[0m23:17:52.777029 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:52.781957 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:52.783963 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:52.785467 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:52.787472 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:52.788087 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: BEGIN
[0m23:17:52.788087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.831148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:17:52.832308 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"
[0m23:17:52.832308 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:52.832308 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.832308 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: ROLLBACK
[0m23:17:52.837087 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5: Close
[0m23:17:52.837087 [info ] [Thread-1 (]: 9 of 16 PASS unique_hub_etablissement_oid_etablissement ........................ [[32mPASS[0m in 0.07s]
[0m23:17:52.838818 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5
[0m23:17:52.838818 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:52.838818 [info ] [Thread-1 (]: 10 of 16 START test unique_hub_etudiant_id_etudiant ............................ [RUN]
[0m23:17:52.840824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etablissement_oid_etablissement.5ad2eb40d5, now test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466)
[0m23:17:52.840824 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:52.844655 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:52.846817 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:52.846817 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:52.851544 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:52.852550 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: BEGIN
[0m23:17:52.852550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.891806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:52.893814 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"
[0m23:17:52.894640 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."hub_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:52.895767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.895767 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: ROLLBACK
[0m23:17:52.895767 [debug] [Thread-1 (]: On test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466: Close
[0m23:17:52.901183 [info ] [Thread-1 (]: 10 of 16 PASS unique_hub_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.05s]
[0m23:17:52.902265 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466
[0m23:17:52.902265 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:52.903296 [info ] [Thread-1 (]: 11 of 16 START test unique_link_mobilite_id_mobilite ........................... [RUN]
[0m23:17:52.904356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_hub_etudiant_id_etudiant.4c17fba466, now test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530)
[0m23:17:52.904356 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:52.906214 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:52.906214 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:52.913333 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:52.913333 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:52.913333 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: BEGIN
[0m23:17:52.913333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:52.949800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m23:17:52.949800 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"
[0m23:17:52.949800 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."link_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:52.957412 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:52.960247 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: ROLLBACK
[0m23:17:52.961293 [debug] [Thread-1 (]: On test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530: Close
[0m23:17:52.962415 [info ] [Thread-1 (]: 11 of 16 PASS unique_link_mobilite_id_mobilite ................................. [[32mPASS[0m in 0.06s]
[0m23:17:52.964422 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530
[0m23:17:52.964422 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:52.964422 [info ] [Thread-1 (]: 12 of 16 START test unique_sat_mobilite_id_mobilite ............................ [RUN]
[0m23:17:52.966427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_link_mobilite_id_mobilite.9f1004f530, now test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1)
[0m23:17:52.966427 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:52.968448 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:52.968448 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:52.972348 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:52.972348 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:52.975181 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: BEGIN
[0m23:17:52.975181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:53.116867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m23:17:53.116867 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"
[0m23:17:53.116867 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."sat_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:53.116867 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:17:53.116867 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: ROLLBACK
[0m23:17:53.116867 [debug] [Thread-1 (]: On test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1: Close
[0m23:17:53.116867 [info ] [Thread-1 (]: 12 of 16 PASS unique_sat_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.15s]
[0m23:17:53.116867 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1
[0m23:17:53.116867 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:53.116867 [info ] [Thread-1 (]: 13 of 16 START test unique_stg_etablissement_oid_etablissement ................. [RUN]
[0m23:17:53.131434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_sat_mobilite_id_mobilite.486fdf2ce1, now test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb)
[0m23:17:53.131968 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:53.137415 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:53.138987 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:53.142112 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:53.143675 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:53.145114 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: BEGIN
[0m23:17:53.145114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:53.189454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m23:17:53.190476 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"
[0m23:17:53.190476 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    oid_etablissement as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etablissement"
where oid_etablissement is not null
group by oid_etablissement
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:53.190476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:53.193378 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: ROLLBACK
[0m23:17:53.194891 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb: Close
[0m23:17:53.195906 [info ] [Thread-1 (]: 13 of 16 PASS unique_stg_etablissement_oid_etablissement ....................... [[32mPASS[0m in 0.08s]
[0m23:17:53.195906 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb
[0m23:17:53.197776 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:53.197776 [info ] [Thread-1 (]: 14 of 16 START test unique_stg_etudiant_id_etudiant ............................ [RUN]
[0m23:17:53.197776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etablissement_oid_etablissement.ceccfd02fb, now test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42)
[0m23:17:53.197776 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:53.201492 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:53.204003 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:53.204003 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:53.204003 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:53.204003 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: BEGIN
[0m23:17:53.204003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:53.247625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m23:17:53.247625 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"
[0m23:17:53.247625 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_etudiant as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_etudiant"
where id_etudiant is not null
group by id_etudiant
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:53.249970 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:17:53.252265 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: ROLLBACK
[0m23:17:53.252265 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42: Close
[0m23:17:53.252265 [info ] [Thread-1 (]: 14 of 16 PASS unique_stg_etudiant_id_etudiant .................................. [[32mPASS[0m in 0.05s]
[0m23:17:53.252265 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42
[0m23:17:53.256170 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:53.256170 [info ] [Thread-1 (]: 15 of 16 START test unique_stg_mobilite_id_mobilite ............................ [RUN]
[0m23:17:53.256170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_etudiant_id_etudiant.72c62c3a42, now test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f)
[0m23:17:53.258186 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:53.261360 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:53.262531 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:53.263705 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:53.263705 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:53.263705 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: BEGIN
[0m23:17:53.263705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:53.442518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.174 seconds
[0m23:17:53.445038 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"
[0m23:17:53.445038 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."stg_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:53.445038 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:17:53.445038 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: ROLLBACK
[0m23:17:53.458569 [debug] [Thread-1 (]: On test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f: Close
[0m23:17:53.458569 [info ] [Thread-1 (]: 15 of 16 PASS unique_stg_mobilite_id_mobilite .................................. [[32mPASS[0m in 0.20s]
[0m23:17:53.475401 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f
[0m23:17:53.476960 [debug] [Thread-1 (]: Began running node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:53.478519 [info ] [Thread-1 (]: 16 of 16 START test unique_vw_fait_mobilite_id_mobilite ........................ [RUN]
[0m23:17:53.483192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sid_lite.unique_stg_mobilite_id_mobilite.2a9057335f, now test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce)
[0m23:17:53.484752 [debug] [Thread-1 (]: Began compiling node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:53.495910 [debug] [Thread-1 (]: Writing injected SQL for node "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:53.499026 [debug] [Thread-1 (]: Began executing node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:53.522466 [debug] [Thread-1 (]: Writing runtime sql for node "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:53.528870 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:53.530283 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: BEGIN
[0m23:17:53.530283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:53.618742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m23:17:53.618742 [debug] [Thread-1 (]: Using postgres connection "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"
[0m23:17:53.618742 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "sid_lite", "target_name": "dev", "node_id": "test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_mobilite as unique_field,
    count(*) as n_records

from "sid_lite"."public"."vw_fait_mobilite"
where id_mobilite is not null
group by id_mobilite
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:17:53.618742 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:17:53.634795 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: ROLLBACK
[0m23:17:53.634795 [debug] [Thread-1 (]: On test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce: Close
[0m23:17:53.634795 [info ] [Thread-1 (]: 16 of 16 PASS unique_vw_fait_mobilite_id_mobilite .............................. [[32mPASS[0m in 0.15s]
[0m23:17:53.634795 [debug] [Thread-1 (]: Finished running node test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce
[0m23:17:53.645343 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:53.645343 [debug] [MainThread]: On master: BEGIN
[0m23:17:53.645343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:17:53.731481 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m23:17:53.731481 [debug] [MainThread]: On master: COMMIT
[0m23:17:53.731481 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:53.745613 [debug] [MainThread]: On master: COMMIT
[0m23:17:53.745613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:53.747374 [debug] [MainThread]: On master: Close
[0m23:17:53.747374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:53.747374 [debug] [MainThread]: Connection 'list_sid_lite_public' was properly closed.
[0m23:17:53.747374 [debug] [MainThread]: Connection 'test.sid_lite.unique_vw_fait_mobilite_id_mobilite.db6391c4ce' was properly closed.
[0m23:17:53.747374 [info ] [MainThread]: 
[0m23:17:53.747374 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m23:17:53.747374 [debug] [MainThread]: Command end result
[0m23:17:53.978907 [debug] [MainThread]: Wrote artifact WritableManifest to D:\GitHub\erasmus-sid-lite\target\manifest.json
[0m23:17:53.991586 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\GitHub\erasmus-sid-lite\target\semantic_manifest.json
[0m23:17:54.007495 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\GitHub\erasmus-sid-lite\target\run_results.json
[0m23:17:54.007495 [info ] [MainThread]: 
[0m23:17:54.018898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:54.020896 [info ] [MainThread]: 
[0m23:17:54.025079 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m23:17:54.034116 [debug] [MainThread]: Command `dbt test` succeeded at 23:17:54.033214 after 3.54 seconds
[0m23:17:54.035682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F739F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F739F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F739F190>]}
[0m23:17:54.037250 [debug] [MainThread]: Flushing usage events
[0m23:17:54.501112 [debug] [MainThread]: An error was encountered while trying to flush usage events
